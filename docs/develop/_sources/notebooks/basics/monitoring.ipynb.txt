{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cc7fd3ac",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e1b0d016",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:13.314635Z",
     "iopub.status.busy": "2022-04-27T14:58:13.314396Z",
     "iopub.status.idle": "2022-04-27T14:58:16.549633Z",
     "shell.execute_reply": "2022-04-27T14:58:16.549142Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-27 14:58:14.259366: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-27 14:58:14.259395: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bb1c81e6",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b34d74d9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.553658Z",
     "iopub.status.busy": "2022-04-27T14:58:16.553407Z",
     "iopub.status.idle": "2022-04-27T14:58:16.556217Z",
     "shell.execute_reply": "2022-04-27T14:58:16.555803Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b44b290f",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "e60bcb1f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.559284Z",
     "iopub.status.busy": "2022-04-27T14:58:16.559064Z",
     "iopub.status.idle": "2022-04-27T14:58:16.561857Z",
     "shell.execute_reply": "2022-04-27T14:58:16.561453Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "26e16e66",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.564771Z",
     "iopub.status.busy": "2022-04-27T14:58:16.564500Z",
     "iopub.status.idle": "2022-04-27T14:58:16.656854Z",
     "shell.execute_reply": "2022-04-27T14:58:16.655958Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fc41245d360>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "78dba734",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.660386Z",
     "iopub.status.busy": "2022-04-27T14:58:16.660106Z",
     "iopub.status.idle": "2022-04-27T14:58:16.728336Z",
     "shell.execute_reply": "2022-04-27T14:58:16.727786Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-27 14:58:16.663328: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-27 14:58:16.663370: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-27 14:58:16.663394: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ecdc988a1d18): /proc/driver/nvidia/version does not exist\n",
      "2022-04-27 14:58:16.663719: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fc412498790&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fc412498790>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "da1e7d1c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.733410Z",
     "iopub.status.busy": "2022-04-27T14:58:16.733147Z",
     "iopub.status.idle": "2022-04-27T14:58:16.889695Z",
     "shell.execute_reply": "2022-04-27T14:58:16.889247Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e84f6a28",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ee6cfb2e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.891964Z",
     "iopub.status.busy": "2022-04-27T14:58:16.891754Z",
     "iopub.status.idle": "2022-04-27T14:58:16.907489Z",
     "shell.execute_reply": "2022-04-27T14:58:16.906725Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a30c3c8",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "5a7e2dc9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.910311Z",
     "iopub.status.busy": "2022-04-27T14:58:16.910075Z",
     "iopub.status.idle": "2022-04-27T14:58:16.913451Z",
     "shell.execute_reply": "2022-04-27T14:58:16.912990Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c659df9b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:16.915571Z",
     "iopub.status.busy": "2022-04-27T14:58:16.915373Z",
     "iopub.status.idle": "2022-04-27T14:58:23.371641Z",
     "shell.execute_reply": "2022-04-27T14:58:23.368904Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-27 14:58:16.920278: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "096cd449",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60f62a9b",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "057e120c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:23.374403Z",
     "iopub.status.busy": "2022-04-27T14:58:23.374158Z",
     "iopub.status.idle": "2022-04-27T14:58:23.379297Z",
     "shell.execute_reply": "2022-04-27T14:58:23.378770Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a9941141",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "318431a2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:23.381722Z",
     "iopub.status.busy": "2022-04-27T14:58:23.381523Z",
     "iopub.status.idle": "2022-04-27T14:58:25.471491Z",
     "shell.execute_reply": "2022-04-27T14:58:25.468618Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a3d4f4cf",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "045fa9de",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2515b36f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:25.475414Z",
     "iopub.status.busy": "2022-04-27T14:58:25.475154Z",
     "iopub.status.idle": "2022-04-27T14:58:25.491726Z",
     "shell.execute_reply": "2022-04-27T14:58:25.491249Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8eb55f74",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-27T14:58:25.494260Z",
     "iopub.status.busy": "2022-04-27T14:58:25.494033Z",
     "iopub.status.idle": "2022-04-27T14:58:27.466092Z",
     "shell.execute_reply": "2022-04-27T14:58:27.465606Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47530789",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
