{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2c0d6a96",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c0cd4be1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:13.946523Z",
     "iopub.status.busy": "2022-05-20T14:25:13.946215Z",
     "iopub.status.idle": "2022-05-20T14:25:17.241563Z",
     "shell.execute_reply": "2022-05-20T14:25:17.240897Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-20 14:25:14.905898: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-05-20 14:25:14.905925: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a0ab3c15",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b3766ce8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.244333Z",
     "iopub.status.busy": "2022-05-20T14:25:17.243878Z",
     "iopub.status.idle": "2022-05-20T14:25:17.247532Z",
     "shell.execute_reply": "2022-05-20T14:25:17.246854Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2bd959f7",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "9a4401ca",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.249865Z",
     "iopub.status.busy": "2022-05-20T14:25:17.249581Z",
     "iopub.status.idle": "2022-05-20T14:25:17.252674Z",
     "shell.execute_reply": "2022-05-20T14:25:17.252131Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4389daa1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.254795Z",
     "iopub.status.busy": "2022-05-20T14:25:17.254544Z",
     "iopub.status.idle": "2022-05-20T14:25:17.382061Z",
     "shell.execute_reply": "2022-05-20T14:25:17.381035Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f7ea354b5b0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "e2df6600",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.386764Z",
     "iopub.status.busy": "2022-05-20T14:25:17.386271Z",
     "iopub.status.idle": "2022-05-20T14:25:17.442154Z",
     "shell.execute_reply": "2022-05-20T14:25:17.441567Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-20 14:25:17.390054: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-05-20 14:25:17.390098: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-05-20 14:25:17.390122: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (11cb2c2f733e): /proc/driver/nvidia/version does not exist\n",
      "2022-05-20 14:25:17.390482: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n",
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f7ea334fdf0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f7ea334fdf0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "001d8531",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.444697Z",
     "iopub.status.busy": "2022-05-20T14:25:17.444395Z",
     "iopub.status.idle": "2022-05-20T14:25:17.630414Z",
     "shell.execute_reply": "2022-05-20T14:25:17.629737Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0f43d67a",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7b0eb38c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.633328Z",
     "iopub.status.busy": "2022-05-20T14:25:17.633024Z",
     "iopub.status.idle": "2022-05-20T14:25:17.649062Z",
     "shell.execute_reply": "2022-05-20T14:25:17.648354Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "97b86614",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "13a2a9fe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.652522Z",
     "iopub.status.busy": "2022-05-20T14:25:17.652208Z",
     "iopub.status.idle": "2022-05-20T14:25:17.656454Z",
     "shell.execute_reply": "2022-05-20T14:25:17.655910Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "405b6395",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:17.658788Z",
     "iopub.status.busy": "2022-05-20T14:25:17.658538Z",
     "iopub.status.idle": "2022-05-20T14:25:26.353816Z",
     "shell.execute_reply": "2022-05-20T14:25:26.353175Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-20 14:25:17.663466: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:AutoGraph could not transform <bound method ShapeChecker._parse_checks of <gpflow.experimental.check_shapes.checker.ShapeChecker object at 0x7f7e746785b0>> and will run it as-is.\n",
      "Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\n",
      "Cause: annotated name 'shape' can't be nonlocal (__autograph_generated_file9p718d8q.py, line 72)\n",
      "To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING: AutoGraph could not transform <bound method ShapeChecker._parse_checks of <gpflow.experimental.check_shapes.checker.ShapeChecker object at 0x7f7e746785b0>> and will run it as-is.\n",
      "Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\n",
      "Cause: annotated name 'shape' can't be nonlocal (__autograph_generated_file9p718d8q.py, line 72)\n",
      "To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3daedbd1",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14aafa77",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d087cdf3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:26.356804Z",
     "iopub.status.busy": "2022-05-20T14:25:26.356543Z",
     "iopub.status.idle": "2022-05-20T14:25:26.361500Z",
     "shell.execute_reply": "2022-05-20T14:25:26.360979Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c7d9af5e",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cbe8cd34",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:26.363957Z",
     "iopub.status.busy": "2022-05-20T14:25:26.363702Z",
     "iopub.status.idle": "2022-05-20T14:25:28.625016Z",
     "shell.execute_reply": "2022-05-20T14:25:28.624245Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96c4de46",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f95d5a46",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "7df1179f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:28.628060Z",
     "iopub.status.busy": "2022-05-20T14:25:28.627772Z",
     "iopub.status.idle": "2022-05-20T14:25:28.644442Z",
     "shell.execute_reply": "2022-05-20T14:25:28.643854Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c10b654c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-20T14:25:28.647066Z",
     "iopub.status.busy": "2022-05-20T14:25:28.646793Z",
     "iopub.status.idle": "2022-05-20T14:25:30.882132Z",
     "shell.execute_reply": "2022-05-20T14:25:30.881042Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "849ccec8",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
