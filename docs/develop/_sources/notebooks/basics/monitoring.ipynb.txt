{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "3ce04574",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3a500511",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:09.776437Z",
     "iopub.status.busy": "2022-03-24T14:15:09.776217Z",
     "iopub.status.idle": "2022-03-24T14:15:12.533654Z",
     "shell.execute_reply": "2022-03-24T14:15:12.533148Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 14:15:10.692952: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-24 14:15:10.692977: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5982524",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7b1098ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.536252Z",
     "iopub.status.busy": "2022-03-24T14:15:12.536055Z",
     "iopub.status.idle": "2022-03-24T14:15:12.538880Z",
     "shell.execute_reply": "2022-03-24T14:15:12.538459Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "382851a3",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "54be74c6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.540810Z",
     "iopub.status.busy": "2022-03-24T14:15:12.540630Z",
     "iopub.status.idle": "2022-03-24T14:15:12.543174Z",
     "shell.execute_reply": "2022-03-24T14:15:12.542774Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "436a4034",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.545162Z",
     "iopub.status.busy": "2022-03-24T14:15:12.544975Z",
     "iopub.status.idle": "2022-03-24T14:15:12.632428Z",
     "shell.execute_reply": "2022-03-24T14:15:12.631887Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f85736aa230>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "764f825f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.634736Z",
     "iopub.status.busy": "2022-03-24T14:15:12.634535Z",
     "iopub.status.idle": "2022-03-24T14:15:12.680727Z",
     "shell.execute_reply": "2022-03-24T14:15:12.680174Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 14:15:12.636527: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-24 14:15:12.636557: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-24 14:15:12.636576: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (5e38b06c3a0f): /proc/driver/nvidia/version does not exist\n",
      "2022-03-24 14:15:12.636831: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f8573709a80&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f8573709a80>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "77891c4f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.683132Z",
     "iopub.status.busy": "2022-03-24T14:15:12.682985Z",
     "iopub.status.idle": "2022-03-24T14:15:12.815377Z",
     "shell.execute_reply": "2022-03-24T14:15:12.814816Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b9fa0872",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "06989fad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.817777Z",
     "iopub.status.busy": "2022-03-24T14:15:12.817573Z",
     "iopub.status.idle": "2022-03-24T14:15:12.958238Z",
     "shell.execute_reply": "2022-03-24T14:15:12.957754Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb9a630a",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3e161e1b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.960864Z",
     "iopub.status.busy": "2022-03-24T14:15:12.960668Z",
     "iopub.status.idle": "2022-03-24T14:15:12.963644Z",
     "shell.execute_reply": "2022-03-24T14:15:12.963257Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "155d0d8d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:12.965547Z",
     "iopub.status.busy": "2022-03-24T14:15:12.965383Z",
     "iopub.status.idle": "2022-03-24T14:15:19.229765Z",
     "shell.execute_reply": "2022-03-24T14:15:19.229257Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 14:15:12.969648: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c1e9da1f",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f593a65d",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7e2c7569",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:19.232355Z",
     "iopub.status.busy": "2022-03-24T14:15:19.232149Z",
     "iopub.status.idle": "2022-03-24T14:15:19.236753Z",
     "shell.execute_reply": "2022-03-24T14:15:19.236345Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eec3750f",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "90d4f341",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:19.239208Z",
     "iopub.status.busy": "2022-03-24T14:15:19.239018Z",
     "iopub.status.idle": "2022-03-24T14:15:21.265991Z",
     "shell.execute_reply": "2022-03-24T14:15:21.265473Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "819e90df",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca468612",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8b2ce224",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:21.268777Z",
     "iopub.status.busy": "2022-03-24T14:15:21.268586Z",
     "iopub.status.idle": "2022-03-24T14:15:21.284879Z",
     "shell.execute_reply": "2022-03-24T14:15:21.284356Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c2f6b7a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T14:15:21.287346Z",
     "iopub.status.busy": "2022-03-24T14:15:21.287134Z",
     "iopub.status.idle": "2022-03-24T14:15:23.600764Z",
     "shell.execute_reply": "2022-03-24T14:15:23.600241Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8dbab05f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
