{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "bd1390d8",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5ac8c54e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:50.034146Z",
     "iopub.status.busy": "2022-04-28T11:41:50.033910Z",
     "iopub.status.idle": "2022-04-28T11:41:52.864028Z",
     "shell.execute_reply": "2022-04-28T11:41:52.863310Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 11:41:50.885675: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-28 11:41:50.885703: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "70f5077c",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d6d359b7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:52.866858Z",
     "iopub.status.busy": "2022-04-28T11:41:52.866647Z",
     "iopub.status.idle": "2022-04-28T11:41:52.869189Z",
     "shell.execute_reply": "2022-04-28T11:41:52.868815Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12926205",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "67d816c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:52.871311Z",
     "iopub.status.busy": "2022-04-28T11:41:52.871128Z",
     "iopub.status.idle": "2022-04-28T11:41:52.873536Z",
     "shell.execute_reply": "2022-04-28T11:41:52.873170Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "523d6dfe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:52.875427Z",
     "iopub.status.busy": "2022-04-28T11:41:52.875251Z",
     "iopub.status.idle": "2022-04-28T11:41:52.966371Z",
     "shell.execute_reply": "2022-04-28T11:41:52.965992Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fbb3d6ad390>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0cb2dff4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:52.968250Z",
     "iopub.status.busy": "2022-04-28T11:41:52.968064Z",
     "iopub.status.idle": "2022-04-28T11:41:53.012753Z",
     "shell.execute_reply": "2022-04-28T11:41:53.012367Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 11:41:52.969943: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-28 11:41:52.969985: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-28 11:41:52.970005: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (4d5b849030ca): /proc/driver/nvidia/version does not exist\n",
      "2022-04-28 11:41:52.970254: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fbb3d44c340&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fbb3d44c340>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6573d2a0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:53.014753Z",
     "iopub.status.busy": "2022-04-28T11:41:53.014567Z",
     "iopub.status.idle": "2022-04-28T11:41:53.162678Z",
     "shell.execute_reply": "2022-04-28T11:41:53.162281Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "56e9aec0",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7171eb89",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:53.164804Z",
     "iopub.status.busy": "2022-04-28T11:41:53.164613Z",
     "iopub.status.idle": "2022-04-28T11:41:53.178418Z",
     "shell.execute_reply": "2022-04-28T11:41:53.177896Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "08991e66",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a1b8ad8c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:53.180541Z",
     "iopub.status.busy": "2022-04-28T11:41:53.180357Z",
     "iopub.status.idle": "2022-04-28T11:41:53.183320Z",
     "shell.execute_reply": "2022-04-28T11:41:53.182930Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "7c7c80cf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:53.185045Z",
     "iopub.status.busy": "2022-04-28T11:41:53.184867Z",
     "iopub.status.idle": "2022-04-28T11:41:58.513146Z",
     "shell.execute_reply": "2022-04-28T11:41:58.512325Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 11:41:53.188787: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74e889ae",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "40ecb191",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "160c5334",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:58.515865Z",
     "iopub.status.busy": "2022-04-28T11:41:58.515657Z",
     "iopub.status.idle": "2022-04-28T11:41:58.520869Z",
     "shell.execute_reply": "2022-04-28T11:41:58.519924Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "55cb187b",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "2b9ab998",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:41:58.523060Z",
     "iopub.status.busy": "2022-04-28T11:41:58.522865Z",
     "iopub.status.idle": "2022-04-28T11:42:00.377187Z",
     "shell.execute_reply": "2022-04-28T11:42:00.376701Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "845b8de3",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3354e51a",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a0c417fc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:42:00.379920Z",
     "iopub.status.busy": "2022-04-28T11:42:00.379711Z",
     "iopub.status.idle": "2022-04-28T11:42:00.395118Z",
     "shell.execute_reply": "2022-04-28T11:42:00.394372Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "37ff2774",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T11:42:00.397162Z",
     "iopub.status.busy": "2022-04-28T11:42:00.396981Z",
     "iopub.status.idle": "2022-04-28T11:42:02.022568Z",
     "shell.execute_reply": "2022-04-28T11:42:02.022142Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1d81282",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
