{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b0f3fa68",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8d03c838",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:28.380520Z",
     "iopub.status.busy": "2022-04-21T10:20:28.380309Z",
     "iopub.status.idle": "2022-04-21T10:20:31.298938Z",
     "shell.execute_reply": "2022-04-21T10:20:31.298471Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-21 10:20:29.305904: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-21 10:20:29.305932: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce8d5eab",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5313713f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.301813Z",
     "iopub.status.busy": "2022-04-21T10:20:31.301604Z",
     "iopub.status.idle": "2022-04-21T10:20:31.304174Z",
     "shell.execute_reply": "2022-04-21T10:20:31.303787Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99041871",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "db8c8f71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.305960Z",
     "iopub.status.busy": "2022-04-21T10:20:31.305794Z",
     "iopub.status.idle": "2022-04-21T10:20:31.308199Z",
     "shell.execute_reply": "2022-04-21T10:20:31.307810Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "bb141169",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.309914Z",
     "iopub.status.busy": "2022-04-21T10:20:31.309749Z",
     "iopub.status.idle": "2022-04-21T10:20:31.392988Z",
     "shell.execute_reply": "2022-04-21T10:20:31.392575Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fc616028eb0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a4bf731b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.395332Z",
     "iopub.status.busy": "2022-04-21T10:20:31.395138Z",
     "iopub.status.idle": "2022-04-21T10:20:31.441078Z",
     "shell.execute_reply": "2022-04-21T10:20:31.440657Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-21 10:20:31.397194: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-21 10:20:31.397224: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-21 10:20:31.397243: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (c5338907f279): /proc/driver/nvidia/version does not exist\n",
      "2022-04-21 10:20:31.397496: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fc61602bf10&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fc61602bf10>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "add68fcb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.443396Z",
     "iopub.status.busy": "2022-04-21T10:20:31.443200Z",
     "iopub.status.idle": "2022-04-21T10:20:31.583183Z",
     "shell.execute_reply": "2022-04-21T10:20:31.582737Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXwAAAD4CAYAAADvsV2wAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAABK/ElEQVR4nO29eXRc93Xn+fnVXqgCUFhJAiRIiju10mLkhbZiSbYkL5HLdpJJ4uQ4M93H02fGvWTS6BE6PW13Oj1SD05PkunO9MSTpE8y0YnjbsuwEimRJUu2ZNpaSFESRZEUdxJV2IECCoVCrb/54xaIrQogCRSWwv2cgwNU1av3XoHg99137/19r7HWoiiKolQ+jtU+AUVRFGVlUMFXFEXZIKjgK4qibBBU8BVFUTYIKviKoigbBNdqn8BCNDY22h07dqz2aSiKoqwbjh8/PmitbSr22poW/B07dnDs2LHVPg1FUZR1gzHmSqnXNKWjKIqyQVDBVxRF2SCo4CuKomwQVPAVRVE2CCr4iqIoG4Q13aWjKMraoOtEhM7nzxKNJWkJ+Wl/ZB/hQ62rfVrKTaKCryjKgnSdiNDx9EmSmRwAkViSjqdPAqjorzM0paMoyoJ0Pn/2uthPkczk6Hz+7CqdkXKrqOArirIg0Vjypp5X1i4q+IqiLEhLyH9TzytrFxV8RVEWpP2RffjdzlnP+d1OHtjfxJEnX2Ln489y5MmX6DoRWaUzVG4ULdoqirIgU4XZmV06D+xv4rvHI1rIXWeYtTzT9vDhw1bN0xRl+Viu9sojT75EpEgOv67KTZXbSXR0kpZaH+0P7yZ8aBs4NJmwUhhjjltrDxd7TSN8RdkgLGd7ZamC7chEhhEysv/RSTq+dwrGugkfrAOXF9xV4KsFT9USPolyq6jgK8oGYaH2yhsS/FQc4r2QGKAlAJHE4m9JZi2dP40T3l8D2ZTsY7wXnF66LuTpfKWPaGxSF3OtEHqfpSgVTteJSMkUDCzSXpmZhL734czfw/vPwOWfwMgV2u/J4nfO3bh4ejgaz0F6HLJpifC9IbrOJul47iqR2CQWudv4Z3/9Nod+9wda/C0jGuErSgUzN41TjFCVmyNPvjQ7r3+bgd53YeQSpBPg9II3CDghMUjY3QttLjq7DxLNBHBgyZWIH1u8STj/QiGVE4TqFjpfleh/LiMTGS3+lhEt2ipKBbNQZA/gdhqwkMlP64DfaXni9m7CLTHwVINxwMQwxKMwPgDZJBLNu8DtA5eHHSd+GTBFjmD5g4ZnCNd+AA4veALg8rPz3V/FFt1eaA35OPr4Q7f6sTc0CxVtNaWjKBXMQuma1pCfgMc1S+wBkjlD59lmmBiFnnfgwstw7XUYjQAG/A1Q1QRVIXA46BrYXFK665wpwpuGwF0Nxil3CxNDtLjiC553JDZJ1/GrN/dhlUVRwVeUCqbUatjWkJ+j//QQo8lM0dcjKQ87XznCkRMP0tW/CXJpyecnhyB2BUYuw1gEUmN09t1bNFo3WL6x9R3w1Ux35hgDNkd74xu4yS547h3fe4+uNy8uuM1UfUIXf90YKviKUsEUXyXroP2wC957mhZfusQ7DRZDJFtNx8CDdA1vB5sFXwgad0PbfbDrU7DnEaKZQNE9WCD8kf2w60Fo+wi03g2bb4fgJsKBkwQdpY4tJLOWzh98AMmRoq9P1SciseT1wm/H0ydV9BdAi7aKUsHMWyVb46L94BhhxwmIRGmv99PRc4SkdZfcR9J66Jz4LOHHPFC9WVI6Lh843WAMLa8cIzKamve+1qAT6togn4N8FmxeOnXSCZgcJXZhcS+eaDwndxO5DASbZ7225DbTDYgKvqJUOOFDrYQPBOHaG/IVfRv6BmFyjHAuBcEeOhOPEs2HCo2V89Mz0aQL9n1m/s6tpf3Tu+n4/mmSmfz1p/0uQ/v9jeBxS0tmPlsQ/ZxcKAINN9TL3+JJwviwPMiloaZV0kKoi+etoIKvKGuYrhMR/s3fnGJkQnLtIb+bbz52+w1HsF1vddP5dyeJxnO0uMZpD54n7H4fsOBwgcNLuLmXcOiH0PYRjrzQRmQ8P28/LSE/ZJKQnpAunWwKspMiwvEJfE7LVDkg5DV886EmwrfXg8MJVQ0S3du8ROqTo5Acpv2ucTre8JLMFS/5+k2G9qrn4I043PmLhTuFHNRtv35OxTqQ1MWzNMsi+MaYPwM+D/Rba+8o8roB/hD4LDAB/Ka19q3lOLaiVCpdJyK0/7d3yOSmu2hiyQzt//UdYJE+9Xyerp+epOPvrpLMOWAqHx97DGot4bqL4A3B5jtg+8eg9RAEmmj3DMzr2zfAA9scMHCm8IRTbBI8AbrOQMdLvSQz0+eYyjugugUaFr4ohW9LQ/17dP64l+h4npDHYvM5RrMuWpxjtNe9Qjh4AQZH4dh/gb2fhW0/JxeR2q20P7Jv3rn63U7aH9l3w7/jjcay9OEbY+4HxoG/KCH4nwX+MSL4Hwb+0Fr74cX2q334ykZmoR761pCfo48/OP+FXBYmBuHqaxz5dppIkYJqq3uco/efg50fhy13QVWdROqpcUiP86/+7gpPvRuftW7WAF853Mzvhe8SsV/kHEueXykmR2E0ChMDMHIVLh+F4QtyV5FLy52FLwQ7PwF7H4Hm/VC9SWftFqHs5mnW2leMMTsW2OQLyMXAAq8ZY0LGmC3W2p7lOL6iVCILLZial6fO52C8H2JX4exzcPEVopnfLr7fTJAjxz5Me20L4YY4jPeIqAI4XLx8OTnPJMECTx3r5/CuwVmCumx5dF+tfKXbJE9fswW6j0H0BMT7JR00MQgXfgjpOOz/PGw9LPWJDS7wN8NK5fBbgWszHncXnpsn+MaYrwFfA2hra1uRk1OUtYjTGHIl7sCv56mtlVWwYxHoOwWn/0a8byZHaXGMEMnXF31/ZDRNxzPn4aE6wndvpuuSk86XI0RHJ0s44ojoz+2AWfY8uicADbsk7+8JQqAZut+Q6N9GITkMV34mJmzZSdj1AF2n4xrl3yBrrmhrrf0W8C2QlM4qn46irBqlxB6kv55sCkauQLwHLrwKF16C0avSDeMO0L75bTp6f55kfp7LGVDoc399AkIeOp6d3+JYjLmRe9ny6P4QbP05CDRICqn3bfDXyUVtMgaRtyEzSddFBx1vuK53COkgloVZKcGPANtmPN5aeE5RlBK0loie66rchPd4JJLvPw0fvADRt0QInS6obYXNdxFu3QsDhs63HUU7bwCiscmi/eylmBu5F5uGtWwRtsMBDbsL0X5APqPLDb3vSa6/9106z3yRZCY4623ai1+alRL8Z4CvG2O+jRRtRzV/rygLUzx6dvCNBxqh7z24+hqcexFil6Xd0ROE+sIq2OYD0LCb8F1thD9TzZHOV0qmXm40314qci97Ht1fJ4Vaf0jsmZ0+ifjjPSVX+WovfnGWqy3zr4BPAo3GmG7gG4AbwFr7/wDPIR0655G2zP9+OY6rKJWO1+W4Lvh1fhffuL+acPU5ePfHIviJIYmEq1tgyz2w8wi0foiua0E6/+IC0Vh30Rm0MC3gnc+fLT2u0ONaG7lxt09SPE6v5PCdLoi8RctI8TqF9uIXZ7m6dH51kdct8D8vx7EUpdLpOhHhm8+cIjbH2Gwyk4XeU3Dlb2HgLGQnxOKgYTfsegj2fBI23UnXyQE6vj97lOF3j0f48r2tvHxmoKiAF8vDf+MXbnyB14rgqYJNB0Xsu48Dlvbxn9Ex+GmSeK5vpr34pVlzRVtF2cgsNLAkmYXO9wKEa05BPgP+eth6GG4Pw46PS8qD0h4zL58ZKNobX9Y8/HLjq4G6nfKz20vYvgXmBTqHPko0X0eLK0H7Z9bYhWoNoYKvKGuIbz5zasECaiRXw86RP6DFOUr71mHCH/8kNN8uaZ0Ct9Ibv6762QMNhXUDFpw+wvmfEK76f2VWrs3D5Z+DD/2xXByUWajgK8oKcCMrQrtOROalceZjxAo4F+K3ToU4Vg2/F57tcr4hPGZqtkCu4NDpcEmLaj4n3TuRt+DZfwGP/V/g9iy8nw2G+uErSpkp5tv+W3/9Nv+q6+Ss7TqfP3tT+7XAU69dnef/XtwDvwLz2rVtYrdQvx32PQqNuyTNZXNw+VV44V9L95JyHRV8RSkzxXLqxcT6VloJp1a/ziR8qJUnvnQnrSE/Bunnf+JLd66flM2N4nBIPt8dgLodYrcQ2gGeGon+zz4Hr/w+Xcev6VSsAprSUZQyU8oTZ65VQUutt+ggkemti9sIF7tQrKuc/FJwuqB+Jwx+AI174MDn4L0JGLkG6XG6Xj9DR/yd6xbM62IlbjImthHBTde9/5cLjfAVpcw4F/hPe12sJ8do39WN38xNQVgcC4g9VFhu/lZw+yG0XX5FLXfDnoch2ARuH51jD8zz259aibtmGe+TsY7LLPaggq8oZWchT5yWkB8Sw/D6HxMefYonarpodY5isLQ6Y/zBoYGiA8KnqMjc/K3gD8niM5uD7Ufgtk9CVQPRfF3RzdfsStzUOGQmxDSuDKjgK0qZaS0RgRug/ZMt8Nr/DWeeg+QI4dBFjm7+Ay7t+D84+vlxuO3ncSwQ6X353g2SurkRqjdJEdcAux+Cto/S4hwtuumavStK9Mvc33y2LLtXwVeUMlOsa8YAX7m3mfDEd8X8LDUmXji5NLir4NBv0OV+mI5nPljwDuG7xyMbugg5j9B2cPllBfLuh2hvu4if9KxN/C5D+8N7V+kEFyCbEqvrTBImhiBf3PBuKajgK0qZmdk1A5LTt8DLp7rpOn5FvN399QWx98KHfh3u/SqdL15a1MVyzeejVxqHQ4q4xkDNFsIfv5Mntr5Oq2NY0mSuOE8cvEZ4a0JmCawlEgOQGARvQOb2OpZfnrVLR1FWgGKeNZFJDx2Tn4FmL+H0CXC64Z6vwr2/AU73ghOvZrJm89GrhcsrbZrDF6BxH+GPJQgf/3N57AmA4264hFwUGveUpTh60+RzMtvA5mXil6e4C+hSUcFXlBWiqMcNHn67/2FozBD+xOHrYg8LT7yayZrNR68Ss1Y1Vztp//hewrc/Bsf/QqLooQvgqQZvLRiHTNhabdEf75NBNvW7oHpL2Q6jgq8oZWKunUKpiD2Hg46Rz3Es0sbLL796ffsbEXvt0pnNXPO5SDxHxwsD8Kl7Ce8bhPf+q3jujFyEvkZp6TRGFnCVIYVyQ+Tz0POuWD837SvrxUdz+IpSBorZKVByWiwkcw6eeqN71val/ts7jansFbRLoOhdVNbSeXQUDn4etn9CovrBCzB4HmIRGPgAhs5DrjydMYvS955MK9t8p1hAlxGN8BWlDBQfG7hw5Db3cjC13Grm8363U0V+AUo6hcZz0r1z9y9L+iT6lghtoB6C9TAakVbIhl1SA1gpEkMy26B2K9TvKPvhNMJXlDKwXIVUC5XvibOMlKpn1PqdkE9DsBkO/QbUbIPUKHSfgP6z0gqZHBaLhnRiZU42k5ye09tyaEUOqYKvKGXgZguppWL/1pCfo48/yKUnP8fRxx9UsV+E9kf24XbM/20m0nm6LjllcEzDDrj7K+CtgdGr0P2mfM9lRYQHz0k/fDnJTEpkPzkGzXeUrStnLir4ilIG2j+1E/8iCdOZufivfKRtY1gal5nwoVaCvvm/+EzO0vnqgDhrYmDLAbj9i1K07TsJV16HsR7pzTcOiF2ZfrzcZJJSMxjvl1ROqG35j1ECzeEryi1QaqCJPH+GSGyyYHo2k+nIs1gu/vD2+vUxZnCNE5so7oEfjU1Kf/7gWfAGofUQjEbh4g/h8k+gZjO4PDIj2FMj3TzphAiya5kGqaQnZD1AalwmcoW2Ld++bwAVfEW5Sea1/hUsd49dGea7x7tJZmRJfH6GwLvJ4nHkSeTlP7fXNf/mesNYGpeZBSd+uTwi+kPnoaoRdt0PqZikdc4+B4FGWQfRuAdqtkK8h65Xj9P52jjR0fTSLsTj/TAWBRxyHu5AWXvui6EpHUW5SUoNCf+r169dF/u5ZHAxkZ+O5GLJDB1Pn1QfnDKw6MQvb7U4a3qD4rK54xPQsBcmYvDe0xDvheErkBqjK1JNxw9HiIymr7fL3vS/WzYldYGxiBzb7QXjFPuEFV7wpRG+otwkpTpwFlsoNffVZCbHb3/nHWAND+NYh0z9LhdMj1VvgkxCxDg5Crvvh3RcVruefgYOfgFcXjp/kCGZnf0vl8zk6Pz79wnf1Xx9VfQ8rIXJUen8mRyTukBouzw/elXsE9wrv0JaBV9RbpJSKQOngdxN1vhy1q79CUzrkBtKj4W2i+AHmiRXv+sBsakeOA8fvAi780THthZ9a3Q0LX38Lr/07TvdMkw9l5FpVZmkePM73NIKWtUozw9fFFuHYHn87hdDUzqKcpMUTRm44Fe39BaZWLU46ni5SjicYqlQswV8QRH+bR+WlMvwBbj0Y1r8xf89W2q9khZyukXIJ4bl7iA5Ihv462Tfm26HmhZpBx25JLbNdTtW7jPOYVkifGPMo8AfAk7gT6y1T855/TeBTmAq8fWfrLV/shzHVpSVYG5XzpfvbeXlMwPTBl23XSM82cXhRBO/Pfolcjjn7WPuqtmZqOPlKuH2iZ3y5KjMJGjaAxP9YrmQGKa94ad0RD9BMj8dG/vdTtofPSBpITZN78va4jn5TFIM2xxuWcnrXL3EypKPbIxxAn8EfBroBt40xjxjrX1/zqZ/ba39+lKPpygrTbGunO8ej0hb5W0Wzv49XPgRjA8Qdl/kWNV2/nLi55i7nOpju+p57eJI0Vy/Ol6uIr4aaD4AySFIX4TWeyE5Brk04aZeyP+IzqEjRFNeWmq9tD96oHi6qJjYJ2Mweq3gyrm7dM5/hViOS819wHlr7UUAY8y3gS8AcwVfUdYlpbpyOv/+NOHPDkLvKbquVdEZ+8dE83Ulh45fHkryH3757lkXD9AFVmuCYBM03y6dOiCpmN63AQfh7RnCtf8f1G2TAem31S6+v3we4lGxY3ZXSRrnRvvtM0np1w803NpnWYDlEPxW4NqMx93Ah4ts92VjzP3AB8BvWWuvFdkGY8zXgK8BtLWt3Ao0RSlFSUOu0RQMnqfrfIaO4c+SRP5D50oYJURjyRvrIFFWh8Y9kofvSUDDbTJfNnYFdn1acvL978E7/1WM1m775Pz0jLWQHpeunMlRyKVkGHlNy421X+aycvyJQcDIMZfZsnmlkkl/A/yVtTZljPkfgT8HHiy2obX2W8C3AA4fPrzGZpApG5GSC3n8Geh5l87BX7gu9ovtB3SB1ZrFGNh6WBwsY1egca8Id89xuP2XxAbh0k/g0quyiKppr+T/vTXitJnPct3j1BOU7X01ix83m5YZtokB6RrKJMFZntW3y3H5iADbZjzeynRxFgBr7ZC1NlV4+CfAvctwXEVZEYp25TjztLeehv73iebrFt2Hpm3WCZ4AbLkLqpula6e2TWwQrv1U7IsPfl6eHyv46A9fklbLVFxaNEPbYfNd0Lh7YbHPZaWzZ+gC9J8SG4dcSqL7RL/MNy4DyxHhvwnsMcbsRIT+V4Bfm7mBMWaLtban8PAx4PQyHFdRVoR5aZiqPO3bLxIe+x6k4rQ4R4nkQvPe5zSGvLWatllvhLaJ8Obz4qw5MQQjl+Hq67DvUaiqh4uvyKKq2BXYco9Mq8pOyGNXn+TtnR7pzXc4Jd0zdReQTsiiL5BtnH4R+US/9PRvunPtDjG31maNMV8HnkfaMv/MWnvKGPO7wDFr7TPAPzHGPAZkgWHgN5d6XEVZScKHWgnf0wIfvAA978D5lyQq89bR3niRjsuHSOYWNkdT1gkur6yEzaVFrBP9shhr+IKYrO15GA58Hq6+Jt44PScgtANqt8nFwOGSiD9fpIffOKQ9010lF4GxqOzf4ZR9bDo4vUrX7Vv2j2ZsOew/l4nDhw/bY8eOrfZpKIrQewouvgzRE3DhJcAF234Odn6CLvdn6HzxohZiK4VcBvrfh8k4DJ2n641zdEbvJJoNyh3e/ZsI73bJNhPDcpHwBKTt0ukGX0jy+A6XdOfk82CzkqNPxaULJ5cSe4XQDqkHuP2SPhq+IJF/4165ENwkxpjj1trDxV5TawVFuRESg9D9Boz1weWjkMtJNLblTrj9i4RrNhM+vGO1z1JZLpxuydXns3SNtNERaSCZkxRLZMIpg9FtA+F9d0L/GZgcgaomyfOnxuQiMN4D+Zx8Gcf0xcDlkw6fYLN04kyNVJwS+2wafHW3JPaLoYKvKIuRy8KloxDvh3MvSOtdbZuI/b7PiI+6UnkEmiExSOcb6etiP0UyZ+j8yTDh/VulZ3/oHAyfkyh+xyfAXytCn8tMp3aMsyD8nvn5+ckxsV5IT8hFITMhdwXrtC1TUdYv0bcgdqmQs43I7XrzQdj5CWi5Z7XPTikXThcEm4nGiy4ZIpqwEpV7CgurnF7x2Z+MwY77oa6tEKUvkIu3Vnrvx/tkX25fwYdnR1mKtmqepigLMRqBnrfpOjPBkTNfZGf8P3Mk9r/RxSdh7yOrfXZKuQk00VJdPLXS4knC5Z+KqBuHeOs0H4SJETj7rHT1JAYl0i9GekKGpo92T184gptE7LOp4u9ZIhrhKxueUuMKyWbg6s/o+iBDx/kD1xdXRTJBOt51wO4+LcxWOg4n7Q+10fG3l2f54vsdOdp3dcPgGTgL7HpQCrSBBrB7YOAMXPqx3BHW7wR/PfhqpVc/HZdWz1QCUqOFIm+NpJCshYs/kjz+3kc0paMoy0mpcYUA4cYIjFyl8/TmeStpk5k8nc+fVcHfAITv2w+TY3QeHSUaz0qXzoEY4bZqiLdJoTWfE9F3e2VsoTsAA+9D3/sQuyqC73TJRSGfF69845QUjq9GhH7wDIwPSK9+zbayTMNSwVc2NCWN0f7ufcKfugLX3iSS+0rR96ql8QbB4SB8+DbCeyMi3L3vQjwtbZTbPiY1nngUrhyFbfdJ1403AK2HZbTh6DXxyXd5ASu5fre/MGKxXoR/rEcif5cXqneWpQcfVPCVDU5JY7SxFPSdouuCLeljH6paXatbZQWpapTCai4ji7Im4zL4xFjY/SBc/hmMXZO+/M13yfNOt7Tu+kOSwnG4pXvH5ZOFV9mkPJ9JSB2gqlFW2PrrJP1Thghfi7bKhqaUD32LLwOXXqUz+VlsCffL8cmsDiHfKDgckmNPx0XwvdUiyMkRMU/b+TEpto71wsiVghWyldRN3XZo2icRvXHKe6dSOoEmuSvY86h0fTXsKqzWXf4efFDBVzY4JY3Ral6G8T4itr7kezN5q6MJNxKBRhHpTEJE3OkR+4XRqyL22z4iYj1yQXLx9bsKYxA9IvJTg9NHI7Kwasvd0PZhqL8NfNUrMhxFUzrKhmaeMVrA0t7wBuGxZ+nKfGTBsYSgefwNhaMQkY/3yrzakcvSgjkxJAunGm8Dh4ErP4PIm/KHs/0jhVGIBTbfJe6amQkxUfMGV/QjqOArG57r/vQ978A734bTz0E+TWc6XDKdM4WOJtxgBJrEtz45LF43kTel62boHNTcL2MMrZUe/J4TkE+Jm2b1FkkLOd3QsEfuCuJREf5QW9lSOHNRwVcqnpJ99jOZGIYLr8Dl1wp52WqiYwuPslOP+w1IYfUt8R4R98EPIDEsEf7wZdh0QPL1AJFj0qVjgboReV9Vowh/3Q7pyY/3SM9+3Q4xXyszmsNXKpqpPvtILIllus9+XrH10k9koczoVYnCmvbSUlU6mdMa8qv98UYl0CT99OP94qPjckqUP3pVhpZ7g/L89o+JqA9flJz+WESGnYxF5QIRaJKxiiAXhnif/GytdAOVAY3wlYqmVJ/9N585NR31V7to33SS8NiZwqKXrbD1PtoP3kHH98/OGziuQr/BcTjFAmEsIoVZf71YKKTiMHJVWirdPhmK7vSKpXbfSSnqBmrkQkEfYKRFE4dcKEauSB9+oEEuFJvvWP5TX/Y9KsoaolRRNZbMTEf98SwdFw7SFd8HnhoxRLvjy4QP7+SJL91Ja8iPQaN6ZQZVjdJXP94n/jkOpwQL4z2S4wdJ3TTthf2PgacaLr0C8V6ZaFV/m0T4Lo981bbKsHMQywVvdVlOWyN8paIpNYB8Lknr4V8mf43OTIbo60FazkZofySoA8eV4jgcUL1ZVtGGtkvEH+8VE7TR7mkrBYDaLXDXL8OZZ2U1bmIQdj0gIj+XTFK6f1JjZbFH1ghfqWiK9dmXYgIvkWw1FlM6168oU1Q1SMomMSALppweMT1LDEoxdibeANzxJWg5JIPL3+8Sn525uXq3Hxr3SapI7ZEV5eYIH2q9npZZnNktmMlMThdWKaUxRqL8zAQ4fRKxGytdXuN9Eq3PxOkSg7VdD4oT67XXxRlz6ILk8KfGzTocYpVcBlTwlYonfKiVo48/uEhHfXF0YZWyIP46KbBOxsR6wRsS58zEoHTjzMXhlElp2z8mdYDUuET6A2eg96R09CSG5E6hDKjgKxuGW1kkpQZpyoIYAzVbZCC5wwHVhULsxJBE+pOj89/jcEoxt2kvBJvkK5+Vr3RC2jsHzkxH/MuICr6yYZB8/s39yatBmrIovlrwBCWF4/JBcMu05fFYtLhwO5ySp69qBIdHxmYaI5Ozgptl9a26ZSrKrRM+1MoTRxy0usYwWBzkF32PGqQpN0T1FonQMeCtEkvkyZhE+BNDxd/jdMlqXY9f3DOrWwoLunqlBpBf/O/zZlHBVzYO8V7Co3/J0dC/5VLDby/qkzOF5vGVRfEGxSY5lwGblwuAyytRfryn9FzbKdGf6umv3Sptnp6Adukoyi2Ty8Cxv4De0/KzyyNDqG8ANUhTboiaFmn0shawsmI7Oym2CuN9pd/ndBdE3yUdOy6vCH8ZWBbBN8Y8aow5a4w5b4x5vMjrXmPMXxdef90Ys2M5jqsoN8yFH8OFH0hRzOmE2u20H3bhdi4c5atBmnLDuP2y4MpayGfEP98TEGfNsejCnTcuz2zRT0+U5RSXLPjGGCfwR8BngIPArxpjDs7Z7B8AI9ba3cDvA/9+qcdVlBsm1g1v/6VMI7JZKbLt/BjhT36Yzl+8m7oZnTh+t4O6KrdaKSi3RvVmidgzk5LTr9sOGFmFGy/SpjmT66LvnB6Mvswsh7XCfcB5a+1FAGPMt4EvAO/P2OYLwDcLP/834D8ZY4y1Zeg7UpSZZCbhxF9C/5nrqRw23Qm7H4bgZsKHHCroyvLh8kpkPzkm4xCDWyBQD8lRidwDzQsvqnJ5xC8/myyLR/5ypHRagWszHncXniu6jbU2C4wCDcV2Zoz5mjHmmDHm2MDAwDKcnrJhsRYuvCSmVZNjUkwL7YB9n4GmPWUpiikKwU1SwE0MS/dNoFnaNpMjIvqL4fLIXWgZWHN/8dbab1lrD1trDzc1Na326SjrmaHz8P4zMBqV2aP+kKxw3Pohuk6Pc+TJl9j5+LMcefIl7bVXlg+nG2o2S0Ax1iN5fX+t9NoPfSDDdlaJ5RD8CLBtxuOtheeKbmOMcQG1QInmVEVZBpIxOP230H9aCrUuL2y+B3Z9kq5LjhsbiqIot0qguTAOsR8wYrIW3AQ4IHqiLKtob4TlEPw3gT3GmJ3GGA/wK8Azc7Z5Bvhq4edfBF7S/L1SNvJ5uPQqXC5Y0RorxbPdD0LjHjpfuFB0KIousFKWjakxhiB2x4FGaRho3C3umkPnV+e0lrqDQk7+68DzwGngO9baU8aY3zXGPFbY7E+BBmPMeeB/Aea1birKstH3Hlz8sUwQyiQlH7rjCGy5CwJNJRdS6QIrZVmpqpcFWGPd4qaJAW8tVDVB77tinLbCLMsAFGvtc8Bzc5771zN+ngR+aTmOpSgLMjEEl45Cz0kpkrm80HovtH1UonxjSg5F0QVWyrLTfABiV2DkogwxnxiWiWoXX4bIcdjxiRVtHlhzRVtFuWXyObj6OnS/LlEV0pXTZR7iyHey7PzGjzny5Es8sL9p3lAUXWCllAVfjayaHb4knTpYaSBoPii9+Suc2lHBVyqH3lPQ/Sb0nYXMOPhCdPk+T8dbQSJjmesF2u8ej/Dle1t1Vq2yMjTtB6x43ftqYWJQZtoGm0Tw4wvYLiwzOtNWqQwSQxA9DpETkOgFhw9a76Xz9A6S2dmbJjM5Xj4zwNHHH1ydc1U2FlX14oQ51iPWx/lRSI/LhSD6tlwIXF5pGy4zKvjKuqPrRITO588SjSWp9bsxBmITGVo81bR7AoRdeWjYCduPED1WfB9aoFVWlIZdMtIw0S8Tssb7oXGvjEWM90me3+UVP54yooKvrCu6TkToePrk9bbKWHJ6CHQk7acj/WWO+Xfy8rV7iZ7z4DCQK9IArAVaZUWpaigUbYfEVTOXlii/prXw84RE+o17ZeFWmdAcvrKu6Hz+7Lwe+pkk8fJU8iNEJj1Yiou9FmiVFcflkYVXxgGZlDQYjPfLhcBTLQuzchmxXiiDadoUKvjKuuJGUjHFBps4jdECrbK6VNVLnt5mIZsSc7V0QiJ+hwFvtfjnD18q20rcykzp5HNlcZpTVp9SPfSLkbeWS09+rgxnpCg3iC8ETg84HWBSkt5J9EvHjrdGxL+6BeIRyelPrdRdRiovws/nYOAsjKovSiUig8hLX8wNxSMjzdkrq44x4K+T4SjBRnluLCrRfk2ruLnmJkX0c1mdaXtDOJyy2CHRD7Grq2ZSpJSH8KFWnggfpDUo4h5inDriGCytVTm+clc1fvfsP2vN2StrBn8dYKVTJ7hZOnRGI+D2idnaxJCkdhp2lWUFbmWmdGq3SnFkvK/ggS5L6pX1ycw2zJaQn/aPVnP00xF47xm6rrrozPwisTzgcHF4bxuHD3hmb//IPs3ZK2sDTwBcPpiMiZHaWAT6T0HtNpmWlRyW5xr3lOXwlSn4UBgo7JSxYtZC/c7VPiPlFpjbhhmJJen4wQTsGISoj47Ur5HEK6+NWzq+f5YnvnSnLqpS1i7+etEl4xBDv0uvQP/70HK3pHZiV8Rzp6p+2Q9duYIPUL1JIvuxCIx2l20SvFI+irVhJnOGzkttYFuvi/311zI5fvs77wBoVK+sTfx1IvgTwxKY1m6FoXMQahORTwxKbt8XWva0TuXl8OcSbJZhBImBFfWsUJaHklbG+RBRW3RKJjlrdaCJsnZxeaQrJzkijzfdCU6X2HqnxuUCULu1LDn8yhP8fA4Gz4m3yhS1rbOvqsq6oOtEBEeJ2kuLGabFU7o9UweaKGsafx3kUiLw/lqo3w2puKy2xZbNV6fyUjoOJ2DEHtdbLVdTkMJtLguj18SvosyeFcqNMbcg+8D+Jl4+M0AklsRA0SZLPynaG1+DnZ+g4y1DMlu8E0v9cpQ1iy8E5poUab1BGZSSTcpFYOiCFG3LoFGVF+GD5MIw0pY5hTGFARhOWclWxuXLyo0xVZCdOVv2L1+7en1hVTEZd5LjicB3CH94H+G7N/NE+ADOUncB2nuvrFUcDhH9ZEz67f110r3jqZZibpksFipT8F0eqXan4zA+MP280y2r13Lp2RcDZVVYzBenGHkchG9vgto2aL6d8OGd/IdfvlsHmijrD38d2BykRuUCUNUoUX5oW8FuYfndAipT8AECDVIYiUchMzn9vDcov8zJ2OyLgbLi3ErKpcU5Btt/TnqYq5uBwmKsL92pA02U9YW3Ghzu6eJtoBEwkssvQ0smVGIOfyahNug/LdF8457pxVfBZvmljkXkAqD5/FXhZn1x/KRpv3MCam+DptnRe/hQqwq8sr4wRoqziUFJ3zjdEvVPDElOXyP8m8TplvamTELaMmcS2g4OF4xcUfuFVWIxXxyY8saxtJpBnth5ivDt9bDl7ulivKKsZ/z1gJVcPoi9gs2L6JeByhZ8kFsjbw3Ee8SkaAqnS3Jl2aQsclBWnGKpmF//SNv0Y1+a36/9LpcD/4CjO/6c8IdaYNNBSdcpSiXgqZJi7VRax1Mlw84TA2UJRCs7pTPF3NTOFL5aKZQk+sVwzVu9eue4QSmaikmNw4mn4OzfyVg4Xy0c+JwYSpXJY0RRVg1/XSEgTcuda/VmGYZSBio/wofp1E56fH6htqZVps3Ermqr5lrAWrpe/BFHnmtg5+l/yJHEk3SFviqe4a336pwDpfLw18n3yZh891ZLZqIMho8bQ/BhRmonKlfSKRwOuQPIpTW1swboevUYHUfzRNJ+LIaIbaTj8t10xW6TAruiVBouL7gDK+ICsCTBN8bUG2NeMMacK3yvK7FdzhjzduHrmaUcc1GslUULxX55tdvk+1j37Oe9wYIX9aCkE5TVIZOk8+UIyfzsKD6ZM3T+pDxFLEVZE/jrpJ44s4W8DCw1wn8c+KG1dg/ww8LjYiSttfcUvh5b4jEXxlr5il2Z7acDhfzYFpgcna6KT1HdMiO1s/yTZpQb4NyLRJPFy0pqk6BUNFPeOVNpnTKxVMH/AvDnhZ//HAgvcX9Lx+GYnhE5enV+zj7QJNNmRrtn5+wdDunayaWkgKKsLH1n4OpPaXHEir5c63ev7PkoykridIutwlS3TplYquBvstZOqWMvsKnEdj5jzDFjzGvGmPBCOzTGfK2w7bGBgVtcCZuZkD57X62kb2baIhsjwp7PzBd2b/V010564taOrdw8yVH44Dm49iYPmLco5qITT2XV7lipbPwhyE5Cpnx3s4sKvjHmRWPMe0W+vjBzO2utrJApznZr7WHg14A/MMbsKnU8a+23rLWHrbWHm5qabuazCLksDF+Qr5pt07bI8d7pbTwBifQTA/OFvaZFljuPXtMFWStBLgPnX4Srb8LQOV7O3wPM707I5a3aHSuVjS8EmLJG+Yv24VtrP1XqNWNMnzFmi7W2xxizBegvsY9I4ftFY8yPgEPAhVs75UVwusQgbeQyDJ+Hutvk+alovnpz4fsWyeOPds+2XXA4xT9/5LIseQ7ewkVHuTGshZ6TcPEV6DsJ2TRRW9pDRPP4SkXjdEmWIRmTwLMMLDWl8wzw1cLPXwW+P3cDY0ydMcZb+LkROAK8v8TjLoyvFup3SfQ4fB4Cm6YXN0xF+g6n/FIzifnLmP1106tzy7QAQkFsLT54HqInpKvKW0OLv/RaCLU7ViqeqcEo6URZdr9UwX8S+LQx5hzwqcJjjDGHjTF/UtjmAHDMGPMO8DLwpLW2vIIP0mrZsFuiyOHzMuZwSvSnCrlV9VIoGYtKKmgmtVsBK3cAyvIzPgCXXoXu41JcN07Y/RDtP78Zt2N+SsftNGp3rFQ+vlokrRMry+6XZK1grR0CHiry/DHgHxZ+/ilw51KOc8t4qkT0hy/A0Hnp3rF5KeQ6nCL4tVth4Iw4Z9Ztn36vywvBzZL/nxwT6wVleUjFIXICLh+FgVPSe9y0H+7+ZcI7DkNtL9985hSxpNxd1VW5+cYv3K5umErl43CK1iRHJLW8zFS+l47bBw17RPCHL0Ldzuk+feOQyniwGcb7oKph9mrOYLOMIBvtBs/+sgwV3nBk09D3vuTte94uXEzr4UO/Di0fAodTrY6VjU2gGfwZ0alltleoTAXLpmZ32Lg8Uph1umHkogi7OyCF2dS4RPJOz/zOHGPEayeXklZNZWlYKxfeq29Az3EYj8rvff8jsOdhvYtSFJCg01+nXjo3RC4Lgx+ImM8Ub6dbIn2nV16rqpe0zfBF8dGp3So9sONzhN1XI+1S432z7ZWVm2fkClx7AyJvye89k4Pmg/Ch3yjUTBRFKSeVJ/hOl9wSTcZg5NIc0XdJTt9dJWkaf52kdYYvyHO+WhjvnW2uBhLlgxZwl8L4AFx7E/pOQd+74lxauwXu+wfQfEDTZYqyAlTe/7JcVvLuTo945hQV/V2y+CreI6Kfz4rhWnCLbDPXXG3Kgyc1JvtUbo50Aq6+Jndekbcg3g9OPxz8Iuz8eR0xqSgrROUJvtMlApJLSyqmmOg7nNKn76kuDD8JSTpnrBuCm+Q9c4U90CSTaUa71VztZshlJbIfvkjXmXGOXPoqO+P/mSPj/ztdrk/r9CpFWUEqT/ABatvEIC09XkjvjIoL5kymTNY81XJH4KuV7dMJcBYRdmMkz5xLSz5fWRxrZVHV4Bm6ziTpuHYfEdsgPveZAB0/HFJ/HEVZQSpT8B0OsVeweRHw4Obp9sq52005a07GZFlzakxey6Ulnz8Tb7WkgLSAe2MMfiA5+1iUzovbSDJ78Hgyk1d/HEVZQSq3D9/tk0lWI5dlAVagWdI3xgk1W6a3czikN3/4grRoeoIS6ecy0rHjr5d9TVHTKr3jo91SC1CK0nX0HTp/eJXoRCMtLg+RfPGWS/XHUZSVozIj/Kl8vb9u2hXTUyX99+O9s50zYTrSd/nEWtlVJd07k6Pz7wqc7ukCbpm9q9crXa+doeO5a0QmHJK+ydYW8b8UHMZoWkdRVojKE/x8Xhb3JAblcU2rLLKKXSusYKsv+OnM6bd3OCVid7ilgOvyy4UjHp0/OSvQWGjtjOjg87mk4nS+cJ5kbrbEWwymiHt2zlo6nj6poq8oK0DlCb4xIt6j10TUjZF8PoidQs1WifzHIvNF3+mWPn2nC2xWFmdNjsHQudm9+cbIfNx8RgefzySTgkuvEi1h9GcxOIusHkxmcprLV5QVoDIFv26ntFqORWTalcsjxmiZCYhHCtOwCq+PzZl65fJIy6ZxStE3uEnSOkPnZm83VRfQwedCPgdXjsLwJVq8xQcxt4b85EsMldFcvqKUn8oTfJiO6qemXQ1fkX5wm4f+96H/jLRheoKS049dm/1+t0/SO8YhC7iqGqH/9PyLQ/WW4h48G5Frb8DgWRi5THvdq7iZbTc9ZW9cytNeve4VpfxUpuBnUyLu7oD4Sl/7mUSfFshb6H1XhD89Limb/tNyEZgp2m5/QfSRi4PDDddenx5MYK20bnprpAjcf0b2lUluPPHveRd636Pr1ChHXjvMP+v9NBmcs7cp/EraH9mH3z37Nb/bqV73irICVF5bZj4Hl38iHTQur3TeBJpEjMe65ed8BsZ6obZFXk+PywKhxABsu0/eB2K/UH+bGH1Vb5HWzQ9+AJsOFgYNF1QsMykXkcmY3B0Yp7zXWy2pI5enxMlWAAMfQPcbdJ0coOPC7SRt8T+pTGEm7dHHHwSg8/mzRGNJWkJ+2h/Zp3bIirICVJ7gY6TDxpORnP1URG5c0n1j+0WIrZWLQnCzfOUyskgoMQhtH5HZt8bItrVtEH1LxiHGrsp+th8RG1OXFxr3yV2CMVIfSCfkIjIWkS9PtRSAfaF1aRLWdSJSXKBHrsjUqp636bxyf0mxn2IqT69+94qyOlSg4FsRaY9fond/g4hsakyi/Imh6VRMblI6ckLboapO3tf3Ppz5G9j6EWjeL8Id75EOnuBmEW9Mwe1x67SAN+wSz55sCkLb5LlsSi4qE8PSIeSIyFqAQJPsbx3QdSJCx9MnSWak/TQSS9Lx9ElIjhB2vQ7RYzCZIJKpWnRfmqdXlNWl8gTf4RRDLk+gMB+yQKBR0j3j/YXe+kFIjonlQioBTfug7aPStnn1Z3DuB5Lmqd8J1ZtkGlMuDYPnRLyHLoDNSadOLiV3CMkRSf807JFJWi6/XESCm+QCkRgQW4bxfjmf6i1yvmuYzufPXhf7KZKZHJ0vXiR88DXIpegaasVAkS77aTRPryirT+UJPkBNS/HnHQVbhUCTCG+8V9otB8+IeHuD0rnTcgjOvwh970EuKRYNU6MPawupjKEPZB/BRgjtkIVYNVshl5vu5rGFBVtTOf2qelkINt4v4p+MyV2CP1TmX8itU6pdMjrhkDskXHRG78CWXEsr7Ziap1eU1acyBX8xnC4R7kAj+Guh96Tk2jfdLhH/yGV53ReC2GV4+ykZsu2tlgHc6XG6LnvovNBAdNJFS6Cb9k80Eb57s7SDTgxIS2j15uvbk4rLfl0+ifj9ddLfP3IJJmpkIdcaLO62hPxEioh+i3tCpof1nyWa+3LJ919+8nPlPD1FUW6CjSn4U7i8srLWXweXj0oKx1sLjfsl6p4YAocLrr0m0X5wMzTupauvno4zTSRzkr+PJKDjhX6IXSG8NQHjg5BNiogHm2X/niBYA8lRiex9tdPzcuM9MHC6UEBuLsssy1ul/ZF9s3L4AH6Tpb2tMEYyPUaLK04kO98crVVz9oqyptjYgj9FVQO03gvvfAeGL0lxt2az9N77a6H1QxAfAJcLQm10/shLMjfbHjmZc9D5tptw0zg4HTAek5SPt3ra7sHln87t26ysE6htg7o2afOMR6W1M9S2JqZATXXnJDM5nFhyQKs7QXvbecLONyA+BL462u9K0XHSQTIzPT9Ac/aKsvZQwU/FpRDbfUyWobn8kttPF+wSgo3SrRPaDgNn4MpPiY5+FIrkrKOTbhl6XrcTWg5L379xyl1CcggSIzDaAzYj7zdO6d/310mXT3WLzH6N90Hjntk2zivM3O6cHKYQ2V8g7Hqj0G4ahIOPEb7nEdiT1956RVnjbEzBT09MT8Eai8LIRWnT3H4/uL0weL4w+rBaCrJ120W0/XVw9llaXONEstXzdtsSQCL6eHTaanliWIq1wU1Q3So9/FMrfNNx6fyJ94rIe4JSO3BXTS8SazpYuNtY2W6eot051kXnlV2Em5+WBWb7Pgd3/iLUbCF8CBV4RVnjLEnwjTG/BHwTOADcZ609VmK7R4E/BJzAn1hrn1zKcW+JTFJy8smYfJ8YBowI7pZDssLWGxRfHV8QXG4Re5sTr5zJMUnRhLbTfucEHe9UkcxPi7Dfmad97wD4dkjPfy4NWz8M+TSkk5K2MQ4R/MyE9OhPrQuYHJM7gGQMhi5KGskTlAvBaLd08tTfJhcOb235F29ZW7o7JxsoiP3n4Z7/Tj6XoijrgqVG+O8BXwL+uNQGxhgn8EfAp4Fu4E1jzDPW2veXeOzFySTFyTI5PL3qNpMs2CDvAfKQz0o6xROQiH9iCJoOiBfPxKCkXSJvife9vw42HSR8nw+CY3S+mSY66aalCtrvThN2noTTJ2HHx6XwS64w/LzQpdO0T45tbSHST0wv7BrvF9/9xJDk8TMpEf7EkLw2chUad0sNYMqyoRwrd9OTcOxPaXE3EskE573c4hyD/Z+Du38F6ncs77EVRSkrSxJ8a+1pALNwV8l9wHlr7cXCtt8GvgCUR/DzeRi9KkKfz8hzroK/jcsrBdrqzeKeOdYtPfveGhH75LB0ytRskbTPlZ9B5LgUXf0hifbHeqBpL+FDLYT3DsGlH0k6JrAVQvfIsaNvSUrI3yArfv31khIavihdQQ6nFGXdfmkNrW0TkY/3SW48dkX2k+iXc3ZXw0Q/RMYkog7tlJSUuTYt/t7qpa/e7X0fXv/PELtC+6YDdEQ+NssuwW8ytB+IwT2/JmkuRVHWFSuRw28FZvoPdwMfLrWxMeZrwNcA2tpuIV3gcMiwEm9QbBDcPhHp7KSIee1W+XnkrLRGVm+WhVQTgyL8+Sz0vgfRt6VH3uGQ/Pum26Fxb2GoilOKuLVtIt49J6XrxlsNux+W3v1kbDqCj10T4fYEIDEMLXfJzzPPuapevhr3iJiPRaDnbRg4JxbOLh/YMbkwjPXIXUndzul6BEju31st6SBPcFb0X9IPJ5+Xu5r3/0YsJTKTEGgi7ImA+wSd3QeIZgK0uOK035kk/PDnVOwVZZ1i7CJWvsaYF4HNRV76HWvt9wvb/Aj458Vy+MaYXwQetdb+w8Lj3wA+bK39+mInd/jwYXvsWNGywI2RmRSHy3xWeuKr6iWdMnBWnmvaL2I/eEYEtape7BcGP5Be+qoG2HKXLNTKToovfqB5OgLPpmVYSqBB7gSGLkrU7quRC43TJ4+zk3KcdEJEuHabCLa/IPKlInNrxdXz2utizpYaldpAZgJwSM9+64eg+Xa5wKXGCmZxFjBybJePf/ViL08dH5xlfeB3GZ54qJZw4Cxc/JEMhvEEoXorZOJgHfJ9YkiOs/8X4Lb7VewVZY1jjDlurT1c7LVFI3xr7aeWePwIsG3G462F58pLalxSKMYh+XpPwdwr3iOi6A+JSI9cktx8415ZOdp9TPLt9Tug+aCsnHW6JIef6BfBdfpgcly6bPJZGK+VQSj+GrkDGO8XkffVyJ1A/S6o3S4DQsa6pRDr9Mo28ajcWUy5ac5MjxkDtVug5guw8+Pi5jl4XlJPyWE5975T8tlqWqHlHth0h0T5OXEL7Xqnh6eOJ+b53CSzls6Xo4R3Pi0XlobC5x+LyF1LZkIuflvuhts+KRcWFXtFWdesRErnTWCPMWYnIvS/AvxaWY+YjBXcKd0SSU/5208MS7oGJL+fGJDul5YPifheeFki94bdIva1W6cFuLZV9nP5qOT763ZIEXayEHX76yB4jwhxOikdNsMX5PFotxynaZ/cDUTfgf73wB4Ub/3UmKxanWr9rGqUO4QpjJFc//Yjctwpw7f0uKR3+k+L+PefEhtof0guAFWNdP50B3buMJIC0bRfovqqJkiPSjeSyycFa3+ttIS23CUXERV7RVn3LLUt84vAfwSagGeNMW9bax8xxrQg7ZeftdZmjTFfB55H2jL/zFp7aslnXopcVgTZ5ReRdboktRPvkbw8edh0l0TxdTtFhNPjhbRGj6R5Nt8paYyZZCZlgVZyWAqxgcZpV8zEgLw3nwNfPXjSEtk37ZO7iMm4mK1NDEoH0Lb7ZOJWz9sSUd/2SRHo5Ii4eCYGinvoO10ivIEmWT+Qjsuq3N0PSZQ+dF6mT41ckhRS7DLRidtK/qpaXONykUkNSXdOVb3UNXwhCDbJhW/L3XKxUxRl3bNoDn81ueUcfmpcCpjZSSl4To5KdJ/PQuthyYVPjkmBNJ+HCz+UiLxpvxRng02z95eMQc87ktKp3yPpn9Gr4pdT1SBinS9caNLjUkh1eqTYm0lIW2cyJncINi+dQcFmEfbBsxKVh3bC5ttlX5Oxgm9/ajrq99eDp2p28bXWS/uROsK7HZK68oWmxzFODMJoN0f+YpjIxPzWTYPl9/efI9xwTVJcnqBcvKpC4KmB6mb5Xc39XSiKsqZZKIdfuYI/3iepEuOUaDk5LFG52y9Rdc1WKXReeFmEumk/bL5DtpnJWI903YwPiNA37ZMUi7WF/vk+EffabZKzTwzK/uOF55v2SeTf/YYYpzkcIuJOd+GilIbkIGTSkkbx1cq+arZI7TUzIZ8DS9cHKTpeHCaZnf4387udPPHYXsJ7XHKHYPPylYpDYoiuMwk6TtSRzE+LvsHysfoElxMuoikvLb407XdMEL4N+Ww1LZKznzlPQFGUdcHGEvx8TpwtjUM6aqoapHibS4mQjlyedqq8+CMR87qdsOWe+dHsyBWJwidjENgEzQckrTKT1LhcMHIpicRrtkq//shVGD4H2Yx48dS0wNXX5S4hb+Vi4/SIJc/EsETkOCV/7ynk0avqwDfltJnjyLcuEYnPtjsAaK1xc/R/Oiird4cvSuppvFfuErB0DbbQeXU/0bSPFm+aB5oTfDdSO2ulsMHyld0Zfu/hLfK7mFlDUBRl3bCkLp11h8MpXTHuKommxwckrVKzVYqnLm9hqtVP5XHNNonu54r9aETuCnJZEeGG2+aLPYhwN+0vTLLqk8g60CSTsgINkqefGpDe9hHx7Rk8B9lCF4yvBjbdKcfqfRdGr0iPfnCTCPb4gFwYvEGiRcQeIDqWhrf+i9QKsinAUVhk1gRuN+GQi/DBHnns8nLk6dCsiB/AYnjqvIfDh1oJt6nYK0olUnmCD9PTqXIZSbt4ayS3ns9KIbf3HSlsVjVIHr926+z3x/skEseImVpN6+yFUnNxOCQF4w9JMXUq1VPVIHnwoUtStJ0clULvpjulZpAYKnjojMgYxYNfhLGrsuI1HgVXlRSI81nIJGipqiYyMb/jpsWflSJ1TU1hwZUBHOB0ige/x18YtxiEiRGiE8VXRlug84VzhO/dVvR1RVHWN2V24Vpl4j2SGnFXSVqmeovk1wc/EAFs3COR+Mze94nhabdLkPTPjRYu3X5pA23aLwXUxKC0ZjqQwebZtPTNT8ZEmIONkiryVhcWWP1MPHTaPixePJ6AdAelJyGbo/2OBH5nftYh/c487bePS+pnyqEznZCLhMMlNYngFunmyUwWLhz5YmcPlB5pqCjK+qcyI3yYdsf01kq07gmK+Pe8LQXXpoLYz7QdziSlF90dmBbM2luwd3D7pX2ydqukeFJxcMQhmJEi8NB5EWiDRP2ZlLhz5nKFebnnJSVjnIXPMQCZJGGfAw5sp/NCC9GkixZ/lva9A4SbRiHllO6cQKPcbfjq5ELlCcDEiKzWHe8DY2i/w/Bbb9QUHTruMIadjz+rnvaKUoFUruCPRkQwc2mgsHDp0itSRG3YJQXcmVOl8nkp6Bqn5MwzCakFFMvb3ygOp6R5poaUZ1OSk+8/JZG4OyjnNRGTO49cutABhKx6dfmk2Nt8ELAwOUa4cYTw7j45L6cHfJtlwdfUjF5jJJWVS0l66eKrMPyB1AuqW6FuO+ED+zjGKE+9cW2e6OcKRfxILEnH0ycB9blXlEqhMgU/GZNFSU5vYbZsmyy6SsUl6g40zU/TjHVL336gWe4IAk1SUF1OXF4IbZUIPHZVUjvuIOy4X+4mxiIi0qkxsW7Ip+QikR6XRVH1O8C1v5CCckg30NSoxUSfpKLSCSneTlk42LxcDDbfAw075XM53fzel+DwzobrPf0OY66L/fVfYyZH5/NnVfAVpUKoPMG3VkTTImLpDxX64nvFrriqUVbBziQ5IumfQJOIsMsn4wbLhcMp6aSELI5i4Iy4dtZulVx/ekK6elJjIvZTbZvJmPTvOwrpmynLiNR4ITU0Lnn6VFy22XRQbCOqN0stYo6NdfhQ63Ux3/n4s0VPVXP6ilI5VKbge6slZeLyySrWgdOSy67eLII6M02Tz4nougNcn4DVsKf8U6VAUjCeYCGyjxScKTdJP/+Ud016QgQ8WxjmkhqV5zIJuThZK5/TUyUi76uTonFom/ju3OBoxJaQn0gRcW8Jrf4wdUVRlofKE3yHQyJZh1P876/8BBweyYVX1c1fPRrvlQJtdYsUbP31022dK4HbJzWFyVG5M4ldEfH310mnj7tq2ulzJvl84SIQlzuU7OT0YrNg803PwG1/ZN+soeUgq3jbH9m3xA+oKMpaofIEP5cVAQw0iSNlNiWR7tSCq5lkJiV1UtUgC5+MQ3ruVwNfrawXSBU86KdM1EBaSKc8860Vp8/s5PR7PUGpU/hDtzzsfCq1U3RIiqIoFUHlCb7TJSmNwXMSvdduA5dHhHxux81YRETe6RORrW1bWlfOUjFGCsW+GrlwZRKF9M2E3IVg5Hxd3kL075c7AJdnWQ4/M6evKErlUXmCDxIl9703nZ7xBKXLZSaTo1IUDW6Wrhx3QKwQ1gpOFzhr1cBMUZRlo/JW2uaycPU16VEPFSwCaudYBUx18rh8QCFFop7viqJUOJUZ4U8N8shOSjF2bspjqshZ01Jo16xb2CtHURSlAqi8CN/pgq33yYIjl2/+5CprxWLA5ZeirbXl7blXFEVZI1Se4IMIei49eybtFFPRva9GOnOCzctW9FQURVnLVJ7g53NShPXXyQKsmcyM7tMTYmcQ3LQ656koirLCVF4O3+GUUYSOIh9tKrqvapA2zJqtt9y3riiKst6oPMGH2S6YM7meu09KF8/c+bWKoigVTOWldEoxOSrRvcsrC5mqt8zP7yuKolQwG0fwxwfEYTKTlO4df91qn5GiKMqKsjEEP50o+OO7xT++erNG94qibDg2huCP9wMOmSnrrtLoXlGUDcmSBN8Y80vGmFPGmLwx5vAC2102xpw0xrxtjDm2lGPeNNmU+MY7XWCzEt0riqJsQJbapfMe8CXgj29g2westYNLPN7NkxiQ6Ve5rBikqRmZoigblCUJvrX2NIBZq/nwfE767eWBRveKomxoViqHb4EfGGOOG2O+ttCGxpivGWOOGWOODQwMLO2oE8Mi+jZfiO6XeSi5oijKOmLRCN8Y8yJQLDT+HWvt92/wOB+31kaMMc3AC8aYM9baV4ptaK39FvAtgMOHD9sb3H9xJgYhlxGvHI3uFUXZ4Cwq+NbaTy31INbaSOF7vzHme8B9QFHBXzZScem5tzkZgKLRvaIoG5yyp3SMMQFjTPXUz8DDSLG3vCQGpf/e6VODNEVRFJbelvlFY0w38FHgWWPM84XnW4wxzxU22wT8xBjzDvAG8Ky19u+XctxFyWUgGZM5sF6N7hVFUWDpXTrfA75X5Pko8NnCzxeBu5dynJsmMQipUZliVa3RvaIoClTiSltrRfCzKem51757RVEUoFIF3+WVQq3m7hVFUa5TeYLvcEhnTlUD+EOrfTaKoihrhsobgJLPSe5+7nhDRVGUDU7lCb7DCaG21T4LRVGUNUflpXQURVGUoqjgK4qibBBU8BVFUTYIKviKoigbBBV8RVGUDYIKvqIoygZBBV9RFGWDoIKvKIqyQTDWLm2oVDkxxgwAV5ZhV43Ayg9QLx/6edY2lfZ5oPI+UyV/nu3W2qZiG61pwV8ujDHHrLWHV/s8lgv9PGubSvs8UHmfaaN+Hk3pKIqibBBU8BVFUTYIG0Xwv7XaJ7DM6OdZ21Ta54HK+0wb8vNsiBy+oiiKsnEifEVRlA2PCr6iKMoGYUMIvjHm3xpj3jXGvG2M+YExpmW1z2mpGGM6jTFnCp/re8aY0Gqf01IwxvySMeaUMSZvjFm37XLGmEeNMWeNMeeNMY+v9vksFWPMnxlj+o0x7632uSwVY8w2Y8zLxpj3C39r/3S1z2mpGGN8xpg3jDHvFD7Tv1lw+42QwzfG1Fhrxwo//xPgoLX2H63yaS0JY8zDwEvW2qwx5t8DWGv/11U+rVvGGHMAyAN/DPxza+2xVT6lm8YY4wQ+AD4NdANvAr9qrX1/VU9sCRhj7gfGgb+w1t6x2uezFIwxW4At1tq3jDHVwHEgvM7/fQwQsNaOG2PcwE+Af2qtfa3Y9hsiwp8S+wIBYN1f5ay1P7DWZgsPXwO2rub5LBVr7Wlr7dnVPo8lch9w3lp70VqbBr4NfGGVz2lJWGtfAYZX+zyWA2ttj7X2rcLPceA00Lq6Z7U0rDBeeOgufJXUtw0h+ADGmH9njLkGfAX416t9PsvM/wD83WqfhEIrcG3G427WuaBUKsaYHcAh4PVVPpUlY4xxGmPeBvqBF6y1JT9TxQi+MeZFY8x7Rb6+AGCt/R1r7TbgKeDrq3u2N8Zin6mwze8AWeRzrWlu5PMoSrkxxgSB7wL/bM7d/7rEWpuz1t6D3OXfZ4wpmXpzrdhZlRlr7aducNOngOeAb5TxdJaFxT6TMeY3gc8DD9l1UIy5iX+j9UoE2Dbj8dbCc8oaoZDn/i7wlLX26dU+n+XEWhszxrwMPAoULbJXTIS/EMaYPTMefgE4s1rnslwYYx4F/gXwmLV2YrXPRwGkSLvHGLPTGOMBfgV4ZpXPSSlQKHD+KXDaWvt/rvb5LAfGmKapDj1jjB9pGCipbxulS+e7wD6kC+QK8I+stes68jLGnAe8wFDhqdfWc+eRMeaLwH8EmoAY8La19pFVPalbwBjzWeAPACfwZ9baf7e6Z7Q0jDF/BXwSsd/tA75hrf3TVT2pW8QY83HgVeAkogUA/9Ja+9zqndXSMMbcBfw58vfmAL5jrf3dkttvBMFXFEVRNkhKR1EURVHBVxRF2TCo4CuKomwQVPAVRVE2CCr4iqIoGwQVfEVRlA2CCr6iKMoG4f8Hp6ECi7dFV04AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ec3190d",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "8b941748",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.585518Z",
     "iopub.status.busy": "2022-04-21T10:20:31.585332Z",
     "iopub.status.idle": "2022-04-21T10:20:31.600051Z",
     "shell.execute_reply": "2022-04-21T10:20:31.599606Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e9e68a65",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "0aab02e4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.602528Z",
     "iopub.status.busy": "2022-04-21T10:20:31.602168Z",
     "iopub.status.idle": "2022-04-21T10:20:31.605359Z",
     "shell.execute_reply": "2022-04-21T10:20:31.604961Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "44833f63",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:31.607207Z",
     "iopub.status.busy": "2022-04-21T10:20:31.607022Z",
     "iopub.status.idle": "2022-04-21T10:20:37.143537Z",
     "shell.execute_reply": "2022-04-21T10:20:37.142972Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-21 10:20:31.611539: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a6b548d9",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "29b98b0d",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f9a0e7a8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:37.146353Z",
     "iopub.status.busy": "2022-04-21T10:20:37.146130Z",
     "iopub.status.idle": "2022-04-21T10:20:37.150921Z",
     "shell.execute_reply": "2022-04-21T10:20:37.150485Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "494151a0",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "53dc472f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:37.153249Z",
     "iopub.status.busy": "2022-04-21T10:20:37.153056Z",
     "iopub.status.idle": "2022-04-21T10:20:39.026718Z",
     "shell.execute_reply": "2022-04-21T10:20:39.026228Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "77a34b54",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fa922b72",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5ba1d792",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:39.029402Z",
     "iopub.status.busy": "2022-04-21T10:20:39.029190Z",
     "iopub.status.idle": "2022-04-21T10:20:39.044538Z",
     "shell.execute_reply": "2022-04-21T10:20:39.044124Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "1e13cb88",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-21T10:20:39.046767Z",
     "iopub.status.busy": "2022-04-21T10:20:39.046575Z",
     "iopub.status.idle": "2022-04-21T10:20:40.739179Z",
     "shell.execute_reply": "2022-04-21T10:20:40.738747Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4d618775",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
