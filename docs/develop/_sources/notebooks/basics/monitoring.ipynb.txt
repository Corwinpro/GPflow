{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "53d18558",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "87fefc2f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:34.950182Z",
     "iopub.status.busy": "2022-03-30T11:24:34.949941Z",
     "iopub.status.idle": "2022-03-30T11:24:37.846927Z",
     "shell.execute_reply": "2022-03-30T11:24:37.846422Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-30 11:24:35.853112: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-30 11:24:35.853141: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2eac10ab",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "4a0cbb8a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:37.849680Z",
     "iopub.status.busy": "2022-03-30T11:24:37.849471Z",
     "iopub.status.idle": "2022-03-30T11:24:37.852056Z",
     "shell.execute_reply": "2022-03-30T11:24:37.851650Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac15a3a6",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "dd6df2a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:37.854012Z",
     "iopub.status.busy": "2022-03-30T11:24:37.853836Z",
     "iopub.status.idle": "2022-03-30T11:24:37.856219Z",
     "shell.execute_reply": "2022-03-30T11:24:37.855829Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "677c2d9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:37.858104Z",
     "iopub.status.busy": "2022-03-30T11:24:37.857929Z",
     "iopub.status.idle": "2022-03-30T11:24:37.951904Z",
     "shell.execute_reply": "2022-03-30T11:24:37.951468Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f088a2973d0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ebb56f07",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:37.954220Z",
     "iopub.status.busy": "2022-03-30T11:24:37.954016Z",
     "iopub.status.idle": "2022-03-30T11:24:38.004710Z",
     "shell.execute_reply": "2022-03-30T11:24:38.004261Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-30 11:24:37.956045: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-30 11:24:37.956072: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-30 11:24:37.956093: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (d1d32b99450c): /proc/driver/nvidia/version does not exist\n",
      "2022-03-30 11:24:37.956377: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f088a04eb60&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f088a04eb60>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b9289763",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:38.007256Z",
     "iopub.status.busy": "2022-03-30T11:24:38.007049Z",
     "iopub.status.idle": "2022-03-30T11:24:38.144985Z",
     "shell.execute_reply": "2022-03-30T11:24:38.144508Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5a428cdc",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "046dc30b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:38.147407Z",
     "iopub.status.busy": "2022-03-30T11:24:38.147204Z",
     "iopub.status.idle": "2022-03-30T11:24:38.292842Z",
     "shell.execute_reply": "2022-03-30T11:24:38.292319Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69c5b425",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1aa09561",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:38.295560Z",
     "iopub.status.busy": "2022-03-30T11:24:38.295352Z",
     "iopub.status.idle": "2022-03-30T11:24:38.298511Z",
     "shell.execute_reply": "2022-03-30T11:24:38.298072Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d9acd1d4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:38.300535Z",
     "iopub.status.busy": "2022-03-30T11:24:38.300371Z",
     "iopub.status.idle": "2022-03-30T11:24:44.191958Z",
     "shell.execute_reply": "2022-03-30T11:24:44.191445Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-30 11:24:38.304792: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a24c14df",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5785bc66",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "e7b9f2fa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:44.194709Z",
     "iopub.status.busy": "2022-03-30T11:24:44.194499Z",
     "iopub.status.idle": "2022-03-30T11:24:44.198955Z",
     "shell.execute_reply": "2022-03-30T11:24:44.198535Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e68413ac",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "bd54056c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:44.201057Z",
     "iopub.status.busy": "2022-03-30T11:24:44.200877Z",
     "iopub.status.idle": "2022-03-30T11:24:45.980553Z",
     "shell.execute_reply": "2022-03-30T11:24:45.980041Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "08d0dd97",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b7a1085e",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "6be8dd49",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:45.983348Z",
     "iopub.status.busy": "2022-03-30T11:24:45.983143Z",
     "iopub.status.idle": "2022-03-30T11:24:45.998508Z",
     "shell.execute_reply": "2022-03-30T11:24:45.998068Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "89e574c5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-30T11:24:46.000718Z",
     "iopub.status.busy": "2022-03-30T11:24:46.000530Z",
     "iopub.status.idle": "2022-03-30T11:24:47.976109Z",
     "shell.execute_reply": "2022-03-30T11:24:47.975669Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a228fd46",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
