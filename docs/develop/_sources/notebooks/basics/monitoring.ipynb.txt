{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "4e18f4dc",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1b58ad39",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:38.881081Z",
     "iopub.status.busy": "2022-04-25T14:12:38.880871Z",
     "iopub.status.idle": "2022-04-25T14:12:41.885148Z",
     "shell.execute_reply": "2022-04-25T14:12:41.884665Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-25 14:12:39.832670: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-25 14:12:39.832697: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca98dab7",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3afd7366",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:41.887766Z",
     "iopub.status.busy": "2022-04-25T14:12:41.887555Z",
     "iopub.status.idle": "2022-04-25T14:12:41.890173Z",
     "shell.execute_reply": "2022-04-25T14:12:41.889784Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ff8ed87",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "16c57fc7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:41.892537Z",
     "iopub.status.busy": "2022-04-25T14:12:41.892347Z",
     "iopub.status.idle": "2022-04-25T14:12:41.894993Z",
     "shell.execute_reply": "2022-04-25T14:12:41.894563Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3ef44338",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:41.896902Z",
     "iopub.status.busy": "2022-04-25T14:12:41.896723Z",
     "iopub.status.idle": "2022-04-25T14:12:42.009622Z",
     "shell.execute_reply": "2022-04-25T14:12:42.009074Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f8270f354e0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ce5b9224",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:42.012508Z",
     "iopub.status.busy": "2022-04-25T14:12:42.012222Z",
     "iopub.status.idle": "2022-04-25T14:12:42.061162Z",
     "shell.execute_reply": "2022-04-25T14:12:42.060620Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-25 14:12:42.015230: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-25 14:12:42.015260: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-25 14:12:42.015280: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (dec64466f543): /proc/driver/nvidia/version does not exist\n",
      "2022-04-25 14:12:42.015543: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f826ed78910&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f826ed78910>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6098aaf6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:42.063458Z",
     "iopub.status.busy": "2022-04-25T14:12:42.063254Z",
     "iopub.status.idle": "2022-04-25T14:12:42.249159Z",
     "shell.execute_reply": "2022-04-25T14:12:42.248603Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXwAAAD4CAYAAADvsV2wAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAABEL0lEQVR4nO29eXTc53nf+3lnH6yDjcsABPdNshZK0GbKii3bkmLH1sSOs942ubmJ2nPq29Y3F71Ck9Zp6l6pxWmW9ua0URM3dqNjO7VkWK5l04tkS5ZMSaRIkeK+A5ghiXWwzj7v/eMZECAxAy5YBph5PufMIWbmN7/fOyD5vO/veb/P9zHWWhRFUZTSx1HsASiKoihLgwZ8RVGUMkEDvqIoSpmgAV9RFKVM0ICvKIpSJriKPYC5aGxstBs2bCj2MBRFUVYM+/fvH7DWNuV7b1kH/A0bNrBv375iD0NRFGXFYIy5UOg9TekoiqKUCRrwFUVRygQN+IqiKGWCBnxFUZQyQQO+oihKmbCsVTqKoiwPug6E6dxzgkg0RjDgp/3x7YR2NRd7WMpNogFfUZQ56ToQpuPFw8RSGQDC0RgdLx4G0KC/wtCUjqIoc9K558SVYD9FLJWhc8+JIo1IuVU04CuKMieRaOymXleWLxrwFUWZk2DAf1OvK8sXDfiKosxJ++Pb8budV73mdzv5yI4mdj/7Chuf/i67n32FrgPhIo1QuVF001ZRlDmZ2pidqdL5yI4mXtgf1o3cFYZZzj1t29rarJqnKcrCsVDyyt3PvkI4Tw6/rsJNhcel8s0iYozZb61ty/eervAVpUyYt7wym4XUBKTiBTdshydTDE+mZpz/EGSzhO5dtzBfQpkXGvAVpcSZWtXnW5FPySvzBnxrITkOiTFIjENqEpCMQLDaSXgsM/szs86fpfPl9wg1dENFPbi84KkGXw1dhweujMtpDBlrada7gkVFA76ilDDXrurzEY7G2P3sK9NpmEdbCW1xQmIUbFZW9sbIn5k4xEZov22cjn0VxDIzdR8WMLPOH5kAzr8Jbh/4A+Cvp6vbQ8frSWJpOSaTSy3rXsDiogFfUUqYfEVT12Lgyuo/HI3R8dIJ+IVKQlvdkJiAxAjEozA5CLFRyCQJuS1sXk3nhU1EEj4cWDIFRH9B1zh07wXjAIcT3H46j3ySWDq/rHPOuw5lXmjAV5QS5nrFUYapJM00sTR0/nyMUMUFmOyHuAR5UnFJ66QTkE0RSh8ktCYBmRQbev9VgStY2qt/AGMXwekGpwdcfiIJ35zjCkdjdB0Ia9BfYDTgK0oJEwz48+buAZprPYRHknnfi0wauHRYNmkzScikZYWO4UraxlMNjhq6RrfnnTgA6pxJQi0TkGqSySKbhvgwQdcY4XTNnGPvePEQMHdqR03dbg4tvFKUEiZ/0ZSDP38swBufjtHsT+f9nAPLxnc+xe4jn6ZrdDt4a8DhklV+Oi45fZcbvDV09t2DzZO7N1i+uOEo+AJQVQ9Vq+VndyXtgdcweaeIaWKpLJ3ffU82jPMwtT8RjsawTOf/tQCsMBrwFaWECe1q5pnP3EFzwI8BmqudPHN/kpD3Xbh8hPZ1J/E7rg36ko+3GMKpSjq676WrxwsTfeB0Qk0zNO6AtbtgXRuRZEXea1sMoYfvhu2fgE2PwvoHIXgXNGwgtHb4OuFeiIxnYd/fQP9JucuYgZq63Tya0lGUEid01xpCwRG4fARGeiQnPzwBiTFClTEIDtJ5eReRVGXezdeYddM59hih3bugqhH89eCpzOXjPQRregmPzr5TaK71wdYPyd0AAEZUP8lxGL1E85kzhCdn3xnMJOiJw4U3Yagbtj8BLfeKvBM1dbsVNOAryjKm60CYf/OdI1eKmQJ+N3/86dtvOE/dtfconT84Q2TSEPQ6aV+fJhS4BJMjkBiGbJqQ7yKh9Qcgm2bj2S/kPU8k4YPNHwZvFbgrwOWTh8PBR27L8vze7qtW7H63k/YndoDLM/tkrnqoqKf9U7V0vHiIWCqb95p+k6K9+QhUrIKJy/De12D4PGz9OARaC+5PqKlbYRYkpWOM+bIxps8Y836B940x5j8ZY04bYw4ZY+5ZiOsqSinTdSBM+zffuxLsAaKxFO3/873r56lTMbpefpmOl84QnsylZxJeOk5to+ssMNYrahvj5IpWx19H0JvIe7pavwtW7YDaFllheyrA4aDrQJgX9oevCvYG+Oy9zdedlCTddOeVdFOd30nAncVgaXaO8EzgJULZH8FIrxRsZZJw9ifw7v+AS4dp/9jGvKZu7Y9vn/t3U8Ys1Ar/b4H/D/hqgfd/EdiaezwA/Jfcn4qiFKBzzwlSmdmZ7lTWFtapp2Jw6RBc2EvnWy3EslfLH2PWTefwI4RqT4vqxu2HqlWw5i7Y+CHat3lp//Zprl10R2Np/qjrMF8K3TFrjNfm0S3w6vH+G/qOoV3XTAyJMcnXnzgIPYMQd0gNgLUyyWQz0HcEJvoJ3fYkfHobnT8+ryqdG2RBAr619jVjzIY5DnkS+KoVp7a9xpiAMWattfbiQlxfUUqRQnJKyJOnTidh+JzkuwfPwtglIonN+c+bqWF39+/TviVC6MHboPUBuo5P0PlVkTeaAmn15/d207a+/qqAuuB5dG81BO+Wity6VjjzKkR7IRODtFOUQRjR9b/7VUI7fonQF56QzynXZaly+M1Az4znvbnXZgV8Y8xTwFMAra2tSzI4RVmOTPnL5ONKnjqbFfXM5feh+x0YOgcT/TDRR9DxC4SzdXk+bQinqug4vQPu/AAcn7jKfqGQga6FWXcWi5JHdzihYTN4a8HXAGd/DINnIDkBVIHbIzUAqTF4/5t0HR+j82wrkZGErvKvw7LbtLXWPgc8B2KPXOThKErRKBTsQfT1xIYh2iO2Bb37YDQMk6OQngQM7YHX6Bj+BDHrznuOWCp7RcJ4PfuFKa5dubc/vn2WV8+C5dGrGmHro+DxiRfPpfchOQKOasABnlq6+lbR0VtPzMreg3rxzM1SBfwwMNMftSX3mqIoBWgusHquq3ARWheD7mNw4n/B0GmIj0AiDjYDLhe4qggF+qDhBJ3h2wvKH2829XLtyj1fc5QFXWG7/bDpw/Knpwoi+yAWlVw+WTov75o1oakXT2GWKuC/BHzeGPN1ZLN2RPP3ijI3+VfPDr74cCWc3COKlfHLkMlANgVkwVsJFfV0ZR+ms3snkQlDMOAnYNNEY6lZ15gK4HPtF0xfO//KfdbG60LjcML6D4oM1OmGiwdhvB/i40SS+VNHqsXPz4IEfGPM14APA43GmF7gi4AbwFr7X4GXgU8Ap4FJ4H9fiOsqSiky079+5rq8zufgi/dZQqN/D2ePiZNlNivFTA4DlY2w6na6zIfpeMtNLC1Sm3A0httpcDsMqex0mmhmAM+Xlvnsvc28erx/+Shgmu8RewenCy4egpEwQdc44fTsDdtglUM2svPVAZQxC6XS+Y3rvG+Bf7IQ11KUUuZa//qZWfx4Kg3nXgPHAbBpSCXkCF+1bHJu+DBs+QU6/+ossfTVK9xUxl63/eCKMCFbe+e0zbLTSfuqt+m4+MhVaR2/SdO++hD01sCaD4CvtogDXl5oT1tFWUYU6hU7hZMsWQxBR5T26h8RWhuFjQ/Djk9C4zZwOtn49Hfz+tQY4Nyzn1ysoS8d1kLfUZGgXj5G11lLZ//9RNLVBH1J2rf1E3L8TKSad34OVn8AqpqKPeolQ3vaKkqRuVEb3+vl0qd8bsLZOjrGPgP3VBDa/chVqYuStxwwBpp2QCYFxknIcYxQzfOQjkHFarkL8D8C3W/A+y/KbVLTVjF9K1RkUCaoW6aiLDL5bHy/8I2D/FHX4VnH3Uw4imWd/PHe7Kw8dX5L5BKzHHA4JeivvUvSNqtuA4cHJi9JTUI6Bls+JpW7J/dA/wkpTMvm9+0pFzTgK8oiU8h+4Pm93Vd54nTuOXFDlsEzicZSs3x1ZlkiB/w885k7lmdOfj64fdC4BVbfnnt8AIxLahMuHhTvnY2P0NXjZfffjbDxPxxj97M/pGt/z3VPXapoSkdRFplCaZprK1fnlhLmbxAOs6tfYQmkkssFX60Yulkrq36bgsgBGDgNTi9drsfo6G660mw9PJqm41uHAUvo3vKr5NcVvqIsMs458sZXgvx4P8GKQtWuhYP9VecoV6rXiINn4zZofRAabwcs9B2jc3/mSrCfIpa2dH7/2KyGKuWABnxFWWTmskgIBvwwehHe+wbtda/hN1cXR/kdGeYK9lfOUe7UbRB5at1G2Pww1G+AbKpgs/TIWAqGzpZdTl8DvqIsMs0FArIB2h9pgv1/C6d/QMj1Ds9U/U+azZB4wvszfLZt/Zx3CG6nKa3N2FvF4ZRg7/ZB/WbY+hhUryXoHMl7eNCfFWnn0NnCbnEliAZ8RVlk8qlmDPBbu+oJTbwA516H8QEYu0jI9SZvbP8m536/hvZP3cMLBy7OeYdw07u8pYzbB4FWUS2tvh22PU5709v4TfKqw/yOLO07h2FyWHoHDJ8vm6CvAV9RFpmZqhmQnL4FXj0aoevwIEwMwNhlMFlY/zB86i9g8yN0/uDkdV0sp5qhKDn8dVDRIHr7dW2E7g7yTNMrNDujctdUaXnm/jih4Ci4vTA5JE6j0e5ij3xJUJWOoiwBU4qZmbYJ4YSPjr5HwXeJUNUobH0cHv1XUN0o79/gZmzZb9peQ9cZQ+f3+4iMpQlW30l70MUb1V+G2CjUb4I7/k8YjEp3sOq1MNoLPW+Dww21wWIPf1HRgK8oi8S11bUTifSsFXsMD38Q/wew6SyhJ35f3C5zzNUAZSa6aTtN14EwHV1HpifVsSwdZ3bA+hgh76sQPS97Jm3/QAq0khPQsBUGTkLPXnDshurVRf0OTAxAYhQCG8CxsEkYDfiKsghca4I212o9g5OOU9vZ972zV7lT3kiwL7kK2nmSr8gtlobOS3cT2nYKhi/AwFE4+pJU4g6fA49fqnYHTsCFN8R/v6K+OF8gOSlN273VCx7sQXP4irIo5As8cxFLZXl+b/dV9guFtDlOY0q7gnYeFOyxO2Fg84ehZi3ggMi70PMW+AIw3icW003b5eezP5EN3aUmk5YJaDQsewqLIBnVFb6iLAK3kle/dj0/VW4183W/26lBfg4KGsdVO6HlAYhHxXRtNAzhd8FVIfr90Qg0bIHVO6H/JJz7KWz4EFQ2LN3goxdkoomNgNO3KEZvusJXlEVgofLqFkrfE2cBKSSB/cgGr8g1m++DtXdA5SqYHITLRyAxDmMXYaQbPLVSsRuPQs/PRT21FIxelLuLxIi0c2zetSgBX1f4irIISHvCQ8RSN3Zbfu1KformgJ83nn50QcdWyoR2NbPvwhDP7+2+8vu0wAvH47QFLxPatQGC94hiJx2H8TCMBqBqDQydA+OEpm3SMnJ8AC4fluMCrYtnrTzeJ3n7xLg0d6nfJPLSRUADvqLcAoX87We+HvCC18SIWh/57BGcxpC1lmDAz0d2NPHC/vCsNoO6IXvzvHq8f9bkGUtl6fz5OKHtAxC8C5JjkJ4Q2+RoL3hrwOmBwTPygYbN0iJxahM1kxT7Bqf72svNj/F+KfyKj+Q6c2XFG2iRJhcN+Ipyk+RT4HS8eJh9F4auCtrDCQAffuKkcZOa8d/NAL/xwDq+FLrjymtt6+tXRpvBZU7BjdvRtPTETU7A2rshPgaxcVnlj0VkZZ1Nw+ApyGagJgixQbpOxOjcd5rI2EmCtV7an9i5MH8vEwNi7RAblnoAt09qAyoWb99AA76i3CR5pX+pDF97qyePlNIQww9cndqxwAv7w7Str78SPMrG0niRmbPjV6AVhs6IOmftXRAfhfOjssr31eU0+DbnsZOhq6eCjr1xYhlZcYdHEnS88B5YS+iellsf5NhluUY8CjUtUL9RxuWvkybti4Ru2irKTVJoBTm3bn72f7VYKsMf/P17sxqYKPNjzo5fvhqobJJAW9UILbsk8BtECplOSh7f5YHxfjoPmCvBfopY2tL5vSOQit/aAEd6oe+YjKF2newZpCZFGlq5uL13NeAryk1SSIHjvIW0a8ZaOl48rEF/Ablux6+aZnBXyiZp5WpouU8cNmODEozdFWKzkE0RmcwfIiNjaeg/ntPw36DxWiYlewQXD0EmIRW+TdvlWuN94KkCT8XC/BIKoCkdRblJRIFz+JoNVgefDUZ54YKPGJ45Pj2bWCqTt2uVcuvMmR4zRlIo/cclZx9ogQ27JZc+fBYqApLjT04Q9KcJx2Zv1AZr3DIxjIbFgK1mbW7TtQDj/bJBPNEnx62+HapWy1jGLosqqHrDQnz1OVmQFb4x5gljzAljzGljzNN53v8dY0y/MeZg7vF7C3FdRSkGs1eQPp5pi/Ol9J/xjPerOLj5Ckk1QFtinG5R3WBEgdO0DVp3g9MLl4/B4EmoDtJ+jxO/8+oVvN9paX/An0vDIBPFwGkYOCV7AlNksxLoe96B8z+D2JAUd617YFqJk83A+GVRCXmrFv1rz3uFb4xxAn8JfBzoBd4xxrxkrT16zaHfsNZ+fr7XU5RikE+G+cbTj8p/6vNvwp4/g7HLhLx97PMc5u/G7pp1jt2b69l7djhvrl8N0IqAt1qUOCO9oo5Zdy+MX4Lwfug/DU4/oQ88AL40nW/FiIxnCXoTtG/uJVTfABNrRPUDUiEb7QXeFy29u1JW7ckxmVyq18CqHbP19eOXweYUQUvAQqR07gdOW2vPAhhjvg48CVwb8BVlRVJIhgkQah6H1zvp6ltFZ/z3iNh6HAVy+ecHY/zHX70rTzpI9fZFo2qVyDTTccnFb38CJi7DSFjSO74qQtvuJPSBevBUix1DXxRGEhLYjQPSCVntJyfF5TI5IQsBXw2s2gn126B6lVwvMSabwsaId85oBLy1uT2DjHTuWkQWIuA3Az0znvcCD+Q57rPGmEeAk8AXrLU9eY7BGPMU8BRAa2v5dZVXlh+FZJid3ztKaOe36Or20xH7VWJ4AcgU2MOLRGNX8sqqt19GBFplhT92UVbmO5+EA38H0TDgFL+dph3g8sPGD4HLLav52nXSVjGbkr2AbEaKt5wemQAm+mBiEPqPwMh5uaPwVMokATB2SSaIug1weXx6PMYh51i1c8G/6lJt2n4H+Jq1NmGM+UfAV4C89eLW2ueA5wDa2trKo++YsqwpXMiTgHOv0znZfiXYz8VU2kb19ssMh1M2cTMJ2UCtbIQtj8LpVyTv3rNXgr7TLav2lgdkpX7xkKRiGjbnP2/TNpFuTvSLb086LrJPT0VO2eOAVbdL0RVWZJnZjPy5SJW2C7FpGwbWzXjeknvtCtbaQWttIvf0r4F7F+C6irIkFMqvB50jEI8Ssdf3Tte0zTLH7YfAenHOjA3DmjugcUsuZZOE8z8RC4SxSxL0N35YJorTP4KJoTnO64PAOtH6r74dalskpTN0FlLjcncQj0qQ91SKcqe2edFy+gsR8N8BthpjNhpjPMCvAy/NPMAYs3bG008DxxbguoqyJOQt5DEp2j3fAoeToGs87+fUt36FUVEvenyHQ7xtNn5EgrtxQjoFZ38qDVSi3RKUtzwqqZsTL0MsOve5jZGUTmCdWCcE1on+v6JRVEKjYem6dek9KcoaOrcoX3HeKR1rbdoY83lgD+AEvmytPWKM+RNgn7X2JeCfGmM+DaSBIeB35ntdRVkqZuXd3eO0u18k5H4batbRfrufjrcMsfR0BlJ961co1WtkEzbyLrgNrHsIzr8O/oBMAudek9W4t0pslNePwoXX4dzr0PogVF2nUjYVE2VOZZPsHUyRSclmb3JSfPFTMUkzLTDG3miVWBFoa2uz+/btK/YwFEVIjMP3noYzr8h/Tn8dtP0ubHuMrp5KOn94SjdiSwFroe+o9Lz1VMOl9+k6naazdyeRuFukmbssoY89Ip48Z38iK/9VOyRlU7suvx9ONiNa/WwKmnbOPiY+mnPmTMhdQE3LLbU5NMbst9a25XtPK20V5UbIZmHvf4MLb0JiQjbeNj4KGx+Bug2EVvkI3bvu+udRlj/GSEBOTsLgGbqiG+k46yWWlbReOOGj4+0MZH9M6JH7Yc2dkJqQzVm3H5LjEvhnau6zGbFVSMdl5T4z2CcnZNUfHwGXT4qzvNWL8tXUS0dRboRTe+DIN0W14XTJf/I7f1nK8t2+Yo9OWWgcDmhpg0ALnYd8V4L9FLGsk85DfujdJ9bK7qpcHt+IpHL4fC7AJ6aDfWpSJJi+WnltckhW/AMn5e6xei00bl+0YA+6wleU69N/Gn7+X2D0kjyv2wB3fU427iobizo0ZRExBlruJzL5w7xvR+IuyI5JUK9eIy0Sz70md33uSjFEi+ZSNC6fpHrScQn+iTHAyuRQ0yIpnFtI39wsGvCVsqdQ9ypAbutf+w909VbROfFFIraeYCJN++AaQrevL+7AlcXH5SFY6yU8kpj1VtCbgOFuqZLd8DBs+wScfBkuHYLVH5CgPnhK/g1VrYJsUnL+7grZtPXV5gqxFql1Yh40paOUNVO2CeFoDMu0bcIVu+I3/5KuE0k6xn+FsG3AYgjH3HT8eJiu9y4VdezK0tD+xE78rquDst+RoX39GamUHT4nSh6HA4L3isxypFeC+YYPwZ2/LumhKQsFX43k971VSxrsQVf4SplT0DZhzwlCVcfg2HfoHPu9WZW0sVRWLY3LhNCuZrCWzu8fITKaJuhP0b59gFBjDEajMBmVgqzRsGjrHS75OXj31dLKKUnmxIBs8Lr8Ivf0VsuqfwmCvwZ8pawpaJsQjcHev4XRXsIFKmnztdFTSpPQPS2E7l4rnvY9b0MyDjV3QeUqeQ0gNiKBf/PH4eJ+qaYNtE4born9sv9Tk5bq2skh8e8ZuyjFXZ5KcHnFotnlmdtf/xbRlI5S1hS0TfDGoe8IXfF7KLTuMqCdqsoJh1Mana++Laey6RcvnJb7wO2VVM7AKRg8DoENsoofPD37PE6XbPY3bYPVd8gk4A+IAdvkEIz2QjSvt+T8v8KinFVRVgh5bROclvbKlyExwR/HPoctEPItkhJSygi3D1bdBg2bxAM/NiATwOo7JSUTi8L5N6Txibcq17t2tPD5nC7J5wdapd3h2jtlEihkyDZPNOArZc2s7lXVTp5p+iGh7Ct0ZR4iSuWcn9dOVWWIt0pUORV10xLLdfeJQZrbKzn6Mz8Wp8wpV83sTXRBc7ok/bMIaA5fKXuu2BVPRuF77XD2NbCGzvinoWBCR9BOVWWKvw62Pg7vfxMuHgD3Q6K/d/ng8hFJyZx9HepyXvu1zYvijXOzaMBXSp45dfZTZNLwzn+Dnn1SHFPRQGSkZs7zquVxmVPXCut3i5fOxUNSRLX+IbkD8Afg8lG49H7O/z4D9/xD2ZgtIhrwlZJmzvaEM4P+6R/Bye+LF7q7AlbfSXAkS3gyf8u5ZjVIU0A2bCcGxWzt0vuitmnaLoE9sF6alw9dgBN7xDf/oX8CFYHrnzebXZTKW3XLVEqa3c++klc+GfC7qfS6ZNVf46a99qeExr8ubzbtgI0fosvxKB0/GprVf1Ztj5WriEXFa2liQDz1m3ZKwE+OQyYD3T+Xx9glMUbb9oRMCnUbZBM4mxZ75HRCPpOckPOuvu2WhqNumUrZUmhTNRpLEY2lAAiPpugYbQP/cUJNl2DN7dDSRmjTLqjp0/6zytz4A1Jh2/uONErpOwoNW0VHb2Kw9TGRYJ76oZiqHfs29KySz1U0SgrIUykpIeOSFJC7alGGqgFfKWmCAf8NFUjF8PAvY79J56UskW4/wfeg/Yk+7T+r3BiBVnFSHb0oK/bB0+J+6asBErKyz2ZEpun05vrXJsVBM5MWy213hRReJXI2yc13L/gwNeArJU3749uvyuHPxSReJpOiygmPJPLn+hUlHy6PBPVUTBqcYGByQFI0Tg9UNkiqcHJAgvuaXRLwjUP8ddIxKdyyAFlweBZlmKrDV0qamTr763O1BHPKU0dRboiKelnpZ63o6Bu3yYo9k5Aetf0noGG75OuHzsixvlrx0ll1G6x7QAqvmrZD/eI4seoKXyl5ptIyG5/+LjcrUdDCKuWmCLTKputoWFI3dRvENyeVgIk+GO0Rlc7FQ5Acg+b7ZNU/cEImicpVUnjlWpymOhrwlbLhRvP5MwlUuBdpNEpJ4nBKkE8npGWh0w2VqyE2CJ4NYrOQzUAWiJ6D4bOi6rFpUftkklCzFqqDizO8RTmroixDxDfn5v7Jj8fTapCm3BzeKqgJSqomOS4r+cB6Cf6eCrFfaNgkqZtsVlI+/jpofUg+N9EP/cdvzo7hBtGAr5QNobuDPNOWoNk5gsHi4Pr/oVJZq3l85eapXiP5eYdLPHUm+iWn76+TTdp4dPrYTEpW/oOnJedft2HRWh5qSkcpH/pOEBr/GqGqt8DpYePQn97QxzSPr9w0xkDdeuiPgbUivxzpFSVPxbCoevqPQ/SCdM3a+CHAQDTXMrGycVGqbRfkbMaYJ4wxJ4wxp40xT+d532uM+Ubu/beMMRsW4rqKcsMkJ+Dw30P4IGChfqP0JL0B1CBNuSVcXmlQjpXuVolRGOkRNc+au6T9Yf1GaZF4ck/ORtlI8/NLhxdlhT/vMxpjnMBfAr8I3Ab8hjHm2prg/wMYttZuAf4M+Pfzva6i3DDZLJz4gfiZpCZk9dS4hfZdFrdzbjdMNUhT5kVlg6R20nHw1sDkoBRnORxQ2wJ3/CpseUyKtUZ6JYe/7j5ofXBRhrMQU8j9wGlr7VlrbRL4OvDkNcc8CXwl9/M3gY8as8Tde5XyZeAUHP6GSOJcOX104xZCjz1K56/cRd0MJY7f7aCuwi3e+AG/+uYo82dqwzYdl+A/fkmCPkjgX9cGa+6QO4DB05LTr2hYlKEsRA6/GZjZj6sXeKDQMdbatDFmBGgABq49mTHmKeApgNbW1gUYnlLWJCfg0Neh9wBTqRzqN8Pmj0JFPaFdWkmrLDJTUs2BU6K1r2iQoI+VFb2vVqpwMylIjMNIt6h76jcvzxz+QmKtfc5a22atbWtqair2cJSVjLVw+tXpVE5Fk5hYtd5PV6SO3c++wsanv8vuZ19R6aWyuHgqoaZZtPkun5imjV+WNI61kt6paRarBRxStLVMVTphYN2M5y251/Id02uMcQG1wOACXFtRCjN8AQ4+L/+pXD5o3A6rb6NrfCcd3zlyfY98RVlIqppk5T4aljSPcUj1bTohdwB160Wzn5oU2+RFYCGmkHeArcaYjcYYD/DrwEvXHPMS8Nu5n38FeMUuZyN+ZeWTisPBr0HPu4CV7kSrdsLmj9D5Ss8sMzX1zVGWhMB68FSL/NJbDbWt0vd24CR4qmSVn4rBSGR5Fl5Za9PA54E9wDHg7621R4wxf2KM+XTusL8BGowxp4H/C5gl3VSUBeXs63D0JUiPz5DBfRAathbU1aveXll0HA7ZR3L5RI7p9kHDZlHpDJyUyaCyUSpyl2lKB2vty8DL17z2r2f8HAc+txDXUpTrEu2Fff89p8rx0uX+JJ0HHyTyZoJg4DUCFW6GJ1OzPqZ6e2VJcDglyA+cgqGz0iylcbs0Rxm/KKkem12+hVeKsmxIJ+Ddv4Pw25C1dLkepyP8EOFJJxbJ14/H07P096q3V5YUp1uCPkaskgEat4pbJounWNeAr5QWZ38KR7tEjllRR+fox4hlr/5nnspaKj0umgN+1dsrxcPlzaVzMhL0sxmobZaUj7d6+aZ0FGUp6ToQzt9ndugC7P8KjPaKI+Hau4j0efOeYySW4uAXH1vikSvKNbj9UL9JAv7gaZkA/AF5LAK6wldWFF0HwnS8eJhwNHYlRfOFbxxkw9PfZfd/epeu02npOFS7Hjb9AsGa/H72mq9Xlg3eKqjbKDbJA6ckLblI6ApfWVF07jkxS1I5pe8Nxz108Gvs827m1Yv3EjnvI1BhcDsMqey0Cljz9cqyw1cjTppDZyXoN2yW1f8Coyt8ZUVxPelkDC/PJz5IOOHDgqhxDAT86o+jLHM8laLYMUbSO4ugw9cVvrKiuJE2hfYalUMqY6n0ujRnryx/3D4J+unY8rRHVpSlRNoUOm/6c1pUpawYXB4xVFuMUy/KWRVlkZhKxXTuOUE4GsNgr1rRG6Zz+jPRTVpF0RW+sgIJ7WrmjX/xYc7/0kl+y/0GTjKAxWksH1xfOesOQDdpFUXQFb6y7Mmru685TdfPj/FC6gkySIDPWHg3EuOz97bw6vH+2Tp9RSlzNOAry5op3f3VVsaHIPgmnUMPE+PqwqpYKsvX3urhP/7qXRrkFeUaNOAry5p8uvtYKktnzzYiti7vZzLWqr+9ouRBc/jKsqXrQLigBDOSrSPoGC74WfW3V5TZ6ApfKSrX5uc/sqOJV4/35xQ4hQmaIdpbT9PR+yCxdP5eOirFVJSr0YCvFI18+fm/29t95f1CLdH8JGhveJPQRz8HI1v4gxeOkMnTQE2lmIpyNRrwlaKRLz9/fSzPVL1A6KEHoeVeQlsD4HRdNXGASjEVJR8a8JWicSspl2YzRGhnNdz25BUL2ZnFWCrFVJTCaMBXisaN+OLMRFI5e+G+34HAuqveC+1q1gCvKNehNFU6mfSiOM0pC8uN+OIYLGBpNgOSynmkDZrbxFFQUZSbovRW+NkMnPsJ1K6DJs3hLmfypWKmVDqRaIxgtZN2z7cIJb4DTg/s/BTc9avgLL1/toqyFJTe/5xMCqJhaSTgroRAS7FHpMxBwVRMMgYvPgVnfwIYmbwf/ufSHUhRlFui9FI6bh+sfwjSKTj/OoxeLPaIlJuk60CY3f/v99l48NfYPfYluhwfhQf/ETRuLvbQFGVFM6+Ab4ypN8b80BhzKvdn3lp3Y0zGGHMw93hpPte8Ieo3Qcu9kBiFiwch2rPol1QWhq4DYTq+eZBw3IPFELaNdIz/Cl2J+4o9NEVZ8cx3hf808GNr7Vbgx7nn+YhZa+/OPT49z2ten2wamnZA3QaIRSHaDcMXIE9xjrK86PzeUWLXSPNjWSedPzxVnAEpSgkx34D/JPCV3M9fAULzPN/8yaRh4CTEhqFpJ7h8EB+BiQEJ/Br0ly/ZLJHRRN63bka+qShKfuYb8Fdba6eS5JeA1QWO8xlj9hlj9hpjQnOd0BjzVO7Yff39/Tc/IqcLqtdAPCrP69ZLf8hMEmJDMHxeg/5yZe9/JWAmC77ddSC8hINRlNLjugHfGPMjY8z7eR5PzjzOWiuC6fyst9a2Ab8J/LkxpuDum7X2OWttm7W2ramp6Wa+yzRVq6CyCWKD4G8AXx3Eh8FdIRPB4BmRbyrLhzOvw7tfwdrC9RPqfqko8+O6skxr7ccKvWeMuWyMWWutvWiMWQv0FThHOPfnWWPMT4BdwJlbG/INUtsiEs34kKz4B0/DRD/Ub4bxy/K8fhM43Ys6DOUGiPbCT56BsUuMUFh2qe6XijI/5pvSeQn47dzPvw18+9oDjDF1xhhv7udGYDdwdJ7XvTEC68FTBZkEVK2G8T7J7ddvhHQcBk7JpKAUj1QCfvQnMHACMAQd0YKHqvulosyP+Qb8Z4GPG2NOAR/LPccY02aM+evcMTuBfcaY94BXgWettUsT8B0OqNsoG7fGAb6A5PCTk7LSz6ZkpZ9JL8lwlGvIZuFnfwbdb0qKze2nfXMP7jz/Kt1Oo+6XijJP5lVpa60dBD6a5/V9wO/lfn4TuGM+15kXTpekbgZOyuZtKguDpyC4S4L+0BkJ+g1btGR/qTn6bTjSBckJcHlh9U5Cj30aIgH++KUjRGNy91VX4eaLn7pdzdEUZZ6UR4RzeWWln01DYgImh2TjdvUH5PWhs7mgv1lz+ktF70F46zkYHwDjko32u34DVt9OaLX2olWUxaD0rBUK4a2SQix/AGwWRiMw0g2+GrkDyCQkp5/OrwNXFpCRi/CzP4Wh0/LcVw1bPgo7PlnccSlKiVM+AR/AXyepG281JMZhNAzj/RL0G7bIHcDAKUipGmTRiI/Cm38BkXelHsLjh+DdcO8/BE9FsUenKCVNaQb8/hNSVZsYn/1eVROs2impm5GwHJecAE8lNG6VYwZOyWvKwpKKw9vPwdlXRZ3j8EDDBrj7tyS1pijKolJ6AT+bFVVObFg2Zy8fhbFLkE5OH1PbIna71sJoryh3cioRGreBwyU5/XwThnJrZDPw3tfgxMvib+R0SnHcbb8s7qba0ERRFp3S27R1OMROIbtO/HMm+mUVPxIGXy1U1Is8s2kHTA5KsB+7JMG+fhO4PLLSHzwtCp66jZLyUW4da+Hod+h64xCdl3+XSDZA0DlC+6oBQtt/UVM5irJElF7AB4gcArJc5fQQH85ZKqTkDqCiUZQhoxFx0vRUSsOU6tWS7mnYKgF/6Oz0Zq9ya5x5la6fvkXHxUeI4QEgnAnQcbIOTmcI3VPk8SlKmVB6AT+bEQ8dbxXUtkrBVWxYXvdnIDYCE5clkININmPDstqf6Ie1d0FNs2jyG7bIJDF8Hlgvm77KzdHzDhx8ns7Io1eC/RSxtKXzBycJ3aNdyRRlKSi9gG8ckp8fvSRpGZcXHM6cQmezWC0YhyhxBk7B0CmIj8FIRBw1k5OS2qlqgooG+czQ2WmXzYr6Yn/DFUHXgTCdLx8mMpYm6Poo4Uz+tFg4GqPrQFh194qyBJRgwDeSsskmRXbprYbmNgngM3H7oPV+WHunqHpOfE9W/tm0FAJN3Rm4fJL6MQ6IXpA7hWvPpVxF14EwHS+8RyxtAUM4XYvBFrRS7XjxMKDFVoqy2JSgSicjgd5fB5sflU3X0bBU1+bD7YPgXXD/70vlbSYNlw5K/t7plfNFu8VkzeEWVY/2yZ2Tzu8dyQX7aSwGUyDkx1IZtT5WlCWg9Fb4Dqes0D1V8vDXSTomekGqaGvW5v9cZQNs+RhcPCQ9cAfPiMSzaYecM5VrzJFOyEZvNi3yTpUTXk20l8hoEpj9e7F5XptCrY8VZfEpvYCfzYq0cqIfJvpEeeOvAwyMX5I8faA1f6CuaZZ2iG6/BPX4EIz0inLHOEXhYxxSLZqakOeBDSIFVeR3dfB5gu6NhFOVs95urnGDw5W3XaFaHyvK4lN6kcrhkI3W1bdLALdZScMkx6Z/LtTxyumCwDrZmG3cKp2yYoMySfiqZCKwWSArlbh9x8XHXe2VIRqm67v/i92vbCKcqiBf87OP7FhD++Pb8budV73udzvV+lhRloDSC/hTON2y2bpqh1TP+uukgjaThkvvwbnXYXJ49uf8dRLwXV75nNsHw90wGYXKRtHkVzbK+RPjEDkIFw+IbUC5Eu2l6+Xv0PH+WsLJCiSdM/sO6tWTA4R2NfPMZ+6gOeDHAM0BP8985g7dsFWUJaD0Ujr58FTKYyplMxqW1fmZH4snfs1aCfQurxxfu05W8NksNO0UFc9oGBwGqtbAqtthckD2BQbPQs/bUtW74WFRBZUYXQfCdO45QSQaIxjw0/749ukAHe2G975O5/GNxLJz/3OaytOHdjVrgFeUIlAeAX8Kh1NW7xX1ot6JHISxiLQ7dF8El19sFHwByfMPnpafG7dKA5WJAcAxnbuvbIKaFoi8B31HRcu/7TFJC5UIXQfCdLx4mFhKUmDhaGxaRrk+BYe+ASM9hJO3XfdcmqdXlOJSXgF/Jk6P5Pr7j8HYZfFzySRFjWMtuCskX296Yc1t0h83ekE+Z61U7NasBawUerm9UlW6/yuw8UOy2nc4rzuM5U7nnhNXgv0UsVSGzu+9T+ihAzDcTdflRgz5svbTaJ5eUYpP+QX8xJgoeOIj8txbI1a9NisVtt4qUeFMDoir49BZGD4r+fz4pGz4+hvkTmD4vNwJuP2S19/4MJx/A458GyIHYPsnoXHLipZuFpJLRkZT8ntJJens3TGn5LL52jSQoihFoTQDft8xsU5ITsjDWknbTA6Kft7pAX+t5Nudfsnvj12E8H4xVfPXgqdaJgNvrWzyXvi5rNgnBmA0QlfifjpPVBOZuESw1kv7x7cQur1VUj0X3oDed2DfX0uVb+uDKzbNEwz488soPTFIxmD4HJHMrxT8/PlntYuVoiwXSi/gZ7OiB8+muKIUiY9CahxsRlQ3FhjrF/VNJi7KHQukJ0VnX7kaaoOi6knHxV8nMQIVTVC/ma4TMTrO1BDL5TDCIwk6vnUERmsJ7aiEpm0ymXT/HE79AC6+D6u2wboHoX7jitHtdx0IM5GYLTn1O9K0r31P7naS4wRdY4TTs71ymjVnryjLitIL+A6HWCS4vGKHMJV3dzZLXj6TkIfNMi0ftFJBm5yE0R5J+4xEJL2TSUk6p+k2Oc5XQ+cr48Ts1b+6WAY6Xx8g1BIX07VAqxR9db8lqY/T3bLqr22B1XdATRC8lTKpOL2SFnL7l00T9Ws3awVLnTPJF1v2E0r/GLJxqG2lvTlBx3uWWGY6raM5e0VZfpRewAfR3/cdyzXJdkL1Gnk9HQeXWwKrt1qsF9w+MUhzuCXXns3A5WPQu1fSPNVrJAhncjlrp5dIbEvey0ZiLnj3K3L92maxZ97wEKzaLnYNY32i/e/+uQT+2nVQEZAJaQqnZ9oWwlMpE1cR9gDybdaCocKRlmBPGuo2wYYPEWpshFoPnfsNkdHkbOmmoijLgnkFfGPM54A/BnYC91tr9xU47gngLwAn8NfW2mfnc905SSfh9I8gMSqBt3KVqG+MkSYmFQ3S+aqQgsbpgpo1sqqvWi25/ExSrBT8dZCKE6zIEJ6c/flghRX3zan9g+gFuWvwVojDpssFGMhaSTnFBkTd46mBijqxb0iOy9hjU2ZvOfdPt0/uGDwVcqeyyJNAwc3aVIXUIzTcJuqlhs3gqyb0wCZCj6/MfQpFKRfmu8J/H/gM8FeFDjDGOIG/BD4O9ALvGGNestYenee18+N0i2ImsEGyNZmEBPqq1bJivh6TQ2K/EFgH2Wa4eBAwELxX8vs9e2nfEqHjSDOxzHQu3u/M0r4rC9s/IZ49sVFIx+SuIpUALDi8cu6p/rmuSpgYlIrdWJ3cTVSvBc9GmTRSU5+P5Y7JVQYbh9wBXLlL8S/sBDDcXXhSc45KyqxuAzRul4mqfpPc0SiKsqyZV8C31h4DMHMHm/uB09bas7ljvw48CSxOwLdZKYiKR2Vl3LDlxqtfUzEY6ZEVdDYr/jurPwDjfdD3vqh2gvcQqrkENTE6DzqIjGcJVjlovztLqOYUnAuLw2ZVo6SBEmOyWnf7ZXXu8sJIt6SLhs9Laqd+Ezg8ED8hNQGVjfIdHK7pKmGTm1wyabnbSIxJ9S/InYGnUsbt9kkB2c2kgtJJmZxGwnDpEPSfoL0pRUf3fVftVfhNivYNZ2UyXH273LU0bJ5OmSmKsqxZihx+M9Az43kv8MCiXc04RHpZvVZW9Tca9LJZCcCZNJCQVbjTJXcI3tydgTG5xikfJFR1mtCulEwC45ckDROtlYlh8LQoeiobJShWrobJftH1Oz1Qu16C88Ap6H5HCrYqG6A6KBvFvmqp8K1aJWkkc42qx+GWycyb8+vPpuQOID56tYWNcVx5dJ2I0fmzQSKjaYI1LtofbiS0o0ImufgIjF+WSWj0Ekz0E2pyA+/QGb6dSLqaoHuS9g1nCbWmYc2d4iDauFW+o6IoK4LrBnxjzI+AfEu4P7TWfnuhB2SMeQp4CqC1tfVWTiCB6GYZ6ZGAbBySRnG6JXj66yXwuv2iwR/phdRZcFfByPGcffJaCeB162W123dUAnA6JpW7gVXQ+oDYNU8MiQMnGVh9m6SbhrthvF82dKeu5a0RQzZ3NdS1TiuGMklRFKUTuargmRurWendjpWHcYLD8Eev9PP8oYkrlbDh0TQdP7gE44ZQy7iksRITMr74iNQtJKOEfL2EthwWiarTK3cdq+4QBVLDFm3srigrjOsGfGvtx+Z5jTAwczevJfdaoes9BzwH0NbWNle1/sIxOST+97GoPK+sl43d2par8/6eKgnsl4/IqtpXK6kTlxea7xVJaGJcNnwvHhSdemJcgvzYJam6deS8eFw+2VBubpMgPnAKLh2B5GjO1TMuhWA9b4vpW/MuWPMBCbqVTdObzpm03IVMTQKZZG5iSEAmRdfxsauC/RSxNHS+kyJUP5RLPY3IXUpiTO6QUnG5M6kIyCZz1SpYc4dMPg1bJD2lKMqKYilSOu8AW40xG5FA/+vAby7BdW+MTEoknIOnRJFTv1FWsBUN0+mg+IiswJNjgJHAm5zIee04JciOdMtGprdKZJi1zdI969JBiIah7wj0viVOm60Pygp+sl+Cq69G0jmN26RKd+wSeBtkNR0bEnnp+9+Uvrv1m6WwqyYo57hWt28zMm6HG6yl883Rgh43kZhLNpKjPaIoSsWleYzTK5ORkZ601KyClgcg0CKeQi5PgTMqirKcma8s85eB/ww0Ad81xhy01j5ujAki8stPWGvTxpjPA3sQWeaXrbVH5j3yhaJ3P/S8Javo4C4J9k4XZHK9cUd6cs1TbE4bXz1tsBYbkruD5KTk5kfDor13V0hapuU+2UDNviFB2GbFajk2LPLNuk2AldW1nZR00K7/TVb23T+Hy4fktdbdQBaGLkhgjl6QCam2WSYKT6XUFzi9uSIzj9wBuKqIjGULfvWgNw6n9kjqyV2ZqwnwQjolE4enUiaY4D2SrqpataJ9gRSl3DHWLk3W5FZoa2uz+/bllfbPn0xKDM7O/lRWyzt+SdIUE/0wfCHXtzYlAbuiIaej98qKfmozFEQ3P9Irq+RMYrpBSnJSNkGdHplMHC5ZuQ+fk70Am4LKNdCwUQqwXD45l83KxGKzcOn9nEFZQs7jraYrUkvn+xVEYi6C3gTtWy8T2uGTa0ylmDCy8rdZdv9NL+E8Qd9g+bO1PybUkNuDwAHxYZnIKhrAXwOr74Q1t4sq50YkrYqiFB1jzH5rbVve98ou4FsrJmqDZ6Bnr7Qx3PaErOKHz8uK3eWWlEagVf68XgojmxWlzsX3JGj7G2UlbIyobKY2VhMTOUnlpEwsU31xXX5R5tSuF69+KSDIbZ5OyjHJcbqOT9Kxr+Jq/b8jwzObjxJaMyAbzJ4q8PhlQktO0tXjp+PoOmLZaU29wfJBf5jzmToiyQqC7gnam94htHZoukK4YZPc8VTUL+zvX1GURUUD/hSpmKzEEyOyek5NyCo2m5I8vadSVtt1G25tUzIxASe/L7LMmmbY/OGcNNQhm6GJUdnAHb8odQKJnJOnyyObr/FhuYPwVuWCd05/nxiFbJbd36kkPD77ss2+BG/c8xNR+UyZwTkcYFzg8tE1uI7OyB1E0pUEXWN8pOI8L4zddpXG3mD5rY0TfOkXqsTfv36zpm8UZQUyV8AvTS+da7FWiqfGLkr+PdojaZWaZgmQLp9oy2uCt64+sVY89Bs2SfonPiqTSnW/bK5WNMhkUrsOklskvTN4alod5KmUdoo45DyjEcgmRWHpcEEmRWR8B/l6xUbiHvm80ylFVKmcYic5DrEhQs4LhNb//IpFw+4TvzbL/M1ieP5cFW337CS0Y9Ot/Q4URVnWlH7ATyek7+r4ZVGhJCekuMhbK8HZF5A0xnx60Vor14gNST48uEsC9khPrrm5kVW6wyXXq6gXiWbjFhi9KOmlgZOi3/dUyuZo3QY591RVbTZFsCJb2MOn5UG5U0nlCrCS4zkzOCS9Y5A7HOMg8n7+Sc0CnT8+T+g+DfiKUoqUbsDPZqWQaPic+NV4q3N686is4hu2QMNWCb7zSV1cG+ynbAZqcsVKo72AkRRNNpVT9gyIbNJTKeMK3i0a97GISETHL8tk4arI1QSI/LL9gQwdryeJzbCo9zuytG/uhb5ByBpwZHOpHL/IKpMJsGlR4TRugdoWgvtjhMdm+9xDYdM0RVFWPqWZw4+PyKp5NAyYXNXqhKRObFoaj69/WDZn58tIWCaWmcF+Jqm4bAanY5LWqVydW7WPSlFWNjV9rHHIRJCckE3gsT4pxEonRWZps3SFa+g8uZpI3C0qndZThBp7pjt3+XKNSBLjovH318r3rWrK6fZddJ2Y5At7onn1+U5jyFqrFseKskIpr03bdBLOvCJpkCnfe5uWYF+5SrxwalvFC2a+TA6JJr6ySapyC5HNyv7BRL8E7uq104Vd6YRYOWRS8nM2lfPHScsjMSabsckxOc9U4xZvzizNU5mbJMblDmF8ALIJSR/VNMumsa9G6gdcHsnj++v4o+8c5/m93ddtPP7MZ+7QoK8oK4jy2rR1OAGHrGz99RL4kuOw5i6udLaqbJr/dRLjksrx1khgnXNMDtknqKiXO4KRHgn+VatFtunyXv962azcJSQnZILIpkWNk47LpJCKyf5AYL3ISWuChT3/gS+F7qBtfT2de04QicZwGEPmmsk/lsrQueeEBnxFKRFKM+DXb5A8vadqegVetQqGzkh6Y749ZdNJ2RtweWVz9Ub3ANx+yaPHhsUGOXpB8vUVDdP2xoXO5XBMWyWn4pK2ykRzFbEVkk6qaLgpQ7PQruYrwXzj09/Ne4zm9BWldCi9gA/iNZNJi/LFOMVvPtotq/2KhvmdO5uVYG8t1G2ccxVdEH+dPKYC/xVfe0fOyz7nZ2PMdGonk5Z0TyY1XcjlrhRrhYr6effCDQb8hPME96A2IleUkqE0A761OW/7pFglZ1KySVq9dv6r+5Ee0fLXb5L9gPkwFfgzUkkr6ZpcM/XMVHcrZ67R+ZQHfnXuz5oFNTFrf3z7rKbl2ohcUUqL0gz4oxHZ5AyslxTI0DkJnPPN3U8MTMsvfbULM1aQYD4V/KeYyqcvUbXrVGpnKqevKh1FKT1KL+Bn0pIqqWySVEcqLjYGVatvLf0yRXJCTNK8NUvT0q8ItgYzc/qKopQepRfwnS7xgnHkvtpEn+TGK1fd+jmzGXHQdLqnK2AVRVFWGPNMaC9TnG5ZIWdSopX318tEcKuM9Ir1cWD9/O4SFEVRikhpBvwpJgaAXHu+W2VySPL2VWvExVJRFGWFUroBP5sVz5orTUFugXRSVvfuyqXJ2yuKoiwipRvwY8OiX5+PMifaDVhp76fe8IqirHBKN+BP9Enl6q3aHk81La9pufU7BEVRlGVEaQb8+Kh4zNzq6j4VFyMybw1UzrMyV1EUZZlQmgF/ol8cJGcWMt0oU/72xiEmZIqiKCVC6QX8bGZ6dX8reffxPvGrr22Ztz+NoijKcqL0Cq8cTlh127Q1wc2QTkjjEV/trd0dKIqiLGNKL+CDrOxvZXU/kmtHWLtuwYekKIpSbOaV0jHGfM4Yc8QYkzXG5O2wkjvuvDHmsDHmoDHmFnoWLgGTQ+KoWRPUVI6iKCXJfFf47wOfAf7qBo79iLV2YJ7XWxwyafGkd1fO3y9fURRlmTKvgG+tPQZgVnpR0lhENnvrW7TASlGUkmWpVDoW+IExZr8x5qm5DjTGPGWM2WeM2dff37/4I0uMw+SgqHo8FYt/PUVRlCJx3RW+MeZHQD4jmT+01n77Bq/zsLU2bIxZBfzQGHPcWvtavgOttc8BzwG0tbXdgtTmJrBWOlg5PdLURFEUpYS5bsC31n5svhex1oZzf/YZY74F3A/kDfhLynifaPbrN82/9aGiKMoyZ9GjnDGm0hhTPfUz8Biy2VtcrmjuAwvbrlBRFGWZMl9Z5i8bY3qBh4DvGmP25F4PGmNezh22GviZMeY94G3gu9ba78/nugvCFc19S7FHoiiKsiTMV6XzLeBbeV6PAJ/I/XwWuGs+11lwrmju1T5BUZTyofwS1zM191Xz8MpXFEVZYZRfwB/tFc19QO0TFEUpL8or4MdHpRNW1Wpw+4s9GkVRlCWlfAJ+Niuae5dP+9MqilKWlE/AH7sImaQ4Yap9gqIoZUh5BPzkhPS4rWgEb1WxR6MoilIUSj/gWwvRHml5WBMs9mgURVGKRukH/PE+SMekwMrhLPZoFEVRikZpB/xUXHL3vlrwB4o9GkVRlKJSugHfWoh2y6peWxYqiqKUcMAfvwypCUnlqH2CoihKiQb8VAzGck6Y/rpij0ZRFGVZUHoB31oYvgAOl6ZyFEVRZjDfJubLD2vFNsFXC87S+3qKoii3SulFRIcD6tYXexSKoijLjtJL6SiKoih50YCvKIpSJmjAVxRFKRM04CuKopQJGvAVRVHKBA34iqIoZYIGfEVRlDJBA76iKEqZYKy1xR5DQYwx/cCFBThVIzCwAOdZLuj3Wd6U2veB0vtOpfx91ltrm/IdtKwD/kJhjNlnrW0r9jgWCv0+y5tS+z5Qet+pXL+PpnQURVHKBA34iqIoZUK5BPznij2ABUa/z/Km1L4PlN53KsvvUxY5fEVRFKV8VviKoihljwZ8RVGUMqEsAr4x5t8aYw4ZYw4aY35gjAkWe0zzxRjTaYw5nvte3zLGBIo9pvlgjPmcMeaIMSZrjFmxcjljzBPGmBPGmNPGmKeLPZ75Yoz5sjGmzxjzfrHHMl+MMeuMMa8aY47m/q39s2KPab4YY3zGmLeNMe/lvtO/mfP4csjhG2NqrLWjuZ//KXCbtfYfF3lY88IY8xjwirU2bYz59wDW2v+nyMO6ZYwxO4Es8FfA/22t3VfkId00xhgncBL4ONALvAP8hrX2aFEHNg+MMY8A48BXrbUfKPZ45oMxZi2w1lr7rjGmGtgPhFb4348BKq2148YYN/Az4J9Za/fmO74sVvhTwT5HJbDiZzlr7Q+stenc071ASzHHM1+stcestSeKPY55cj9w2lp71lqbBL4OPFnkMc0La+1rwFCxx7EQWGsvWmvfzf08BhwDmos7qvlhhfHcU3fuUTC+lUXABzDG/DtjTA/wW8C/LvZ4FpjfBb5X7EEoNAM9M573ssIDSqlijNkA7ALeKvJQ5o0xxmmMOQj0AT+01hb8TiUT8I0xPzLGvJ/n8SSAtfYPrbXrgOeBzxd3tDfG9b5T7pg/BNLI91rW3Mj3UZTFxhhTBbwA/PNr7v5XJNbajLX2buQu/35jTMHUm2vJRrXIWGs/doOHPg+8DHxxEYezIFzvOxljfgf4JeCjdgVsxtzE39FKJQysm/G8JfeaskzI5blfAJ631r5Y7PEsJNbaqDHmVeAJIO8me8ms8OfCGLN1xtMngePFGstCYYx5AvgXwKettZPFHo8CyCbtVmPMRmOMB/h14KUij0nJkdvg/BvgmLX2T4s9noXAGNM0pdAzxvgRwUDB+FYuKp0XgO2ICuQC8I+ttSt65WWMOQ14gcHcS3tXsvLIGPPLwH8GmoAocNBa+3hRB3ULGGM+Afw54AS+bK39d8Ud0fwwxnwN+DBiv3sZ+KK19m+KOqhbxBjzMPA6cBiJBQD/0lr7cvFGNT+MMXcCX0H+vTmAv7fW/knB48sh4CuKoihlktJRFEVRNOAriqKUDRrwFUVRygQN+IqiKGWCBnxFUZQyQQO+oihKmaABX1EUpUz4/wGxP7rQCUcLgwAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eda66e85",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a89b70d8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:42.251489Z",
     "iopub.status.busy": "2022-04-25T14:12:42.251285Z",
     "iopub.status.idle": "2022-04-25T14:12:42.267041Z",
     "shell.execute_reply": "2022-04-25T14:12:42.266445Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7bf929a7",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b906b89e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:42.269447Z",
     "iopub.status.busy": "2022-04-25T14:12:42.269258Z",
     "iopub.status.idle": "2022-04-25T14:12:42.272527Z",
     "shell.execute_reply": "2022-04-25T14:12:42.272058Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "13daef78",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:42.274524Z",
     "iopub.status.busy": "2022-04-25T14:12:42.274349Z",
     "iopub.status.idle": "2022-04-25T14:12:48.040159Z",
     "shell.execute_reply": "2022-04-25T14:12:48.039532Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-25 14:12:42.278936: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb699dca",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bab736ba",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f9f8dbf1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:48.042930Z",
     "iopub.status.busy": "2022-04-25T14:12:48.042696Z",
     "iopub.status.idle": "2022-04-25T14:12:48.047915Z",
     "shell.execute_reply": "2022-04-25T14:12:48.047406Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b75825d",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "42e3392d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:48.050208Z",
     "iopub.status.busy": "2022-04-25T14:12:48.050010Z",
     "iopub.status.idle": "2022-04-25T14:12:49.982893Z",
     "shell.execute_reply": "2022-04-25T14:12:49.982261Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb80a2f0",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce0a495e",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "79bc2d15",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:49.985612Z",
     "iopub.status.busy": "2022-04-25T14:12:49.985408Z",
     "iopub.status.idle": "2022-04-25T14:12:50.001151Z",
     "shell.execute_reply": "2022-04-25T14:12:50.000631Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "faae70d0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-25T14:12:50.003589Z",
     "iopub.status.busy": "2022-04-25T14:12:50.003402Z",
     "iopub.status.idle": "2022-04-25T14:12:51.761894Z",
     "shell.execute_reply": "2022-04-25T14:12:51.761357Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cff6bab3",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
