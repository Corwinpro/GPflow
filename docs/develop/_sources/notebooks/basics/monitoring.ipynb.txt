{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5da0aab7",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7ec4c0bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:44.064129Z",
     "iopub.status.busy": "2022-03-29T10:59:44.063916Z",
     "iopub.status.idle": "2022-03-29T10:59:46.951704Z",
     "shell.execute_reply": "2022-03-29T10:59:46.951222Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:59:44.965291: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-29 10:59:44.965319: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "642a4628",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fb52baec",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:46.954488Z",
     "iopub.status.busy": "2022-03-29T10:59:46.954283Z",
     "iopub.status.idle": "2022-03-29T10:59:46.956768Z",
     "shell.execute_reply": "2022-03-29T10:59:46.956371Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d96317a",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6beeb8a9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:46.958844Z",
     "iopub.status.busy": "2022-03-29T10:59:46.958662Z",
     "iopub.status.idle": "2022-03-29T10:59:46.961055Z",
     "shell.execute_reply": "2022-03-29T10:59:46.960694Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "7f923332",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:46.962917Z",
     "iopub.status.busy": "2022-03-29T10:59:46.962742Z",
     "iopub.status.idle": "2022-03-29T10:59:47.049260Z",
     "shell.execute_reply": "2022-03-29T10:59:47.048844Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f7e2ef98df0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f53f0635",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:47.051492Z",
     "iopub.status.busy": "2022-03-29T10:59:47.051291Z",
     "iopub.status.idle": "2022-03-29T10:59:47.097295Z",
     "shell.execute_reply": "2022-03-29T10:59:47.096878Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:59:47.053255: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-29 10:59:47.053280: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-29 10:59:47.053299: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (f9996eea8daa): /proc/driver/nvidia/version does not exist\n",
      "2022-03-29 10:59:47.053547: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f7e2efec8b0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f7e2efec8b0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b5a31187",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:47.099557Z",
     "iopub.status.busy": "2022-03-29T10:59:47.099363Z",
     "iopub.status.idle": "2022-03-29T10:59:47.226754Z",
     "shell.execute_reply": "2022-03-29T10:59:47.226324Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "559764fd",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ac525f6f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:47.229132Z",
     "iopub.status.busy": "2022-03-29T10:59:47.228933Z",
     "iopub.status.idle": "2022-03-29T10:59:47.367580Z",
     "shell.execute_reply": "2022-03-29T10:59:47.367104Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c066e503",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "8791bc6b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:47.370238Z",
     "iopub.status.busy": "2022-03-29T10:59:47.370039Z",
     "iopub.status.idle": "2022-03-29T10:59:47.373106Z",
     "shell.execute_reply": "2022-03-29T10:59:47.372641Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8c0d3ad1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:47.375500Z",
     "iopub.status.busy": "2022-03-29T10:59:47.375325Z",
     "iopub.status.idle": "2022-03-29T10:59:53.354161Z",
     "shell.execute_reply": "2022-03-29T10:59:53.353670Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:59:47.379651: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "919c64df",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d074971f",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "25665b51",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:53.356848Z",
     "iopub.status.busy": "2022-03-29T10:59:53.356636Z",
     "iopub.status.idle": "2022-03-29T10:59:53.361246Z",
     "shell.execute_reply": "2022-03-29T10:59:53.360829Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "07de41dc",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "a26285bf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:53.363261Z",
     "iopub.status.busy": "2022-03-29T10:59:53.363082Z",
     "iopub.status.idle": "2022-03-29T10:59:55.068777Z",
     "shell.execute_reply": "2022-03-29T10:59:55.068242Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "567c7daa",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ba36e5c8",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2a032104",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:55.071494Z",
     "iopub.status.busy": "2022-03-29T10:59:55.071275Z",
     "iopub.status.idle": "2022-03-29T10:59:55.087934Z",
     "shell.execute_reply": "2022-03-29T10:59:55.087473Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "da2266ca",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:59:55.090092Z",
     "iopub.status.busy": "2022-03-29T10:59:55.089878Z",
     "iopub.status.idle": "2022-03-29T10:59:57.097822Z",
     "shell.execute_reply": "2022-03-29T10:59:57.097284Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9740b06",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
