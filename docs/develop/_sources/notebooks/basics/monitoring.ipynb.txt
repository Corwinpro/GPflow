{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7a73d344",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5715acce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:10.303032Z",
     "iopub.status.busy": "2022-04-07T10:01:10.302813Z",
     "iopub.status.idle": "2022-04-07T10:01:13.266882Z",
     "shell.execute_reply": "2022-04-07T10:01:13.266406Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 10:01:11.283014: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-07 10:01:11.283042: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2c310b47",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "193b2c87",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.269680Z",
     "iopub.status.busy": "2022-04-07T10:01:13.269481Z",
     "iopub.status.idle": "2022-04-07T10:01:13.272016Z",
     "shell.execute_reply": "2022-04-07T10:01:13.271634Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d727ea3",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6eff74b6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.273931Z",
     "iopub.status.busy": "2022-04-07T10:01:13.273769Z",
     "iopub.status.idle": "2022-04-07T10:01:13.276150Z",
     "shell.execute_reply": "2022-04-07T10:01:13.275782Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f29e4a72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.277914Z",
     "iopub.status.busy": "2022-04-07T10:01:13.277739Z",
     "iopub.status.idle": "2022-04-07T10:01:13.386377Z",
     "shell.execute_reply": "2022-04-07T10:01:13.385958Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f23d376c1f0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0b5e671a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.388690Z",
     "iopub.status.busy": "2022-04-07T10:01:13.388492Z",
     "iopub.status.idle": "2022-04-07T10:01:13.434602Z",
     "shell.execute_reply": "2022-04-07T10:01:13.434179Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 10:01:13.390595: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-07 10:01:13.390626: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-07 10:01:13.390646: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (68bf01a75178): /proc/driver/nvidia/version does not exist\n",
      "2022-04-07 10:01:13.390889: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f23d376f9d0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f23d376f9d0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "41e47061",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.437053Z",
     "iopub.status.busy": "2022-04-07T10:01:13.436856Z",
     "iopub.status.idle": "2022-04-07T10:01:13.702481Z",
     "shell.execute_reply": "2022-04-07T10:01:13.702040Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de1d9eae",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "46b3cd35",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.704990Z",
     "iopub.status.busy": "2022-04-07T10:01:13.704774Z",
     "iopub.status.idle": "2022-04-07T10:01:13.719436Z",
     "shell.execute_reply": "2022-04-07T10:01:13.719019Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8b2bc361",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "6b99235a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.721684Z",
     "iopub.status.busy": "2022-04-07T10:01:13.721490Z",
     "iopub.status.idle": "2022-04-07T10:01:13.724515Z",
     "shell.execute_reply": "2022-04-07T10:01:13.724139Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e18836fc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:13.726492Z",
     "iopub.status.busy": "2022-04-07T10:01:13.726322Z",
     "iopub.status.idle": "2022-04-07T10:01:19.273198Z",
     "shell.execute_reply": "2022-04-07T10:01:19.272689Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 10:01:13.730764: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f808ee38",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bc3a8993",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "64feea22",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:19.276069Z",
     "iopub.status.busy": "2022-04-07T10:01:19.275853Z",
     "iopub.status.idle": "2022-04-07T10:01:19.280696Z",
     "shell.execute_reply": "2022-04-07T10:01:19.280272Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c89ea537",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "54f75acf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:19.283121Z",
     "iopub.status.busy": "2022-04-07T10:01:19.282945Z",
     "iopub.status.idle": "2022-04-07T10:01:21.039729Z",
     "shell.execute_reply": "2022-04-07T10:01:21.039210Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7c2a10ee",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "56c88837",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e378abec",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:21.042391Z",
     "iopub.status.busy": "2022-04-07T10:01:21.042182Z",
     "iopub.status.idle": "2022-04-07T10:01:21.057581Z",
     "shell.execute_reply": "2022-04-07T10:01:21.057154Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "60da40ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T10:01:21.059912Z",
     "iopub.status.busy": "2022-04-07T10:01:21.059718Z",
     "iopub.status.idle": "2022-04-07T10:01:22.938223Z",
     "shell.execute_reply": "2022-04-07T10:01:22.937791Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6ddb580e",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
