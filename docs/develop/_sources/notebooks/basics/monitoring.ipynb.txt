{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a69f34ca",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c26a2971",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:25.245186Z",
     "iopub.status.busy": "2022-04-01T13:48:25.244962Z",
     "iopub.status.idle": "2022-04-01T13:48:28.395556Z",
     "shell.execute_reply": "2022-04-01T13:48:28.395078Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 13:48:26.229795: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-01 13:48:26.229823: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "119ffd9a",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b426a3f1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.398812Z",
     "iopub.status.busy": "2022-04-01T13:48:28.398501Z",
     "iopub.status.idle": "2022-04-01T13:48:28.401875Z",
     "shell.execute_reply": "2022-04-01T13:48:28.401248Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b68e135",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ce8749b6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.406044Z",
     "iopub.status.busy": "2022-04-01T13:48:28.405832Z",
     "iopub.status.idle": "2022-04-01T13:48:28.408709Z",
     "shell.execute_reply": "2022-04-01T13:48:28.408178Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "350e723d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.411181Z",
     "iopub.status.busy": "2022-04-01T13:48:28.410991Z",
     "iopub.status.idle": "2022-04-01T13:48:28.506380Z",
     "shell.execute_reply": "2022-04-01T13:48:28.505764Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f0ddc8d92d0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7231b968",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.508618Z",
     "iopub.status.busy": "2022-04-01T13:48:28.508417Z",
     "iopub.status.idle": "2022-04-01T13:48:28.558378Z",
     "shell.execute_reply": "2022-04-01T13:48:28.557819Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 13:48:28.510635: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-01 13:48:28.510669: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-01 13:48:28.510687: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (0e95ed28bc95): /proc/driver/nvidia/version does not exist\n",
      "2022-04-01 13:48:28.510952: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f0ddc921840&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f0ddc921840>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4c963e57",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.560616Z",
     "iopub.status.busy": "2022-04-01T13:48:28.560423Z",
     "iopub.status.idle": "2022-04-01T13:48:28.838464Z",
     "shell.execute_reply": "2022-04-01T13:48:28.837823Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1b9346f6",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "33e174c7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.841134Z",
     "iopub.status.busy": "2022-04-01T13:48:28.840903Z",
     "iopub.status.idle": "2022-04-01T13:48:28.857021Z",
     "shell.execute_reply": "2022-04-01T13:48:28.856517Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2b3ea1fa",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "8aeaf577",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.859730Z",
     "iopub.status.busy": "2022-04-01T13:48:28.859485Z",
     "iopub.status.idle": "2022-04-01T13:48:28.863180Z",
     "shell.execute_reply": "2022-04-01T13:48:28.862636Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "848df8b8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:28.865617Z",
     "iopub.status.busy": "2022-04-01T13:48:28.865407Z",
     "iopub.status.idle": "2022-04-01T13:48:35.256060Z",
     "shell.execute_reply": "2022-04-01T13:48:35.255546Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 13:48:28.870372: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4d33c208",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d4b7c19",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7913fb2a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:35.259921Z",
     "iopub.status.busy": "2022-04-01T13:48:35.259456Z",
     "iopub.status.idle": "2022-04-01T13:48:35.264812Z",
     "shell.execute_reply": "2022-04-01T13:48:35.264248Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3f4951e6",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "5cf11c92",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:35.268014Z",
     "iopub.status.busy": "2022-04-01T13:48:35.267795Z",
     "iopub.status.idle": "2022-04-01T13:48:37.277079Z",
     "shell.execute_reply": "2022-04-01T13:48:37.276537Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "80d18680",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "10ef88c2",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1ddc8274",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:37.279788Z",
     "iopub.status.busy": "2022-04-01T13:48:37.279555Z",
     "iopub.status.idle": "2022-04-01T13:48:37.298425Z",
     "shell.execute_reply": "2022-04-01T13:48:37.297893Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "31e51c2e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T13:48:37.301603Z",
     "iopub.status.busy": "2022-04-01T13:48:37.301343Z",
     "iopub.status.idle": "2022-04-01T13:48:39.468746Z",
     "shell.execute_reply": "2022-04-01T13:48:39.468171Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4437874b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
