{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "4024c242",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "00b59732",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:30.994814Z",
     "iopub.status.busy": "2022-03-25T12:30:30.994510Z",
     "iopub.status.idle": "2022-03-25T12:30:34.890996Z",
     "shell.execute_reply": "2022-03-25T12:30:34.890260Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 12:30:32.102360: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-25 12:30:32.102389: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00d723e5",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1240f0d6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:34.894870Z",
     "iopub.status.busy": "2022-03-25T12:30:34.894503Z",
     "iopub.status.idle": "2022-03-25T12:30:34.897968Z",
     "shell.execute_reply": "2022-03-25T12:30:34.897478Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6655b25c",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0ff9fd06",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:34.901392Z",
     "iopub.status.busy": "2022-03-25T12:30:34.900813Z",
     "iopub.status.idle": "2022-03-25T12:30:34.907351Z",
     "shell.execute_reply": "2022-03-25T12:30:34.906665Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "330f228f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:34.910891Z",
     "iopub.status.busy": "2022-03-25T12:30:34.910584Z",
     "iopub.status.idle": "2022-03-25T12:30:35.058080Z",
     "shell.execute_reply": "2022-03-25T12:30:35.057373Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f5d4d252d40>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7c3030a0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:35.061361Z",
     "iopub.status.busy": "2022-03-25T12:30:35.061002Z",
     "iopub.status.idle": "2022-03-25T12:30:35.148127Z",
     "shell.execute_reply": "2022-03-25T12:30:35.147460Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 12:30:35.064423: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-25 12:30:35.064467: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-25 12:30:35.064495: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (755bcb98b657): /proc/driver/nvidia/version does not exist\n",
      "2022-03-25 12:30:35.064917: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f5d4d0ba3b0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f5d4d0ba3b0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f671f83c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:35.150540Z",
     "iopub.status.busy": "2022-03-25T12:30:35.150261Z",
     "iopub.status.idle": "2022-03-25T12:30:35.305878Z",
     "shell.execute_reply": "2022-03-25T12:30:35.305254Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c3393866",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b506c095",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:35.308600Z",
     "iopub.status.busy": "2022-03-25T12:30:35.308337Z",
     "iopub.status.idle": "2022-03-25T12:30:35.523833Z",
     "shell.execute_reply": "2022-03-25T12:30:35.523121Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4aea07dd",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "5658a3ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:35.527338Z",
     "iopub.status.busy": "2022-03-25T12:30:35.526997Z",
     "iopub.status.idle": "2022-03-25T12:30:35.531715Z",
     "shell.execute_reply": "2022-03-25T12:30:35.531124Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "7eead627",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:35.534287Z",
     "iopub.status.busy": "2022-03-25T12:30:35.534024Z",
     "iopub.status.idle": "2022-03-25T12:30:42.654454Z",
     "shell.execute_reply": "2022-03-25T12:30:42.653874Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 12:30:35.542365: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dec8d933",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca904c93",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "2e3e1595",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:42.659525Z",
     "iopub.status.busy": "2022-03-25T12:30:42.659258Z",
     "iopub.status.idle": "2022-03-25T12:30:42.664383Z",
     "shell.execute_reply": "2022-03-25T12:30:42.663896Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2c9fc3e",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "fac65698",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:42.667622Z",
     "iopub.status.busy": "2022-03-25T12:30:42.667297Z",
     "iopub.status.idle": "2022-03-25T12:30:44.561082Z",
     "shell.execute_reply": "2022-03-25T12:30:44.560475Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4098ae12",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9476d641",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1740da25",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:44.564659Z",
     "iopub.status.busy": "2022-03-25T12:30:44.564338Z",
     "iopub.status.idle": "2022-03-25T12:30:44.588028Z",
     "shell.execute_reply": "2022-03-25T12:30:44.587299Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "4350df81",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T12:30:44.591825Z",
     "iopub.status.busy": "2022-03-25T12:30:44.591515Z",
     "iopub.status.idle": "2022-03-25T12:30:47.015184Z",
     "shell.execute_reply": "2022-03-25T12:30:47.014673Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f7a9675",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
