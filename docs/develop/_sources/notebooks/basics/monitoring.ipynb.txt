{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "6eb9f950",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3c749398",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:09.588452Z",
     "iopub.status.busy": "2022-03-24T13:54:09.588178Z",
     "iopub.status.idle": "2022-03-24T13:54:12.929655Z",
     "shell.execute_reply": "2022-03-24T13:54:12.929101Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 13:54:10.707111: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-24 13:54:10.707142: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7a4c8179",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1f927b0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:12.932545Z",
     "iopub.status.busy": "2022-03-24T13:54:12.932308Z",
     "iopub.status.idle": "2022-03-24T13:54:12.935332Z",
     "shell.execute_reply": "2022-03-24T13:54:12.934867Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5647b9a5",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c932d934",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:12.937388Z",
     "iopub.status.busy": "2022-03-24T13:54:12.937199Z",
     "iopub.status.idle": "2022-03-24T13:54:12.939735Z",
     "shell.execute_reply": "2022-03-24T13:54:12.939317Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "71cd81e8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:12.941754Z",
     "iopub.status.busy": "2022-03-24T13:54:12.941561Z",
     "iopub.status.idle": "2022-03-24T13:54:13.038364Z",
     "shell.execute_reply": "2022-03-24T13:54:13.037923Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fae4f5f2200>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5f47588d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:13.040665Z",
     "iopub.status.busy": "2022-03-24T13:54:13.040451Z",
     "iopub.status.idle": "2022-03-24T13:54:13.091959Z",
     "shell.execute_reply": "2022-03-24T13:54:13.091315Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 13:54:13.042584: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-24 13:54:13.042613: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-24 13:54:13.042633: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (1287e082f392): /proc/driver/nvidia/version does not exist\n",
      "2022-03-24 13:54:13.042913: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fae4d448dc0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fae4d448dc0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "ad39b70d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:13.095955Z",
     "iopub.status.busy": "2022-03-24T13:54:13.095661Z",
     "iopub.status.idle": "2022-03-24T13:54:13.278182Z",
     "shell.execute_reply": "2022-03-24T13:54:13.277685Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "575f095e",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cc864422",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:13.280680Z",
     "iopub.status.busy": "2022-03-24T13:54:13.280461Z",
     "iopub.status.idle": "2022-03-24T13:54:13.437933Z",
     "shell.execute_reply": "2022-03-24T13:54:13.437363Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "afef7ef8",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "84405123",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:13.440744Z",
     "iopub.status.busy": "2022-03-24T13:54:13.440511Z",
     "iopub.status.idle": "2022-03-24T13:54:13.443827Z",
     "shell.execute_reply": "2022-03-24T13:54:13.443306Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "6520fe35",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:13.446216Z",
     "iopub.status.busy": "2022-03-24T13:54:13.446004Z",
     "iopub.status.idle": "2022-03-24T13:54:20.158436Z",
     "shell.execute_reply": "2022-03-24T13:54:20.157685Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-24 13:54:13.450920: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae2a2b23",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c1cf5a46",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ca96ca3b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:20.161730Z",
     "iopub.status.busy": "2022-03-24T13:54:20.161419Z",
     "iopub.status.idle": "2022-03-24T13:54:20.167873Z",
     "shell.execute_reply": "2022-03-24T13:54:20.167082Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69c24b9b",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f42ad1d4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:20.170637Z",
     "iopub.status.busy": "2022-03-24T13:54:20.170329Z",
     "iopub.status.idle": "2022-03-24T13:54:22.189880Z",
     "shell.execute_reply": "2022-03-24T13:54:22.189337Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25e18374",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "06406628",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8498c32a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:22.193026Z",
     "iopub.status.busy": "2022-03-24T13:54:22.192767Z",
     "iopub.status.idle": "2022-03-24T13:54:22.212508Z",
     "shell.execute_reply": "2022-03-24T13:54:22.211933Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "91a0b59a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-24T13:54:22.215238Z",
     "iopub.status.busy": "2022-03-24T13:54:22.214998Z",
     "iopub.status.idle": "2022-03-24T13:54:24.561780Z",
     "shell.execute_reply": "2022-03-24T13:54:24.561094Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df3988ca",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
