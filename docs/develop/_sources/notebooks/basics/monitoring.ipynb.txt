{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "621d78ee",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d64b5231",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:11.074570Z",
     "iopub.status.busy": "2022-04-08T15:26:11.074343Z",
     "iopub.status.idle": "2022-04-08T15:26:14.036821Z",
     "shell.execute_reply": "2022-04-08T15:26:14.036201Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-08 15:26:12.057809: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-08 15:26:12.057837: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d40cd502",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d18a0587",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.039809Z",
     "iopub.status.busy": "2022-04-08T15:26:14.039595Z",
     "iopub.status.idle": "2022-04-08T15:26:14.042522Z",
     "shell.execute_reply": "2022-04-08T15:26:14.042008Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4697287",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6332abf6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.044716Z",
     "iopub.status.busy": "2022-04-08T15:26:14.044535Z",
     "iopub.status.idle": "2022-04-08T15:26:14.047472Z",
     "shell.execute_reply": "2022-04-08T15:26:14.046937Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "00a84e20",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.049414Z",
     "iopub.status.busy": "2022-04-08T15:26:14.049177Z",
     "iopub.status.idle": "2022-04-08T15:26:14.154270Z",
     "shell.execute_reply": "2022-04-08T15:26:14.153689Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f79fdb083a0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4450e03a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.156530Z",
     "iopub.status.busy": "2022-04-08T15:26:14.156335Z",
     "iopub.status.idle": "2022-04-08T15:26:14.203646Z",
     "shell.execute_reply": "2022-04-08T15:26:14.203221Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-08 15:26:14.158442: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-08 15:26:14.158474: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-08 15:26:14.158494: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (1766adc795f5): /proc/driver/nvidia/version does not exist\n",
      "2022-04-08 15:26:14.158739: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f79fdb09600&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f79fdb09600>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cb88691d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.206262Z",
     "iopub.status.busy": "2022-04-08T15:26:14.206067Z",
     "iopub.status.idle": "2022-04-08T15:26:14.467526Z",
     "shell.execute_reply": "2022-04-08T15:26:14.467091Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "712247db",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "0005eebe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.469731Z",
     "iopub.status.busy": "2022-04-08T15:26:14.469531Z",
     "iopub.status.idle": "2022-04-08T15:26:14.484210Z",
     "shell.execute_reply": "2022-04-08T15:26:14.483794Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "606b3290",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "6558f55c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.486451Z",
     "iopub.status.busy": "2022-04-08T15:26:14.486265Z",
     "iopub.status.idle": "2022-04-08T15:26:14.489244Z",
     "shell.execute_reply": "2022-04-08T15:26:14.488871Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "238d412b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:14.491072Z",
     "iopub.status.busy": "2022-04-08T15:26:14.490895Z",
     "iopub.status.idle": "2022-04-08T15:26:20.126502Z",
     "shell.execute_reply": "2022-04-08T15:26:20.125995Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-08 15:26:14.495246: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3719c6a1",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c56d572c",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ab1ddffd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:20.130285Z",
     "iopub.status.busy": "2022-04-08T15:26:20.130081Z",
     "iopub.status.idle": "2022-04-08T15:26:20.134630Z",
     "shell.execute_reply": "2022-04-08T15:26:20.134237Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3515f9a2",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "da221283",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:20.137623Z",
     "iopub.status.busy": "2022-04-08T15:26:20.137450Z",
     "iopub.status.idle": "2022-04-08T15:26:21.900623Z",
     "shell.execute_reply": "2022-04-08T15:26:21.900126Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d4dd3b43",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e60269ff",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2ccceb2a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:21.903374Z",
     "iopub.status.busy": "2022-04-08T15:26:21.903165Z",
     "iopub.status.idle": "2022-04-08T15:26:21.919440Z",
     "shell.execute_reply": "2022-04-08T15:26:21.919018Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "e57dd761",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-08T15:26:21.921861Z",
     "iopub.status.busy": "2022-04-08T15:26:21.921669Z",
     "iopub.status.idle": "2022-04-08T15:26:23.805325Z",
     "shell.execute_reply": "2022-04-08T15:26:23.804901Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd422341",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
