{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2a8c004d",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6dcdecc1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:18.174901Z",
     "iopub.status.busy": "2022-03-29T10:10:18.174650Z",
     "iopub.status.idle": "2022-03-29T10:10:21.024617Z",
     "shell.execute_reply": "2022-03-29T10:10:21.024116Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:10:19.092454: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-29 10:10:19.092482: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "200a289a",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "46c66455",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.027536Z",
     "iopub.status.busy": "2022-03-29T10:10:21.027331Z",
     "iopub.status.idle": "2022-03-29T10:10:21.029819Z",
     "shell.execute_reply": "2022-03-29T10:10:21.029426Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e75678a8",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "48fd01e3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.031740Z",
     "iopub.status.busy": "2022-03-29T10:10:21.031567Z",
     "iopub.status.idle": "2022-03-29T10:10:21.033939Z",
     "shell.execute_reply": "2022-03-29T10:10:21.033561Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "73e90dcf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.035829Z",
     "iopub.status.busy": "2022-03-29T10:10:21.035648Z",
     "iopub.status.idle": "2022-03-29T10:10:21.126058Z",
     "shell.execute_reply": "2022-03-29T10:10:21.125600Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fe66e5c9930>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "60f4d0ca",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.129955Z",
     "iopub.status.busy": "2022-03-29T10:10:21.129739Z",
     "iopub.status.idle": "2022-03-29T10:10:21.177436Z",
     "shell.execute_reply": "2022-03-29T10:10:21.177000Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:10:21.131823: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-29 10:10:21.131851: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-29 10:10:21.131872: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (9da31c79f42f): /proc/driver/nvidia/version does not exist\n",
      "2022-03-29 10:10:21.132159: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fe66c419330&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fe66c419330>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a9febbf7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.179886Z",
     "iopub.status.busy": "2022-03-29T10:10:21.179674Z",
     "iopub.status.idle": "2022-03-29T10:10:21.354998Z",
     "shell.execute_reply": "2022-03-29T10:10:21.354534Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d6a6627f",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "207e7605",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.357365Z",
     "iopub.status.busy": "2022-03-29T10:10:21.357157Z",
     "iopub.status.idle": "2022-03-29T10:10:21.504346Z",
     "shell.execute_reply": "2022-03-29T10:10:21.503855Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4dc51d95",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cb3034a6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.507220Z",
     "iopub.status.busy": "2022-03-29T10:10:21.507013Z",
     "iopub.status.idle": "2022-03-29T10:10:21.510171Z",
     "shell.execute_reply": "2022-03-29T10:10:21.509770Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "68e78b0f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:21.512183Z",
     "iopub.status.busy": "2022-03-29T10:10:21.512005Z",
     "iopub.status.idle": "2022-03-29T10:10:27.415618Z",
     "shell.execute_reply": "2022-03-29T10:10:27.415103Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-29 10:10:21.516646: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "df15c4be",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c6d94080",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "b95ea1c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:27.418574Z",
     "iopub.status.busy": "2022-03-29T10:10:27.418326Z",
     "iopub.status.idle": "2022-03-29T10:10:27.423970Z",
     "shell.execute_reply": "2022-03-29T10:10:27.423405Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11fdfd85",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "97a6319f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:27.426383Z",
     "iopub.status.busy": "2022-03-29T10:10:27.426139Z",
     "iopub.status.idle": "2022-03-29T10:10:29.378646Z",
     "shell.execute_reply": "2022-03-29T10:10:29.377994Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "01f96e58",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bf69eb63",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "3023590d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:29.381418Z",
     "iopub.status.busy": "2022-03-29T10:10:29.381209Z",
     "iopub.status.idle": "2022-03-29T10:10:29.398351Z",
     "shell.execute_reply": "2022-03-29T10:10:29.397850Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "65cb0991",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-29T10:10:29.400509Z",
     "iopub.status.busy": "2022-03-29T10:10:29.400321Z",
     "iopub.status.idle": "2022-03-29T10:10:31.777501Z",
     "shell.execute_reply": "2022-03-29T10:10:31.776923Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15c0090d",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
