{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f27d3922",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "41b4c825",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:22.248585Z",
     "iopub.status.busy": "2022-04-07T15:47:22.248272Z",
     "iopub.status.idle": "2022-04-07T15:47:25.244619Z",
     "shell.execute_reply": "2022-04-07T15:47:25.244129Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 15:47:23.220919: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-07 15:47:23.220950: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c8f1d48",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d2432dd3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.247506Z",
     "iopub.status.busy": "2022-04-07T15:47:25.247303Z",
     "iopub.status.idle": "2022-04-07T15:47:25.249861Z",
     "shell.execute_reply": "2022-04-07T15:47:25.249479Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60686fcf",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "997bebdb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.251882Z",
     "iopub.status.busy": "2022-04-07T15:47:25.251630Z",
     "iopub.status.idle": "2022-04-07T15:47:25.254090Z",
     "shell.execute_reply": "2022-04-07T15:47:25.253715Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "545d475b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.255797Z",
     "iopub.status.busy": "2022-04-07T15:47:25.255638Z",
     "iopub.status.idle": "2022-04-07T15:47:25.339117Z",
     "shell.execute_reply": "2022-04-07T15:47:25.338695Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7facf3448250>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d511eae8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.341231Z",
     "iopub.status.busy": "2022-04-07T15:47:25.341037Z",
     "iopub.status.idle": "2022-04-07T15:47:25.423052Z",
     "shell.execute_reply": "2022-04-07T15:47:25.422617Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 15:47:25.343133: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-07 15:47:25.343160: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-07 15:47:25.343179: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (24083d71d288): /proc/driver/nvidia/version does not exist\n",
      "2022-04-07 15:47:25.343438: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7facf344b310&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7facf344b310>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fa5dd943",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.425371Z",
     "iopub.status.busy": "2022-04-07T15:47:25.425178Z",
     "iopub.status.idle": "2022-04-07T15:47:25.701888Z",
     "shell.execute_reply": "2022-04-07T15:47:25.701449Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e68cfe04",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "03380851",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.704032Z",
     "iopub.status.busy": "2022-04-07T15:47:25.703837Z",
     "iopub.status.idle": "2022-04-07T15:47:25.719302Z",
     "shell.execute_reply": "2022-04-07T15:47:25.718863Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e9f87cc",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "9a564db0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.721719Z",
     "iopub.status.busy": "2022-04-07T15:47:25.721532Z",
     "iopub.status.idle": "2022-04-07T15:47:25.725396Z",
     "shell.execute_reply": "2022-04-07T15:47:25.724865Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5d6103ec",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:25.727746Z",
     "iopub.status.busy": "2022-04-07T15:47:25.727500Z",
     "iopub.status.idle": "2022-04-07T15:47:31.508368Z",
     "shell.execute_reply": "2022-04-07T15:47:31.507877Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-07 15:47:25.734402: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b7599e93",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30d53e44",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "757425e6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:31.511168Z",
     "iopub.status.busy": "2022-04-07T15:47:31.510959Z",
     "iopub.status.idle": "2022-04-07T15:47:31.515667Z",
     "shell.execute_reply": "2022-04-07T15:47:31.515250Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71056017",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "bdeafa3f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:31.517767Z",
     "iopub.status.busy": "2022-04-07T15:47:31.517594Z",
     "iopub.status.idle": "2022-04-07T15:47:33.310348Z",
     "shell.execute_reply": "2022-04-07T15:47:33.309818Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8332f6d2",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dd01f598",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a06796a9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:33.313107Z",
     "iopub.status.busy": "2022-04-07T15:47:33.312872Z",
     "iopub.status.idle": "2022-04-07T15:47:33.328543Z",
     "shell.execute_reply": "2022-04-07T15:47:33.328085Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "fc91870b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-07T15:47:33.330919Z",
     "iopub.status.busy": "2022-04-07T15:47:33.330722Z",
     "iopub.status.idle": "2022-04-07T15:47:35.224222Z",
     "shell.execute_reply": "2022-04-07T15:47:35.223787Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a39df85a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
