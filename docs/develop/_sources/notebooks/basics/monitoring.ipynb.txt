{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "0908e90a",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d595ce8c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:48.668666Z",
     "iopub.status.busy": "2022-04-04T15:36:48.668378Z",
     "iopub.status.idle": "2022-04-04T15:36:51.909403Z",
     "shell.execute_reply": "2022-04-04T15:36:51.908871Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-04 15:36:49.671395: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-04 15:36:49.671423: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "170a6df7",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1ba6cf03",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:51.912241Z",
     "iopub.status.busy": "2022-04-04T15:36:51.912012Z",
     "iopub.status.idle": "2022-04-04T15:36:51.914816Z",
     "shell.execute_reply": "2022-04-04T15:36:51.914394Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "51eaa37a",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "70f8005f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:51.916996Z",
     "iopub.status.busy": "2022-04-04T15:36:51.916798Z",
     "iopub.status.idle": "2022-04-04T15:36:51.919390Z",
     "shell.execute_reply": "2022-04-04T15:36:51.919002Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f3249a54",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:51.921445Z",
     "iopub.status.busy": "2022-04-04T15:36:51.921254Z",
     "iopub.status.idle": "2022-04-04T15:36:52.037778Z",
     "shell.execute_reply": "2022-04-04T15:36:52.037251Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f923e381f60>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "83631a70",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:52.039985Z",
     "iopub.status.busy": "2022-04-04T15:36:52.039785Z",
     "iopub.status.idle": "2022-04-04T15:36:52.089448Z",
     "shell.execute_reply": "2022-04-04T15:36:52.088987Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-04 15:36:52.042005: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-04 15:36:52.042036: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-04 15:36:52.042056: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (a9a88c43e7f1): /proc/driver/nvidia/version does not exist\n",
      "2022-04-04 15:36:52.042311: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f923e3c5690&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f923e3c5690>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "dc15cbf1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:52.091816Z",
     "iopub.status.busy": "2022-04-04T15:36:52.091602Z",
     "iopub.status.idle": "2022-04-04T15:36:52.401609Z",
     "shell.execute_reply": "2022-04-04T15:36:52.401115Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00c9268a",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fac67916",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:52.405131Z",
     "iopub.status.busy": "2022-04-04T15:36:52.404891Z",
     "iopub.status.idle": "2022-04-04T15:36:52.421030Z",
     "shell.execute_reply": "2022-04-04T15:36:52.420489Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ddef5efc",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1060ad51",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:52.423651Z",
     "iopub.status.busy": "2022-04-04T15:36:52.423413Z",
     "iopub.status.idle": "2022-04-04T15:36:52.426786Z",
     "shell.execute_reply": "2022-04-04T15:36:52.426338Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c58e4111",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:52.428864Z",
     "iopub.status.busy": "2022-04-04T15:36:52.428664Z",
     "iopub.status.idle": "2022-04-04T15:36:58.777288Z",
     "shell.execute_reply": "2022-04-04T15:36:58.776672Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-04 15:36:52.433575: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12727bc4",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6b813a6",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "307a40bc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:58.780140Z",
     "iopub.status.busy": "2022-04-04T15:36:58.779911Z",
     "iopub.status.idle": "2022-04-04T15:36:58.785526Z",
     "shell.execute_reply": "2022-04-04T15:36:58.785018Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47d37893",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "be4831db",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:36:58.788534Z",
     "iopub.status.busy": "2022-04-04T15:36:58.788314Z",
     "iopub.status.idle": "2022-04-04T15:37:00.742549Z",
     "shell.execute_reply": "2022-04-04T15:37:00.741873Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "17db6d4a",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bedb10f0",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "3382f263",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:37:00.745448Z",
     "iopub.status.busy": "2022-04-04T15:37:00.745221Z",
     "iopub.status.idle": "2022-04-04T15:37:00.764478Z",
     "shell.execute_reply": "2022-04-04T15:37:00.763817Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "cc363280",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-04T15:37:00.767411Z",
     "iopub.status.busy": "2022-04-04T15:37:00.767132Z",
     "iopub.status.idle": "2022-04-04T15:37:02.824130Z",
     "shell.execute_reply": "2022-04-04T15:37:02.823643Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "113e7a8e",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
