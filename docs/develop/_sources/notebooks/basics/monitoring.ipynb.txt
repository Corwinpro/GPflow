{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "d3eda7bb",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3742774c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:26.462678Z",
     "iopub.status.busy": "2022-05-06T08:38:26.462374Z",
     "iopub.status.idle": "2022-05-06T08:38:29.512718Z",
     "shell.execute_reply": "2022-05-06T08:38:29.512231Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-06 08:38:27.434685: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-05-06 08:38:27.434711: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "defc5b85",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "deac9cc6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.515430Z",
     "iopub.status.busy": "2022-05-06T08:38:29.515238Z",
     "iopub.status.idle": "2022-05-06T08:38:29.517983Z",
     "shell.execute_reply": "2022-05-06T08:38:29.517577Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf9ca62f",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2f822a46",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.519941Z",
     "iopub.status.busy": "2022-05-06T08:38:29.519765Z",
     "iopub.status.idle": "2022-05-06T08:38:29.522264Z",
     "shell.execute_reply": "2022-05-06T08:38:29.521875Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "67f415e1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.524083Z",
     "iopub.status.busy": "2022-05-06T08:38:29.523915Z",
     "iopub.status.idle": "2022-05-06T08:38:29.616160Z",
     "shell.execute_reply": "2022-05-06T08:38:29.615562Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f24536ee260>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b6c51f67",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.618495Z",
     "iopub.status.busy": "2022-05-06T08:38:29.618279Z",
     "iopub.status.idle": "2022-05-06T08:38:29.665434Z",
     "shell.execute_reply": "2022-05-06T08:38:29.665002Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-06 08:38:29.620507: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-05-06 08:38:29.620535: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-05-06 08:38:29.620555: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (8a116854c3e0): /proc/driver/nvidia/version does not exist\n",
      "2022-05-06 08:38:29.620810: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f245372dc30&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f245372dc30>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a31eb7cc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.667699Z",
     "iopub.status.busy": "2022-05-06T08:38:29.667505Z",
     "iopub.status.idle": "2022-05-06T08:38:29.804724Z",
     "shell.execute_reply": "2022-05-06T08:38:29.804279Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ec4900c3",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "bb503d9a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.806921Z",
     "iopub.status.busy": "2022-05-06T08:38:29.806717Z",
     "iopub.status.idle": "2022-05-06T08:38:29.821973Z",
     "shell.execute_reply": "2022-05-06T08:38:29.821526Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a7cc9442",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "32607007",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.824323Z",
     "iopub.status.busy": "2022-05-06T08:38:29.824111Z",
     "iopub.status.idle": "2022-05-06T08:38:29.827164Z",
     "shell.execute_reply": "2022-05-06T08:38:29.826760Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a76337c9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:29.829025Z",
     "iopub.status.busy": "2022-05-06T08:38:29.828853Z",
     "iopub.status.idle": "2022-05-06T08:38:35.728934Z",
     "shell.execute_reply": "2022-05-06T08:38:35.728398Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-06 08:38:29.833531: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0fa92ef9",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14f58dbd",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "6113a7f5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:35.731749Z",
     "iopub.status.busy": "2022-05-06T08:38:35.731528Z",
     "iopub.status.idle": "2022-05-06T08:38:35.736325Z",
     "shell.execute_reply": "2022-05-06T08:38:35.735876Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f9b5d57",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "527d0684",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:35.738389Z",
     "iopub.status.busy": "2022-05-06T08:38:35.738178Z",
     "iopub.status.idle": "2022-05-06T08:38:37.812088Z",
     "shell.execute_reply": "2022-05-06T08:38:37.811600Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26022daa",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b0cb90a",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8ddb007a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:37.814775Z",
     "iopub.status.busy": "2022-05-06T08:38:37.814576Z",
     "iopub.status.idle": "2022-05-06T08:38:37.830017Z",
     "shell.execute_reply": "2022-05-06T08:38:37.829598Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d5ff9422",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-06T08:38:37.832362Z",
     "iopub.status.busy": "2022-05-06T08:38:37.832025Z",
     "iopub.status.idle": "2022-05-06T08:38:39.641754Z",
     "shell.execute_reply": "2022-05-06T08:38:39.641326Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aeb29c26",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
