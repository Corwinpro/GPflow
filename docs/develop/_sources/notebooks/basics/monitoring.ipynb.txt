{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "ea1fb180",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e3218c98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:08.335408Z",
     "iopub.status.busy": "2022-03-23T15:19:08.335070Z",
     "iopub.status.idle": "2022-03-23T15:19:11.572495Z",
     "shell.execute_reply": "2022-03-23T15:19:11.571713Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-23 15:19:09.390468: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-23 15:19:09.390499: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1b36ec0c",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e7d88960",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.575367Z",
     "iopub.status.busy": "2022-03-23T15:19:11.575118Z",
     "iopub.status.idle": "2022-03-23T15:19:11.578336Z",
     "shell.execute_reply": "2022-03-23T15:19:11.577837Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d91439e",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "32c752e8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.580686Z",
     "iopub.status.busy": "2022-03-23T15:19:11.580463Z",
     "iopub.status.idle": "2022-03-23T15:19:11.583313Z",
     "shell.execute_reply": "2022-03-23T15:19:11.582841Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3ef7c8de",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.585486Z",
     "iopub.status.busy": "2022-03-23T15:19:11.585287Z",
     "iopub.status.idle": "2022-03-23T15:19:11.723889Z",
     "shell.execute_reply": "2022-03-23T15:19:11.723366Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fd7dff76320>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "56862db7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.726567Z",
     "iopub.status.busy": "2022-03-23T15:19:11.726334Z",
     "iopub.status.idle": "2022-03-23T15:19:11.781858Z",
     "shell.execute_reply": "2022-03-23T15:19:11.781388Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-23 15:19:11.728716: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-23 15:19:11.728748: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-23 15:19:11.728773: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cd2ddd9ed575): /proc/driver/nvidia/version does not exist\n",
      "2022-03-23 15:19:11.729087: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fd7dfdcdb70&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fd7dfdcdb70>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "422a4ab7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.784275Z",
     "iopub.status.busy": "2022-03-23T15:19:11.784019Z",
     "iopub.status.idle": "2022-03-23T15:19:11.937117Z",
     "shell.execute_reply": "2022-03-23T15:19:11.936481Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5af6be44",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fee871c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:11.940049Z",
     "iopub.status.busy": "2022-03-23T15:19:11.939753Z",
     "iopub.status.idle": "2022-03-23T15:19:12.119896Z",
     "shell.execute_reply": "2022-03-23T15:19:12.119350Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2fdccbf9",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cf56d9b0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:12.122824Z",
     "iopub.status.busy": "2022-03-23T15:19:12.122580Z",
     "iopub.status.idle": "2022-03-23T15:19:12.126135Z",
     "shell.execute_reply": "2022-03-23T15:19:12.125534Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4a01ad5b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:12.128509Z",
     "iopub.status.busy": "2022-03-23T15:19:12.128303Z",
     "iopub.status.idle": "2022-03-23T15:19:18.634463Z",
     "shell.execute_reply": "2022-03-23T15:19:18.633805Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-23 15:19:12.133320: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5fda13bc",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0fafaaf4",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "396188af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:18.637354Z",
     "iopub.status.busy": "2022-03-23T15:19:18.637107Z",
     "iopub.status.idle": "2022-03-23T15:19:18.642574Z",
     "shell.execute_reply": "2022-03-23T15:19:18.642074Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e6049ac",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "573f2154",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:18.645046Z",
     "iopub.status.busy": "2022-03-23T15:19:18.644836Z",
     "iopub.status.idle": "2022-03-23T15:19:20.596289Z",
     "shell.execute_reply": "2022-03-23T15:19:20.595717Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6796afc3",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ddc7d458",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1b2b7d31",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:20.599989Z",
     "iopub.status.busy": "2022-03-23T15:19:20.599744Z",
     "iopub.status.idle": "2022-03-23T15:19:20.617476Z",
     "shell.execute_reply": "2022-03-23T15:19:20.616944Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d2e3b73c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-23T15:19:20.620986Z",
     "iopub.status.busy": "2022-03-23T15:19:20.620748Z",
     "iopub.status.idle": "2022-03-23T15:19:22.759438Z",
     "shell.execute_reply": "2022-03-23T15:19:22.758780Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f99336bb",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
