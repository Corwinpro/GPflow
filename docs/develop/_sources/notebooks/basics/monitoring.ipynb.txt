{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "48074c88",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3621c53a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:30.721134Z",
     "iopub.status.busy": "2022-03-25T13:16:30.720861Z",
     "iopub.status.idle": "2022-03-25T13:16:33.669804Z",
     "shell.execute_reply": "2022-03-25T13:16:33.669293Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 13:16:31.655729: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-03-25 13:16:31.655759: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fca3cd10",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "989c12bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.673197Z",
     "iopub.status.busy": "2022-03-25T13:16:33.672981Z",
     "iopub.status.idle": "2022-03-25T13:16:33.675699Z",
     "shell.execute_reply": "2022-03-25T13:16:33.675300Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6583bea1",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5afcc891",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.677833Z",
     "iopub.status.busy": "2022-03-25T13:16:33.677618Z",
     "iopub.status.idle": "2022-03-25T13:16:33.680022Z",
     "shell.execute_reply": "2022-03-25T13:16:33.679633Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5d70e9da",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.682160Z",
     "iopub.status.busy": "2022-03-25T13:16:33.681927Z",
     "iopub.status.idle": "2022-03-25T13:16:33.771152Z",
     "shell.execute_reply": "2022-03-25T13:16:33.770683Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fe2eabe2d40>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2af9e0dc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.773434Z",
     "iopub.status.busy": "2022-03-25T13:16:33.773213Z",
     "iopub.status.idle": "2022-03-25T13:16:33.821029Z",
     "shell.execute_reply": "2022-03-25T13:16:33.820592Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 13:16:33.775293: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-03-25 13:16:33.775321: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-03-25 13:16:33.775339: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (d396962cedd5): /proc/driver/nvidia/version does not exist\n",
      "2022-03-25 13:16:33.775607: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fe2eaa463b0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fe2eaa463b0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "7a44b33c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.823533Z",
     "iopub.status.busy": "2022-03-25T13:16:33.823334Z",
     "iopub.status.idle": "2022-03-25T13:16:33.954281Z",
     "shell.execute_reply": "2022-03-25T13:16:33.953834Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "95a407a0",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "864debc8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:33.956631Z",
     "iopub.status.busy": "2022-03-25T13:16:33.956451Z",
     "iopub.status.idle": "2022-03-25T13:16:34.101807Z",
     "shell.execute_reply": "2022-03-25T13:16:34.101275Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4361f704",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2cb737d4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:34.104471Z",
     "iopub.status.busy": "2022-03-25T13:16:34.104266Z",
     "iopub.status.idle": "2022-03-25T13:16:34.107295Z",
     "shell.execute_reply": "2022-03-25T13:16:34.106891Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "db0acfb5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:34.109402Z",
     "iopub.status.busy": "2022-03-25T13:16:34.109233Z",
     "iopub.status.idle": "2022-03-25T13:16:40.203781Z",
     "shell.execute_reply": "2022-03-25T13:16:40.203289Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-03-25 13:16:34.113780: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6047d25",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7440c909",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9a85a436",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:40.206505Z",
     "iopub.status.busy": "2022-03-25T13:16:40.206283Z",
     "iopub.status.idle": "2022-03-25T13:16:40.211181Z",
     "shell.execute_reply": "2022-03-25T13:16:40.210675Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c1274e66",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "1a2e2f22",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:40.213353Z",
     "iopub.status.busy": "2022-03-25T13:16:40.213162Z",
     "iopub.status.idle": "2022-03-25T13:16:42.098439Z",
     "shell.execute_reply": "2022-03-25T13:16:42.097690Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a825aea",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4095b8d",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "55333e5e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:42.102171Z",
     "iopub.status.busy": "2022-03-25T13:16:42.101878Z",
     "iopub.status.idle": "2022-03-25T13:16:42.125774Z",
     "shell.execute_reply": "2022-03-25T13:16:42.125139Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "17f64fa1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-25T13:16:42.128698Z",
     "iopub.status.busy": "2022-03-25T13:16:42.128430Z",
     "iopub.status.idle": "2022-03-25T13:16:44.250065Z",
     "shell.execute_reply": "2022-03-25T13:16:44.249481Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "511d8cdd",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
