{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "964861a0",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8ed22d7f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:40:57.946472Z",
     "iopub.status.busy": "2022-04-28T09:40:57.946200Z",
     "iopub.status.idle": "2022-04-28T09:41:01.124915Z",
     "shell.execute_reply": "2022-04-28T09:41:01.124383Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 09:40:58.928373: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-28 09:40:58.928401: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bdd0bd72",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fccc5630",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.128011Z",
     "iopub.status.busy": "2022-04-28T09:41:01.127753Z",
     "iopub.status.idle": "2022-04-28T09:41:01.130679Z",
     "shell.execute_reply": "2022-04-28T09:41:01.130227Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8123649c",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "52fd9639",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.133618Z",
     "iopub.status.busy": "2022-04-28T09:41:01.133410Z",
     "iopub.status.idle": "2022-04-28T09:41:01.136276Z",
     "shell.execute_reply": "2022-04-28T09:41:01.135804Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "60c7bf1a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.138350Z",
     "iopub.status.busy": "2022-04-28T09:41:01.138161Z",
     "iopub.status.idle": "2022-04-28T09:41:01.229126Z",
     "shell.execute_reply": "2022-04-28T09:41:01.228625Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f6ce7d154e0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXwAAAD4CAYAAADvsV2wAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAYu0lEQVR4nO3dfYxc5XXH8d/xeoCFVFkSVklYMLZSZAohwcqKEFmqikNk8gJ2yAukaRXaVP4nqE1abbUoUTH5B1dWm0QKaoRIFKKiQAJkMTKV82JXSLRErLNQMODUIg14QhsnsLTBSzxen/6xM/bszL0zd/a+zb33+5EQOzN39z6TlzPPnOc85zF3FwCg/FblPQAAQDYI+ABQEQR8AKgIAj4AVAQBHwAqYnXeAwhzzjnn+Nq1a/MeBgAUyv79+3/t7uNBrw1twF+7dq1mZ2fzHgYAFIqZ/SLsNVI6AFARBHwAqAgCPgBUBAEfACqCgA8AFTG0VToAim1mrq6dew7ql/MLOndsVFOb12vrhom8h1VpBHwAiZuZq+vmB57SQmNRklSfX9DNDzwlSQT9HJHSAZC4nXsOngz2LQuNRe3cczCnEUEi4ANIwS/nFwZ6Htkg4ANI3LljowM9j2wQ8AEkbmrzeo3WRpY9N1ob0dTm9TmNCBKLtgBS0FqYDarSoXonPwR8AKnYumGiK5BTvZMvAj6ALmnNwntV7xDw00fAB7BMmrPwsCqd+vyCNu7YS5onZSzaAlgmzRr6sCod01LQd536gJmZq8e+H5Zjhg9A0qk0Tj3FGvqpzeuXfXuQloK9d1w3SJqnfdwjZlp01wTfEgIR8AF0pXGCJFFDH1S9E/YBE/Z8u85xL7qf/F0Wg7sR8AEEpnHajdZGdOVF44nk2Turd95+88MnA3W7EbNY42YxuBsBH0DPdM3E2KiuvGhc9++vp7KQGxTsez3frl+aiVYOy7FoCyA0XTMxNqpHpzdp33NHUlvIPfvMWui9++mXZnJJG3fsZQG4iYAPoG8rhLSaoc3M1fXb1493PV8bsUhtGKY2r1dtVe/UzyBVPzNzdW3csVfrpneX8oOCgA9AWzdM6LbrLtXE2KhMS7Pr26679GS6plcztDhBcueeg2qc6E7dnHXa6kipoq0bJvSGM/pnpqN8G2ktAJe5PJQcPgBJwa0QWoLKKVsLuXE2aYV9Q3h1oRF53PNHo13b79tIFXYBM8MH0FfYN4C4uf0k2ihHvbbfdVXo4U/ABxDJ1g0TenR6k36+40N6dHqTtm6YiB0kk2ijHPQ3OkX5m1Xo4U9KByiYpHeWxmmUFrZxKkqQbN13obEY630Ebea68qJx7XvuyEDvKSxtVaYe/okEfDP7pqQPS/qVu78j4HWT9FVJH5R0VNKN7v7TJO4NVEnSO0vjNkpbaZAMeh+t30tiM9dK9OrhXxZJzfC/Jelrkr4d8voHJF3Y/Oc9kv6p+W8AA0h6Z2nchcrWNdt3HdB8c6F1obGo7bsOLHs96fumJYkPjmGWSA7f3R+R9HKPS7ZI+rYveUzSmJm9LYl7A1WS9M7SpBYqXzu2vJZ+fqGhqe89GVrSWIUF0mGUVQ5/QtKLbY8PN597qf0iM9smaZskrVmzJqOhAcXRq9lY6/Uk/t4qM62b3h2a1mjP+69q5t87NU546Iw9Tu4fKzdUVTrufoe7T7r75Pj4eN7DAYZOv9z4oAuMYRUui+6hm486Nyj16nkTNmMf5kPOy7zbNquAX5d0ftvj85rPARjA1g0Tob1nzj6zNnD+ubO+PqhDZWddfb/Omu3CZuz9dvbmpey7bbNK6eySdJOZ3aOlxdpX3f2lPr8DIMAt11wSWBlzyzWXrOjvtS9UrpveHXhN+0w9ap69tqp3P5xhXCAd1sXkpCRVlvkdSX8k6RwzOyzpFkk1SXL3r0t6WEslmYe0VJb5Z0ncF6iiNMsHo+TWw/P+UqstzthoTduvvaRwQbLsi8mJBHx3/2Sf113SZ5O4F4D4s+OwzVZR6urDrhmGlExcZV9MZqctUADtAfqNozWZLTUNW8nsPspmq17fHsq8Qansu23NI5wqk4fJyUmfnZ3NexhA7vqdNzvo7Hrjjr2Bs9jWYSdVF6fVxDAws/3uPhn0GjN8YMj1q4oZdFGx7HnquIZxMTkpQ1WHD6Bbr41W7ddErRuvQldIBCPgAxkbZGPPzFxdvQ/wO6VVN/75e5/QF2eeCr1umDc9IV0EfCBDQRt7egXonXsOatBVNpd092MvhH6QDOumJ6SPHD6QoVsfOtCVj28F6MkL3tQVdFeaV3epZ16/zHnqLBVtgZcZPpCRmbm6Xgk5f7UVoDuF5dVHzPSV6y/T2GhwmwWJRdi0FbENAwEfyEi/c16DAnRYvv0fPvEuSd1tiduxCJuuXm0YhhUpHSAj/WbcQQG61yanjTv2qrEYnOFnETZ9RSxvJeADGenVy75XgA7Lt/cKLCzCpq+IbRhI6QAZCes9PzZaGzhAz8zVtSqglbG0VHVDsE9fEctbmeEDGUmqB01rsTDs4JGjx45rZq5O0E9ZEXsK0UsHyMlKS/rCeuG0K0v3SgyuVy8dUjpADuKU9EVZFBz2ahHkg4AP5CCspO9z9z7Rt93CWMgRh52GuVqkiMpw1i05fCAHvYJxUH/6dlGzsMNcLVI0Uc4QKAICPpCyoFx9rxJNaXlKpvN3X10I3q3bbtirRYqmLGfdsmgLpCjo8JLaKtNpq1fptWPhPe5bRmsjXacvnb56leYDgv6ImU64F6JapGjWTe8ObGJnkn6+40NZD6cnDkABchI0M2yccDUiBPsRs8BZ5Rm1VYEfBFTlpKeIm6yCsGgLpCjqwmnnFqrR2khonf380QbtjTNWxE1WQZjhAynql6tvcS0F7vZc/c49B0NnlbQ3zlbrP+vtuw6cTKedUSvefJmAD6RoavP6ngeQt4QdIN75u0WcVZbJ746fOPnzK0cbhavUKd5HFFAgnadLjY3WVBtZnsAJC+KcTDVcitgOuRMzfGAFerVFaH9t7Mya3KVXFxonr5Oi918hdTM8itgOuRMzfGBAvdoidL72ytGG5hcay66TpEenN+nL118mSfp8hN21yF9YRU4SlTpZ7eJlhg8MqN9X+175+vbryrBzs0qC1mOSWFPJchcvM3xgQL2+2kf5el+fXwj90Ni+60AiY0Ty0lpTyXJtgBk+MKB+m3D6lWGOmIV+MMwvNOhlP8TSWFPJcm2AGT4woF6bcMJOtWq32Gx/EKZIVR+IL821gU4EfGBAvb7at78WZqKtWidIkao+EF+Wu3gTSemY2dWSvippRNKd7r6j4/UbJe2U1Fp6/pq735nEvYE89Ppq33ptZq6uqfueVGPxVIuE2oidLMO89aEDeuVodxO0ovVnQTxZHpUYO+Cb2Yik2yW9X9JhSY+b2S53f6bj0nvd/aa49wOyttKjCCWpq8Vi2+NbrrmEnbSQlN1+iyRSOpdLOuTuz7v7MUn3SNqSwN8FchfnKMKdew6qcWJ5xG+c8JM5enbSImtJpHQmJL3Y9viwpPcEXPdRM/tDST+T9Hl3f7HzAjPbJmmbJK1ZsyaBoQHxDHLwRec3gbBqnfYcPTtpkaWsFm0fkrTW3d8p6YeS7gq6yN3vcPdJd58cHx/PaGhAuKglc0HfBDpbHreQo0dekgj4dUnntz0+T6cWZyVJ7v4bd/9d8+Gdkt6dwH2B1EUtmQv6JuAK7nNPjh55SSLgPy7pQjNbZ2anSbpB0q72C8zsbW0Pr5X0bAL3BVIXtWQu7JtAq889OXoMg9g5fHc/bmY3SdqjpbLMb7r7ATP7kqRZd98l6S/N7FpJxyW9LOnGuPcFshC1ZC4sZx/W5x7IA4eYAwkIOqycc2aRBw4xB1KW5eYZYKUI+EBCKLFEXLE2+UVAwAeAIZBFX3yapwHAEMiiLz4BHwCGQBZ98UnpAH2knVcFpP4H6ySBGT4qKeqh0XGapwGDyKIvPgEflTNIEM/yvFFUWxbdU0npoHIG6YCZ5XmjQNqlvczwUTmDBPGxM2uB164yI62DwiHgo3KidsCcmavrt68fD7x20Z1cPgqHgI/Kibo4FnRiVTty+SgacvionKh9b8JOrGpHLh9FQsBHJfVbHJuZq8vUfQZ5J06vQpGQ0gEC7NxzsG+w5/QqFA0zfCBAr1SNSey4RSER8FE6SbRC4AQrlBEpHZRKUq0QstjmDmSNGT5KpV8rhKgzf06wQhlxpi1KZd307tDF1tHaCGfOovR6nWlLSgelElYmOWJGEzRUHgEfpRKUe6+tMi2GfJOtzy9EbpUMFB05fJRKZ+79jaM1vXYsuB9Oy9R9T6qxuPSBkMY5osCwYIaP0tm6YUKPTm/Sz3d8SGedvvpkMA/T+TqpHpQVAR+lttJeN/TIQRkR8FFqK+11E9YHHygyAj5KLWgRN4rfvn6cxVuUDgEfpdZ5TujZZ9Zk1v/3GiecPD5KhyodlF5nK+R107sj/R55fJQNM3xUTtS8Pr3uUTYEfFTO1Ob1qo30zuvQKA1llEjAN7OrzeygmR0ys+mA1083s3ubr//EzNYmcV9gJbZumNDOj71LZ7dV4ozWVi3l97XUApkeOyij2Dl8MxuRdLuk90s6LOlxM9vl7s+0XfYZSa+4+++b2Q2S/l7S9XHvDaxUvyMOgTJKYoZ/uaRD7v68ux+TdI+kLR3XbJF0V/Pn+yS9zyxKrQQAIClJBPwJSS+2PT7cfC7wGnc/LulVSW/u/ENmts3MZs1s9siRIwkMDQDQMlSLtu5+h7tPuvvk+Ph43sMBgFJJog6/Lun8tsfnNZ8Luuawma2W9EZJv0ng3kBkSZx1CxRZEjP8xyVdaGbrzOw0STdI2tVxzS5Jn27+/DFJe31Yj9pCKSV11i1QZLEDfjMnf5OkPZKelfRddz9gZl8ys2ubl31D0pvN7JCkv5bUVboJpKnfWbdAFSTSWsHdH5b0cMdzf9f28+uSPp7EvYCVCGuTQPsEVMlQLdoCaQlrk0D7BFQJzdNQOkGLs1Ob1+vmB55altahfQKqhhk+SiVscVbSsjbJtE9AFTHDR6n0Wpx9dHoTAR6VxgwfpcLiLBCOGT6GUmce/sqLxrXvuSN9N02dOzaqekBwZ3EWIOBjCLXy8K3UTH1+Qf/82AsnX2/Py0vq+mC4f3+dxVkgAAEfQycoD99pobGo7bsO6HfHTyz7YLh/f10fffdEpG8DQNUQ8DF0oubb5xcaXc8tNBa177kjenR6U9LDAgqPRVsMnbj5dhZogWAEfAydqc3rNVob6XnNaG1k2RGF7VigBYIR8DF0tm6Y6Nok9SdXrOnaNHXLNZd0fTCwQAuEI4ePoTTImbP0uAeiIeCjEMIOL+EwciA6Aj5y1+8kqqC6/FYdPsEeiI4cPnIV5SSqsP44n7v3CW3csZdTq4CICPjIVZSTqHqVWXJUIRAdAR+5mZmrB/a9kZYH+X5llhxVCERDwEcuWqmcMO1BPkpdPputgP5YtEVqei3G9uqX01lL3/47Yd8I2GwF9EfARyrCKmtmf/Gy9j13JDRwSwo8iapVftn5dyU2WwFREfCRirDF2Lsfe0He4/cmxkZ7llq2z/bZbAUMhoCPVITl1HsF+6gzdTZbASvDoi1SMWhOnUPFgfQR8JGKoMoaC7l2YmyUA8aBDBDwkYqgjpefumIN3S2BHJHDR2qCcu2TF7yJBVcgJwR8ZIoFVyA/pHQAoCKY4SNT/VohA0hPrIBvZm+SdK+ktZL+S9In3P2VgOsWJbUap7zg7tfGuS+Kib72QL7ipnSmJf3Y3S+U9OPm4yAL7n5Z8x+CfUVFaYUMID1xA/4WSXc1f75L0taYfw8lFrb7lk6XQDbiBvy3uPtLzZ//W9JbQq47w8xmzewxM9sa854oqLDdt2biABMgA30Dvpn9yMyeDvhnS/t17u4Kb5VygbtPSvpjSV8xs7eH3Gtb84Nh9siRI4O+Fwy5qc3rVRvp3m97wqWp+54k6AMp6xvw3f0qd39HwD8PSvofM3ubJDX//auQv1Fv/vt5Sf8qaUPIdXe4+6S7T46Pj6/wLWFYbd0wobNOC64TaCw6uXwgZXFTOrskfbr586clPdh5gZmdbWanN38+R9JGSc/EvC8K6tWFRuhr5PKBdMUN+Dskvd/M/lPSVc3HMrNJM7uzec0fSJo1sycl7ZO0w90J+BXVq4smp1YB6YpVh+/uv5H0voDnZyX9RfPnf5N0aZz7oDymNq/X1PeeVOPE8uWe2ojRRA1IGTttkanWBqvtuw5ovpneOfvMmm655hI2XwEpI+AjczRQA/JB8zQAqAgCPgBUBAEfACqCgA8AFUHAB4CKIOADQEUQ8AGgIqjDR2wcWwgUAwEfsXBsIVAcpHQQC8cWAsXBDB+RBaVuOLYQKA5m+Iiklbqpzy/IdSp1M3ZmLfD6VWacYAUMGQI+IglL3bhLo7WRrusX3XXzA08R9IEhQsBHJGEpmlcXGrrtuks1Yt1n1ZLLB4YLAR+RhJ1Gde7YqLZumNAJDz6/nlw+MDwI+IjkyovG1TmHH62NnDylqtcHAoDhQMBHXzNzdd2/v672ObxJ+ui7Tx1kMrV5fVcuv/0DAUD+KMtEqFYZZj0gLeOS9j135OTjVuBnxy0wvAj4CNS5gzZIZ36eowuB4UbAr5BBet4ElWF2Ij8PFAsBvyIG7XkTlMZpR34eKB4WbStikJ43M3P1roqcdhNjo7rtuktJ3wAFwwy/IgbpebNzz0EFVdWbpC9ffxmBHigoZvgVMUidfNiHg4uWx0CRlS7gz8zVtXHHXq2b3q2NO/bSy6VpkDr5sA+HCRZpgUIrVcAP6+hI0F+amd923aWaGBuVqXcenk1UQDmVKoffa2GyyqmIznLMfnl4NlEB5VSqgM9hHN1WegQhm6iA8ilVSocGXt04ghBAS6yAb2YfN7MDZnbCzCZ7XHe1mR00s0NmNh3nnr2Qe+7Gtx4ALXFn+E9Luk7SI2EXmNmIpNslfUDSxZI+aWYXx7xvoEEWJquCbz0AWmLl8N39WUmygNOO2lwu6ZC7P9+89h5JWyQ9E+feYcg9Lze1eX1XE7Sqf+sBqiqLRdsJSS+2PT4s6T0Z3Bei4gbAKX0Dvpn9SNJbA176grs/mORgzGybpG2StGbNmiT/dKEN0uUyCN96AEgRAr67XxXzHnVJ57c9Pq/5XNC97pB0hyRNTk4GH5JaMV+ceUp3P/bCyd42UcsqAaBTFmWZj0u60MzWmdlpkm6QtCuD+xbezFx9WbBvoawSwErELcv8iJkdlvReSbvNbE/z+XPN7GFJcvfjkm6StEfSs5K+6+4H4g27GsK6VkqUVQIYXNwqne9L+n7A87+U9MG2xw9LejjOvaqoV1CnrBLAoEq107ZswoK6SZRVAhgYAT9lcdo1B+0cNkmfumINC7YABlaq5mnDZqWNy1p61dDHLdUEUD0E/BQl0a45qIY+7gcJgGoipZOitBqXhX2Q3PoQxU8AwhHwU5RW47KwD4xXjjY43QtAKAJ+itJq19zrA4MNWQDCEPBTlFa75l4fGGzIAhDG3IezZc3k5KTPzs7mPYyhddmtP9D8QqPr+bHRms46fTXVO0BFmdl+dw88kIoZfkFtv/aSrnRRbZXptWPHVZ9fkOtU9Q55fQASAb+wgtJFbzhjtRqLy7+x0WgNQAt1+AXWWaO/bnp34HXk9QFIzPBLhfNrAfRCwC+RtMpAAZQDKZ0S4fxaAL0Q8EuG82sBhCGlAwAVQcAHgIog4ANARRDwAaAiCPgAUBFD2zzNzI5I+kXe40jIOZJ+nfcgcsJ7rybee34ucPfxoBeGNuCXiZnNhnWvKzveO++9aob5vZPSAYCKIOADQEUQ8LNxR94DyBHvvZp470OIHD4AVAQzfACoCAI+AFQEAT8DZrbTzJ4zs/8ws++b2VjeY8qKmX3czA6Y2QkzG8pStaSZ2dVmdtDMDpnZdN7jyZKZfdPMfmVmT+c9lqyZ2flmts/Mnmn+b/6v8h5TJwJ+Nn4o6R3u/k5JP5N0c87jydLTkq6T9EjeA8mCmY1Iul3SByRdLOmTZnZxvqPK1LckXZ33IHJyXNLfuPvFkq6Q9Nlh+++egJ8Bd/+Bux9vPnxM0nl5jidL7v6su1fpFPXLJR1y9+fd/ZikeyRtyXlMmXH3RyS9nPc48uDuL7n7T5s//5+kZyUN1eEUBPzs/bmkf8l7EEjNhKQX2x4f1pD9nx7pM7O1kjZI+knOQ1mGE68SYmY/kvTWgJe+4O4PNq/5gpa+9t2d5djSFuW9A1VhZm+QdL+kz7n7/+Y9nnYE/IS4+1W9XjezGyV9WNL7vGSbH/q994qpSzq/7fF5zedQAWZW01Kwv9vdH8h7PJ1I6WTAzK6W9LeSrnX3o3mPB6l6XNKFZrbOzE6TdIOkXTmPCRkwM5P0DUnPuvs/5j2eIAT8bHxN0u9J+qGZPWFmX897QFkxs4+Y2WFJ75W028z25D2mNDUX52+StEdLi3bfdfcD+Y4qO2b2HUn/Lmm9mR02s8/kPaYMbZT0p5I2Nf9//oSZfTDvQbWjtQIAVAQzfACoCAI+AFQEAR8AKoKADwAVQcAHgIog4ANARRDwAaAi/h/ue4J1BeDpogAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f52121d8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.231533Z",
     "iopub.status.busy": "2022-04-28T09:41:01.231314Z",
     "iopub.status.idle": "2022-04-28T09:41:01.315059Z",
     "shell.execute_reply": "2022-04-28T09:41:01.314557Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 09:41:01.233602: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-28 09:41:01.233636: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-28 09:41:01.233655: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (09836addeff6): /proc/driver/nvidia/version does not exist\n",
      "2022-04-28 09:41:01.233934: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f6ce7d54910&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f6ce7d54910>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "36eec46f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.317428Z",
     "iopub.status.busy": "2022-04-28T09:41:01.317210Z",
     "iopub.status.idle": "2022-04-28T09:41:01.484764Z",
     "shell.execute_reply": "2022-04-28T09:41:01.484121Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9c4d63df",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2bd07d71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.487318Z",
     "iopub.status.busy": "2022-04-28T09:41:01.487103Z",
     "iopub.status.idle": "2022-04-28T09:41:01.503659Z",
     "shell.execute_reply": "2022-04-28T09:41:01.503171Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "138e238e",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "289c4989",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.506590Z",
     "iopub.status.busy": "2022-04-28T09:41:01.506347Z",
     "iopub.status.idle": "2022-04-28T09:41:01.509891Z",
     "shell.execute_reply": "2022-04-28T09:41:01.509439Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "74c597ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:01.512310Z",
     "iopub.status.busy": "2022-04-28T09:41:01.512114Z",
     "iopub.status.idle": "2022-04-28T09:41:07.529854Z",
     "shell.execute_reply": "2022-04-28T09:41:07.529327Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-28 09:41:01.517686: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "58d39883",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e8b60488",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "86b8b9f8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:07.532639Z",
     "iopub.status.busy": "2022-04-28T09:41:07.532428Z",
     "iopub.status.idle": "2022-04-28T09:41:07.537332Z",
     "shell.execute_reply": "2022-04-28T09:41:07.536868Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c8388cc2",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "87635e8e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:07.539782Z",
     "iopub.status.busy": "2022-04-28T09:41:07.539572Z",
     "iopub.status.idle": "2022-04-28T09:41:09.585551Z",
     "shell.execute_reply": "2022-04-28T09:41:09.585030Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "77cb1102",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b16489e",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a0c0a602",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:09.588229Z",
     "iopub.status.busy": "2022-04-28T09:41:09.587993Z",
     "iopub.status.idle": "2022-04-28T09:41:09.604681Z",
     "shell.execute_reply": "2022-04-28T09:41:09.604121Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "91244b4b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-28T09:41:09.607179Z",
     "iopub.status.busy": "2022-04-28T09:41:09.606966Z",
     "iopub.status.idle": "2022-04-28T09:41:11.475474Z",
     "shell.execute_reply": "2022-04-28T09:41:11.474981Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e55375bc",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
