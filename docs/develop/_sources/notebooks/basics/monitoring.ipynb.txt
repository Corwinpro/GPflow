{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2f9088e2",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f7939077",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:11.362483Z",
     "iopub.status.busy": "2022-05-03T13:48:11.362253Z",
     "iopub.status.idle": "2022-05-03T13:48:14.273944Z",
     "shell.execute_reply": "2022-05-03T13:48:14.273482Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-03 13:48:12.299744: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-05-03 13:48:12.299771: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ebd64a5",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "647fcce1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.276694Z",
     "iopub.status.busy": "2022-05-03T13:48:14.276472Z",
     "iopub.status.idle": "2022-05-03T13:48:14.279103Z",
     "shell.execute_reply": "2022-05-03T13:48:14.278710Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b8f5bd5a",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "237281c4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.281126Z",
     "iopub.status.busy": "2022-05-03T13:48:14.280944Z",
     "iopub.status.idle": "2022-05-03T13:48:14.283531Z",
     "shell.execute_reply": "2022-05-03T13:48:14.283137Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "181638f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.285291Z",
     "iopub.status.busy": "2022-05-03T13:48:14.285114Z",
     "iopub.status.idle": "2022-05-03T13:48:14.378761Z",
     "shell.execute_reply": "2022-05-03T13:48:14.378365Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f9394e121d0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9d2995a0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.380739Z",
     "iopub.status.busy": "2022-05-03T13:48:14.380545Z",
     "iopub.status.idle": "2022-05-03T13:48:14.428622Z",
     "shell.execute_reply": "2022-05-03T13:48:14.428228Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-03 13:48:14.382490: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-05-03 13:48:14.382515: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-05-03 13:48:14.382534: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cef30543c893): /proc/driver/nvidia/version does not exist\n",
      "2022-05-03 13:48:14.382798: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f9394c01d50&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f9394c01d50>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "83c705a8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.430694Z",
     "iopub.status.busy": "2022-05-03T13:48:14.430497Z",
     "iopub.status.idle": "2022-05-03T13:48:14.576438Z",
     "shell.execute_reply": "2022-05-03T13:48:14.576006Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c07fa855",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "23566671",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.578788Z",
     "iopub.status.busy": "2022-05-03T13:48:14.578572Z",
     "iopub.status.idle": "2022-05-03T13:48:14.594014Z",
     "shell.execute_reply": "2022-05-03T13:48:14.593582Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "77db5894",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ffae664f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.596479Z",
     "iopub.status.busy": "2022-05-03T13:48:14.596274Z",
     "iopub.status.idle": "2022-05-03T13:48:14.599405Z",
     "shell.execute_reply": "2022-05-03T13:48:14.598994Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "61fb2728",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:14.601227Z",
     "iopub.status.busy": "2022-05-03T13:48:14.601038Z",
     "iopub.status.idle": "2022-05-03T13:48:20.201587Z",
     "shell.execute_reply": "2022-05-03T13:48:20.201045Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-05-03 13:48:14.605782: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74c61cb9",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "325cbe31",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "aeb53888",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:20.204314Z",
     "iopub.status.busy": "2022-05-03T13:48:20.204112Z",
     "iopub.status.idle": "2022-05-03T13:48:20.208930Z",
     "shell.execute_reply": "2022-05-03T13:48:20.208254Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c23d3ead",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b7c1d0e3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:20.211097Z",
     "iopub.status.busy": "2022-05-03T13:48:20.210931Z",
     "iopub.status.idle": "2022-05-03T13:48:22.077539Z",
     "shell.execute_reply": "2022-05-03T13:48:22.076955Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "67a19d29",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "61be1156",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1f1795ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:22.080229Z",
     "iopub.status.busy": "2022-05-03T13:48:22.080023Z",
     "iopub.status.idle": "2022-05-03T13:48:22.095999Z",
     "shell.execute_reply": "2022-05-03T13:48:22.095169Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d0187a02",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-03T13:48:22.098090Z",
     "iopub.status.busy": "2022-05-03T13:48:22.097889Z",
     "iopub.status.idle": "2022-05-03T13:48:23.757304Z",
     "shell.execute_reply": "2022-05-03T13:48:23.756894Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7f4514f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
