{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "ab6469aa",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1d3894cf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:31.729704Z",
     "iopub.status.busy": "2022-04-01T08:35:31.729437Z",
     "iopub.status.idle": "2022-04-01T08:35:34.862011Z",
     "shell.execute_reply": "2022-04-01T08:35:34.861447Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 08:35:32.743211: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-01 08:35:32.743239: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "166ccade",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1a53afe9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:34.864918Z",
     "iopub.status.busy": "2022-04-01T08:35:34.864687Z",
     "iopub.status.idle": "2022-04-01T08:35:34.867497Z",
     "shell.execute_reply": "2022-04-01T08:35:34.867089Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0c23404",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "03cc5879",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:34.869635Z",
     "iopub.status.busy": "2022-04-01T08:35:34.869424Z",
     "iopub.status.idle": "2022-04-01T08:35:34.872091Z",
     "shell.execute_reply": "2022-04-01T08:35:34.871691Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5d6bdb79",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:34.874121Z",
     "iopub.status.busy": "2022-04-01T08:35:34.873907Z",
     "iopub.status.idle": "2022-04-01T08:35:34.964446Z",
     "shell.execute_reply": "2022-04-01T08:35:34.964008Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f0300568d60>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "8c7e836c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:34.966702Z",
     "iopub.status.busy": "2022-04-01T08:35:34.966495Z",
     "iopub.status.idle": "2022-04-01T08:35:35.017060Z",
     "shell.execute_reply": "2022-04-01T08:35:35.016591Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 08:35:34.968678: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-01 08:35:34.968706: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-01 08:35:34.968726: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (952aeac3a0ae): /proc/driver/nvidia/version does not exist\n",
      "2022-04-01 08:35:34.969008: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f03005a9390&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f03005a9390>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9c65f4e6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:35.019618Z",
     "iopub.status.busy": "2022-04-01T08:35:35.019367Z",
     "iopub.status.idle": "2022-04-01T08:35:35.302678Z",
     "shell.execute_reply": "2022-04-01T08:35:35.302109Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46345025",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "6bd261b2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:35.305550Z",
     "iopub.status.busy": "2022-04-01T08:35:35.305296Z",
     "iopub.status.idle": "2022-04-01T08:35:35.321403Z",
     "shell.execute_reply": "2022-04-01T08:35:35.320944Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d83e564a",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4c0d1099",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:35.323941Z",
     "iopub.status.busy": "2022-04-01T08:35:35.323755Z",
     "iopub.status.idle": "2022-04-01T08:35:35.326887Z",
     "shell.execute_reply": "2022-04-01T08:35:35.326471Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "51f06cce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:35.329059Z",
     "iopub.status.busy": "2022-04-01T08:35:35.328876Z",
     "iopub.status.idle": "2022-04-01T08:35:41.338385Z",
     "shell.execute_reply": "2022-04-01T08:35:41.337871Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-01 08:35:35.333714: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1fb11beb",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d5f12fb6",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "049aefac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:41.341102Z",
     "iopub.status.busy": "2022-04-01T08:35:41.340882Z",
     "iopub.status.idle": "2022-04-01T08:35:41.345567Z",
     "shell.execute_reply": "2022-04-01T08:35:41.345162Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b86a521",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "71b84998",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:41.347776Z",
     "iopub.status.busy": "2022-04-01T08:35:41.347580Z",
     "iopub.status.idle": "2022-04-01T08:35:43.216488Z",
     "shell.execute_reply": "2022-04-01T08:35:43.215977Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e6368c7",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b11067f",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5987b54f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:43.219412Z",
     "iopub.status.busy": "2022-04-01T08:35:43.219169Z",
     "iopub.status.idle": "2022-04-01T08:35:43.235110Z",
     "shell.execute_reply": "2022-04-01T08:35:43.234661Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "4cc01e54",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-01T08:35:43.237637Z",
     "iopub.status.busy": "2022-04-01T08:35:43.237438Z",
     "iopub.status.idle": "2022-04-01T08:35:45.187279Z",
     "shell.execute_reply": "2022-04-01T08:35:45.186841Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66305b39",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
