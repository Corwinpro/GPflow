{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c8100bec",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e7362190",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:05.074840Z",
     "iopub.status.busy": "2022-04-12T14:51:05.074622Z",
     "iopub.status.idle": "2022-04-12T14:51:08.101860Z",
     "shell.execute_reply": "2022-04-12T14:51:08.101323Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-12 14:51:05.971147: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-12 14:51:05.971176: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ad92110c",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2a86104d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.105547Z",
     "iopub.status.busy": "2022-04-12T14:51:08.105287Z",
     "iopub.status.idle": "2022-04-12T14:51:08.108289Z",
     "shell.execute_reply": "2022-04-12T14:51:08.107825Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "72fb9660",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "e2e643f3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.111086Z",
     "iopub.status.busy": "2022-04-12T14:51:08.110828Z",
     "iopub.status.idle": "2022-04-12T14:51:08.113768Z",
     "shell.execute_reply": "2022-04-12T14:51:08.113352Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "92cb4f89",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.116525Z",
     "iopub.status.busy": "2022-04-12T14:51:08.116306Z",
     "iopub.status.idle": "2022-04-12T14:51:08.204378Z",
     "shell.execute_reply": "2022-04-12T14:51:08.203929Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f2a2c649cf0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "90ad38e0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.206694Z",
     "iopub.status.busy": "2022-04-12T14:51:08.206449Z",
     "iopub.status.idle": "2022-04-12T14:51:08.257293Z",
     "shell.execute_reply": "2022-04-12T14:51:08.256839Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-12 14:51:08.208788: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-12 14:51:08.208817: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-12 14:51:08.208836: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ff15def5dec8): /proc/driver/nvidia/version does not exist\n",
      "2022-04-12 14:51:08.209126: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f2a2c64b520&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f2a2c64b520>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "939a2258",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.259462Z",
     "iopub.status.busy": "2022-04-12T14:51:08.259262Z",
     "iopub.status.idle": "2022-04-12T14:51:08.411140Z",
     "shell.execute_reply": "2022-04-12T14:51:08.410599Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27af9397",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4a866776",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.414149Z",
     "iopub.status.busy": "2022-04-12T14:51:08.413908Z",
     "iopub.status.idle": "2022-04-12T14:51:08.430002Z",
     "shell.execute_reply": "2022-04-12T14:51:08.429466Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2ed54bfd",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b834cc57",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.433312Z",
     "iopub.status.busy": "2022-04-12T14:51:08.433081Z",
     "iopub.status.idle": "2022-04-12T14:51:08.436481Z",
     "shell.execute_reply": "2022-04-12T14:51:08.436034Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4b2d4ac3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:08.439052Z",
     "iopub.status.busy": "2022-04-12T14:51:08.438805Z",
     "iopub.status.idle": "2022-04-12T14:51:14.403436Z",
     "shell.execute_reply": "2022-04-12T14:51:14.402907Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-12 14:51:08.443918: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dc0cc020",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd1f749f",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "46511246",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:14.407310Z",
     "iopub.status.busy": "2022-04-12T14:51:14.407075Z",
     "iopub.status.idle": "2022-04-12T14:51:14.412023Z",
     "shell.execute_reply": "2022-04-12T14:51:14.411540Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4681817b",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6d073f44",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:14.414931Z",
     "iopub.status.busy": "2022-04-12T14:51:14.414694Z",
     "iopub.status.idle": "2022-04-12T14:51:16.614519Z",
     "shell.execute_reply": "2022-04-12T14:51:16.613934Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00f05b91",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "703ab855",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "67388928",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:16.621359Z",
     "iopub.status.busy": "2022-04-12T14:51:16.621086Z",
     "iopub.status.idle": "2022-04-12T14:51:16.638569Z",
     "shell.execute_reply": "2022-04-12T14:51:16.637880Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "949cd587",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-12T14:51:16.641506Z",
     "iopub.status.busy": "2022-04-12T14:51:16.641229Z",
     "iopub.status.idle": "2022-04-12T14:51:18.697945Z",
     "shell.execute_reply": "2022-04-12T14:51:18.697257Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bcb16f33",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
