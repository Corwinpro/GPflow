{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f07bbd37",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f689da12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:54.998710Z",
     "iopub.status.busy": "2022-04-11T10:04:54.998342Z",
     "iopub.status.idle": "2022-04-11T10:04:58.245022Z",
     "shell.execute_reply": "2022-04-11T10:04:58.244516Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-11 10:04:56.023368: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-04-11 10:04:56.023396: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import ci_niter\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "448c45a8",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7565dad6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.247820Z",
     "iopub.status.busy": "2022-04-11T10:04:58.247605Z",
     "iopub.status.idle": "2022-04-11T10:04:58.250373Z",
     "shell.execute_reply": "2022-04-11T10:04:58.249981Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1cc68614",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0ddf9223",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.252275Z",
     "iopub.status.busy": "2022-04-11T10:04:58.252094Z",
     "iopub.status.idle": "2022-04-11T10:04:58.254661Z",
     "shell.execute_reply": "2022-04-11T10:04:58.254272Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = ci_niter(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "9b88117f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.256696Z",
     "iopub.status.busy": "2022-04-11T10:04:58.256386Z",
     "iopub.status.idle": "2022-04-11T10:04:58.368419Z",
     "shell.execute_reply": "2022-04-11T10:04:58.367684Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f670f74c790>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "1d4fb47e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.371156Z",
     "iopub.status.busy": "2022-04-11T10:04:58.370937Z",
     "iopub.status.idle": "2022-04-11T10:04:58.423646Z",
     "shell.execute_reply": "2022-04-11T10:04:58.422991Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-11 10:04:58.373349: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-04-11 10:04:58.373387: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-04-11 10:04:58.373415: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (7ae85bb94748): /proc/driver/nvidia/version does not exist\n",
      "2022-04-11 10:04:58.373775: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f670f74ce80&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value               </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]             </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0                 </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.009999999999999998</td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f670f74ce80>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤══════════════════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value                │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪══════════════════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.]              │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0                  │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼──────────────────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.009999999999999998 │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧══════════════════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e61c1231",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.425983Z",
     "iopub.status.busy": "2022-04-11T10:04:58.425773Z",
     "iopub.status.idle": "2022-04-11T10:04:58.584274Z",
     "shell.execute_reply": "2022-04-11T10:04:58.583783Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9e3a83d1",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1b7a393a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.587795Z",
     "iopub.status.busy": "2022-04-11T10:04:58.587571Z",
     "iopub.status.idle": "2022-04-11T10:04:58.605469Z",
     "shell.execute_reply": "2022-04-11T10:04:58.604968Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0f180f48",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "03c77627",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.608827Z",
     "iopub.status.busy": "2022-04-11T10:04:58.608614Z",
     "iopub.status.idle": "2022-04-11T10:04:58.612025Z",
     "shell.execute_reply": "2022-04-11T10:04:58.611575Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b6d560cb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:04:58.614629Z",
     "iopub.status.busy": "2022-04-11T10:04:58.614442Z",
     "iopub.status.idle": "2022-04-11T10:05:05.021501Z",
     "shell.execute_reply": "2022-04-11T10:05:05.020959Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-04-11 10:04:58.619220: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\n"
     ]
    }
   ],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bae51e2c",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bbbf0fd2",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3be161c6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:05:05.024207Z",
     "iopub.status.busy": "2022-04-11T10:05:05.023987Z",
     "iopub.status.idle": "2022-04-11T10:05:05.028828Z",
     "shell.execute_reply": "2022-04-11T10:05:05.028356Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "20d8aa00",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f4a42f07",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:05:05.031041Z",
     "iopub.status.busy": "2022-04-11T10:05:05.030849Z",
     "iopub.status.idle": "2022-04-11T10:05:07.282154Z",
     "shell.execute_reply": "2022-04-11T10:05:07.281480Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "54ac3420",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce261696",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ed68d98e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:05:07.285938Z",
     "iopub.status.busy": "2022-04-11T10:05:07.285630Z",
     "iopub.status.idle": "2022-04-11T10:05:07.311885Z",
     "shell.execute_reply": "2022-04-11T10:05:07.311185Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d5d6e30b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-11T10:05:07.315401Z",
     "iopub.status.busy": "2022-04-11T10:05:07.315107Z",
     "iopub.status.idle": "2022-04-11T10:05:09.271712Z",
     "shell.execute_reply": "2022-04-11T10:05:09.270926Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889753\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735825e-04, -4.30340661e-04,  3.97830673e-04,  2.26009904e-06,\n",
       "        4.29147152e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005977,   1.74612938,   0.18194306, -15.21875411,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9183135b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
